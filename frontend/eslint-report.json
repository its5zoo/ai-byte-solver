[{"filePath":"E:\\AI_Byte_Solver\\frontend\\eslint.config.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\AI_Byte_Solver\\frontend\\fix.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\AI_Byte_Solver\\frontend\\postcss.config.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\AI_Byte_Solver\\frontend\\src\\App.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\AI_Byte_Solver\\frontend\\src\\components\\chat\\ChatPanel.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'_' is defined but never used.","line":93,"column":14,"nodeType":"Identifier","messageId":"unusedVar","endLine":93,"endColumn":15}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useState, useRef, useEffect } from 'react';\r\nimport { Link } from 'react-router-dom';\r\nimport { Send, Loader2, HelpCircle, Sparkles, FileText, X } from 'lucide-react';\r\nimport Button from '../ui/Button';\r\nimport MessageBubble from './MessageBubble';\r\nimport { cn } from '../../lib/utils';\r\nimport { useThemeStore } from '../../stores/themeStore';\r\n\r\ninterface Message {\r\n  _id: string;\r\n  role: 'user' | 'assistant';\r\n  content: string;\r\n  createdAt?: string;\r\n  topic?: string; // New: Topic from backend\r\n}\r\n\r\n\r\n\r\nconst RESPONSE_CHIPS = [\r\n  { id: 'quick', label: 'Quick', icon: 'âš¡' },\r\n  { id: 'steps', label: 'Step-by-Step', icon: 'ðŸ“' },\r\n  { id: 'example', label: 'Example-Based', icon: 'ðŸ’¡' },\r\n];\r\n\r\ninterface PDF {\r\n  _id: string;\r\n  originalName: string;\r\n}\r\n\r\ninterface ChatPanelProps {\r\n  sessionId: string | null;\r\n  messages: Message[];\r\n  onSend: (content: string, pdfId?: string) => Promise<void>;\r\n  isLoading?: boolean;\r\n  error?: string | null;\r\n  onDismissError?: () => void;\r\n  mode: 'syllabus' | 'open' | 'pyq';\r\n  pdfs: PDF[];\r\n  attachedPdfIds?: string[];\r\n  onClearPdf?: (pdfId: string) => void;\r\n}\r\n\r\nexport default function ChatPanel({\r\n  sessionId,\r\n  messages,\r\n  onSend,\r\n  isLoading,\r\n  error,\r\n  onDismissError,\r\n  pdfs,\r\n  attachedPdfIds = [],\r\n  onClearPdf,\r\n}: ChatPanelProps) {\r\n  const { theme } = useThemeStore();\r\n  const isDark = theme === 'dark' || (theme === 'system' && typeof window !== 'undefined' && window.matchMedia('(prefers-color-scheme: dark)').matches);\r\n  const [input, setInput] = useState('');\r\n  const [selectedChip, setSelectedChip] = useState<string>('quick');\r\n  const [explainCount, setExplainCount] = useState<Record<string, number>>({}); // topic -> count\r\n  const bottomRef = useRef<HTMLDivElement>(null);\r\n  const textareaRef = useRef<HTMLTextAreaElement>(null);\r\n\r\n  // Get the last message to check if it's from AI and we should offer help\r\n  const lastMessage = messages[messages.length - 1];\r\n  const lastTopic = lastMessage?.role === 'assistant' ? lastMessage.topic || 'General' : null;\r\n  const showExplainChip = lastTopic && (explainCount[lastTopic] || 0) < 3;\r\n\r\n  // Auto-scroll to bottom when messages change\r\n  useEffect(() => {\r\n    bottomRef.current?.scrollIntoView({ behavior: 'smooth' });\r\n  }, [messages, isLoading]);\r\n\r\n  // Auto-resize textarea\r\n  useEffect(() => {\r\n    if (textareaRef.current) {\r\n      textareaRef.current.style.height = 'auto';\r\n      textareaRef.current.style.height = textareaRef.current.scrollHeight + 'px';\r\n    }\r\n  }, [input]);\r\n\r\n  const handleSubmit = async (e?: React.FormEvent, text?: string) => {\r\n    e?.preventDefault();\r\n    const toSend = (text ?? input).trim();\r\n    if (!toSend || isLoading) return;\r\n\r\n    // Always clear input if we're sending a message\r\n    setInput('');\r\n    if (textareaRef.current) textareaRef.current.style.height = 'auto';\r\n\r\n    try {\r\n      // Pass the first attached PDF ID for backward compatibility in the `onSend` signature,\r\n      // but the backend will use the whole array via the session state.\r\n      await onSend(toSend, attachedPdfIds[0] || undefined);\r\n    } catch (_) {\r\n      // Error shown via parent error state\r\n    }\r\n  }\r\n\r\n  const handleExplainSimply = () => {\r\n    if (!lastTopic) return;\r\n    setExplainCount(prev => ({ ...prev, [lastTopic]: (prev[lastTopic] || 0) + 1 }));\r\n    handleSubmit(undefined, \"Can you explain this to me in a simple way?\");\r\n  };\r\n\r\n  const showWelcome = messages.length === 0;\r\n\r\n  // Find selected PDF names\r\n  const selectedPdfs = pdfs.filter(p => attachedPdfIds.includes(p._id));\r\n\r\n  return (\r\n    <div className=\"flex min-h-0 flex-1 flex-col overflow-hidden bg-[hsl(var(--background)/0.5)] transition-colors\">\r\n      {/* Messages area */}\r\n      <div className=\"min-h-0 flex-1 overflow-y-auto custom-scrollbar\">\r\n        <div className=\"mx-auto w-full px-6 py-6 lg:px-12\">\r\n          {/* Error banner */}\r\n          {error && (\r\n            <div className=\"mb-6 animate-fade-in-down flex items-start gap-3 rounded-2xl border border-red-200 bg-red-50 p-4 dark:border-red-800 dark:bg-red-900/20\">\r\n              <div className=\"flex-1\">\r\n                <p className=\"text-sm font-medium text-red-800 dark:text-red-200\">{error}</p>\r\n              </div>\r\n              {onDismissError && (\r\n                <button\r\n                  type=\"button\"\r\n                  onClick={onDismissError}\r\n                  className=\"shrink-0 rounded-lg px-3 py-1 text-sm text-red-700 hover:bg-red-100 dark:text-red-400 dark:hover:bg-red-900/40 transition-colors\"\r\n                >\r\n                  Dismiss\r\n                </button>\r\n              )}\r\n            </div>\r\n          )}\r\n\r\n          {/* Welcome screen */}\r\n          {(!sessionId || showWelcome) && (\r\n            <div className=\"flex flex-col items-center justify-center px-4 py-16 text-center animate-fade-in-up\">\r\n              <div className=\"mb-6 flex h-20 w-20 items-center justify-center rounded-full bg-gradient-to-br from-violet-500 to-violet-700 shadow-lg shadow-violet-500/30\">\r\n                <Sparkles className=\"h-10 w-10 text-white\" />\r\n              </div>\r\n              <h2 className=\"text-3xl font-bold text-slate-900 dark:text-white mb-3\">\r\n                Ask Your Doubt\r\n              </h2>\r\n              <p className=\"max-w-md text-base text-slate-600 dark:text-slate-300 mb-8\">\r\n                I'm here to help you understand concepts, solve problems, and ace your exams.\r\n                Ask me anything academic!\r\n              </p>\r\n\r\n              <div className=\"flex flex-col items-center justify-center gap-2\">\r\n                <p className=\"text-sm font-medium text-[hsl(var(--foreground-tertiary))]\">\r\n                  {selectedPdfs.length > 0\r\n                    ? `Using ${selectedPdfs.length} attached document(s)`\r\n                    : 'Upload your file to solve your doubts'\r\n                  }\r\n                </p>\r\n              </div>\r\n            </div>\r\n          )}\r\n\r\n          {/* Messages */}\r\n          <div className=\"space-y-6\">\r\n            {messages.map((m) => (\r\n              <div\r\n                key={m._id}\r\n                className={cn(\r\n                  'flex w-full animate-fade-in-up',\r\n                  m.role === 'user' ? 'justify-end' : 'justify-start'\r\n                )}\r\n              >\r\n                <MessageBubble key={m._id} message={m} />\r\n              </div>\r\n            ))}\r\n            {isLoading && (\r\n              <div className=\"flex justify-start animate-fade-in-up\">\r\n                <div className=\"flex items-center gap-3 rounded-2xl rounded-bl-none glass-elevated px-5 py-3 border border-violet-500/20 shadow-lg shadow-violet-500/5\">\r\n                  <div className=\"relative flex h-8 w-8 items-center justify-center rounded-full bg-violet-100 dark:bg-violet-900/30\">\r\n                    <Sparkles className=\"h-4 w-4 text-violet-600 dark:text-violet-400 animate-pulse\" />\r\n                    <div className=\"absolute inset-0 animate-ping rounded-full bg-violet-400 opacity-20\"></div>\r\n                  </div>\r\n                  <div className=\"flex flex-col\">\r\n                    <span className=\"text-sm font-bold text-slate-900 dark:text-white\">Byte AI is thinking</span>\r\n                    <div className=\"flex gap-1 mt-0.5\">\r\n                      <div className=\"h-1 w-1 rounded-full bg-violet-400 animate-bounce\" style={{ animationDelay: '0ms' }} />\r\n                      <div className=\"h-1 w-1 rounded-full bg-violet-400 animate-bounce\" style={{ animationDelay: '150ms' }} />\r\n                      <div className=\"h-1 w-1 rounded-full bg-violet-400 animate-bounce\" style={{ animationDelay: '300ms' }} />\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            )}\r\n            <div ref={bottomRef} />\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n      {/* Input area */}\r\n      <div className=\"glass-elevated border-t border-[hsl(var(--glass-border))] px-4 py-4\">\r\n        <div className=\"mx-auto max-w-3xl space-y-3\">\r\n\r\n          {/* Selected PDF Badges */}\r\n          {selectedPdfs.length > 0 && (\r\n            <div className=\"flex flex-wrap items-center gap-2 text-xs font-medium text-violet-600 dark:text-violet-400 px-1 animate-fade-in-down\">\r\n              {selectedPdfs.map(pdf => (\r\n                <span key={pdf._id} className=\"flex items-center gap-1.5 bg-violet-50 dark:bg-violet-900/20 px-2 py-1 rounded-md border border-violet-100 dark:border-violet-800\">\r\n                  <FileText className=\"h-3 w-3 shrink-0\" />\r\n                  <span className=\"truncate max-w-[150px]\" title={pdf.originalName}>\r\n                    Using: {pdf.originalName}\r\n                  </span>\r\n                  {onClearPdf && (\r\n                    <button\r\n                      onClick={() => onClearPdf(pdf._id)}\r\n                      className=\"ml-1 shrink-0 hover:text-red-500 transition-colors\"\r\n                      title=\"Remove PDF\"\r\n                    >\r\n                      <X className=\"h-3 w-3\" />\r\n                    </button>\r\n                  )}\r\n                </span>\r\n              ))}\r\n            </div>\r\n          )}\r\n\r\n          {/* Response style chips */}\r\n          {sessionId && messages.length > 0 && (\r\n            <div className=\"flex flex-wrap gap-2\">\r\n              {RESPONSE_CHIPS.map((chip) => (\r\n                <button\r\n                  key={chip.id}\r\n                  type=\"button\"\r\n                  onClick={() => setSelectedChip(chip.id)}\r\n                  className={cn(\r\n                    'rounded-full px-4 py-2 text-sm font-medium transition-all',\r\n                    selectedChip === chip.id\r\n                      ? 'bg-violet-600 text-white shadow-md shadow-violet-500/25 scale-105'\r\n                      : 'border border-slate-200 bg-white text-slate-700 hover:border-violet-300 hover:bg-violet-50 dark:border-slate-600 dark:bg-slate-800 dark:text-slate-300 dark:hover:border-violet-600 dark:hover:bg-violet-900/30'\r\n                  )}\r\n                >\r\n                  <span className=\"mr-1.5\">{chip.icon}</span>\r\n                  {chip.label}\r\n                </button>\r\n              ))}\r\n\r\n              {showExplainChip && (\r\n                <button\r\n                  type=\"button\"\r\n                  onClick={handleExplainSimply}\r\n                  className=\"animate-fade-in-up rounded-full px-4 py-2 text-sm font-medium transition-all bg-emerald-100 text-emerald-800 border border-emerald-200 hover:bg-emerald-200 dark:bg-emerald-900/30 dark:text-emerald-300 dark:border-emerald-800 dark:hover:bg-emerald-900/50\"\r\n                >\r\n                  âœ¨ Explain Simply\r\n                </button>\r\n              )}\r\n            </div>\r\n          )}\r\n\r\n          {/* PYQ Analysis Action (available anytime PDFs are attached) */}\r\n          {selectedPdfs.length > 0 && (\r\n            <div className=\"flex flex-wrap gap-2\">\r\n              <button\r\n                type=\"button\"\r\n                onClick={() => {\r\n                  handleSubmit(undefined, \"Analyze the attached PDFs for Repeated Questions, Important Questions, and Diagram-Based Questions.\");\r\n                }}\r\n                className=\"animate-fade-in-up rounded-full px-4 py-2 text-sm font-medium transition-all bg-indigo-100 text-indigo-800 border border-indigo-200 hover:bg-indigo-200 dark:bg-indigo-900/30 dark:text-indigo-300 dark:border-indigo-800 dark:hover:bg-indigo-900/50 shadow-sm shadow-indigo-500/20\"\r\n                title=\"Extract PYQs, Important Questions, and Diagrams\"\r\n              >\r\n                ðŸ“Š Analyze PYQs\r\n              </button>\r\n            </div>\r\n          )}\r\n\r\n          {/* Input and send button */}\r\n          <div className=\"flex gap-3 px-2\">\r\n            <div className=\"flex flex-1 items-center gap-3 rounded-2xl border-2 border-slate-200 bg-white/60 py-1.5 pl-5 pr-1.5 focus-within:border-violet-500 focus-within:ring-4 focus-within:ring-violet-500/10 transition-all duration-300 shadow-xl shadow-slate-200/40 backdrop-blur-xl dark:border-white/10 dark:bg-white/5 dark:focus-within:border-violet-500 dark:shadow-none\">\r\n              <textarea\r\n                ref={textareaRef}\r\n                value={input}\r\n                onChange={(e) => setInput(e.target.value)}\r\n                onKeyDown={(e) => {\r\n                  if (e.key === 'Enter' && !e.shiftKey) {\r\n                    e.preventDefault();\r\n                    handleSubmit(undefined, input.trim() || undefined);\r\n                  }\r\n                }}\r\n                placeholder=\"Ask your doubt to Byte AI\"\r\n                rows={1}\r\n                disabled={isLoading}\r\n                className=\"max-h-32 flex-1 resize-none bg-transparent py-2.5 text-base font-bold placeholder:!text-slate-500 !border-none !outline-none !ring-0 focus:!ring-0 focus:!outline-none shadow-none appearance-none dark:placeholder:!text-slate-400 custom-scrollbar\"\r\n                style={{\r\n                  color: isDark ? '#ffffff' : '#020617',\r\n                  caretColor: isDark ? '#ffffff' : '#020617'\r\n                }}\r\n              />\r\n              <Button\r\n                type=\"button\"\r\n                onClick={() => handleSubmit(undefined)}\r\n                disabled={isLoading || !input.trim()}\r\n                className={cn(\r\n                  \"h-10 w-10 shrink-0 rounded-xl p-0 transition-all duration-300 hover:scale-110 active:scale-90\",\r\n                  input.trim()\r\n                    ? \"bg-gradient-to-br from-violet-600 via-violet-600 to-indigo-600 text-white shadow-lg shadow-violet-500/30 ring-2 ring-white/20\"\r\n                    : \"bg-slate-100 text-slate-400 dark:bg-white/5 dark:text-slate-600\"\r\n                )}\r\n              >\r\n                {isLoading ? (\r\n                  <Loader2 className=\"h-5 w-5 animate-spin\" />\r\n                ) : (\r\n                  <Send className=\"h-5 w-5 fill-white/10\" />\r\n                )}\r\n              </Button>\r\n            </div>\r\n\r\n            {/* Quiz button */}\r\n            <Link\r\n              to={sessionId ? `/chat/${sessionId}/quiz` : '/chat'}\r\n              className={cn(\r\n                'flex shrink-0 items-center gap-2 rounded-2xl bg-gradient-to-r from-violet-600 to-violet-700 px-6 py-3 font-medium text-white shadow-md shadow-violet-500/30 transition-all hover:shadow-lg hover:shadow-violet-500/40 hover:scale-105 active:scale-95',\r\n                !sessionId && 'opacity-50 pointer-events-none'\r\n              )}\r\n            >\r\n              <HelpCircle className=\"h-5 w-5\" />\r\n              <span className=\"hidden sm:inline\">Start Quiz</span>\r\n            </Link>\r\n          </div>\r\n\r\n          {/* Helper text */}\r\n          <p className=\"text-center text-xs text-slate-500 dark:text-slate-400\">\r\n            AI may make mistakes. Please verify important information.\r\n          </p>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"E:\\AI_Byte_Solver\\frontend\\src\\components\\chat\\MessageBubble.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\AI_Byte_Solver\\frontend\\src\\components\\chat\\PDFUploadModal.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\AI_Byte_Solver\\frontend\\src\\components\\ide\\AIAssistantPanel.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":16,"column":43,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":16,"endColumn":46,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[516,519],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[516,519],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":24,"column":12,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":24,"endColumn":15,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1099,1102],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1099,1102],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":25,"column":17,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":25,"endColumn":20,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1123,1126],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1123,1126],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":35,"column":20,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":35,"endColumn":23,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1378,1381],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1378,1381],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":83,"column":55,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":83,"endColumn":58,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3559,3562],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3559,3562],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":195,"column":23,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":195,"endColumn":26,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[8412,8415],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[8412,8415],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useCallback has a missing dependency: 'onCreateFile'. Either include it or remove the dependency array. If 'onCreateFile' changes too often, find the parent component that defines it and wrap that definition in useCallback.","line":209,"column":8,"nodeType":"ArrayExpression","endLine":209,"endColumn":102,"suggestions":[{"desc":"Update the dependencies array to be: [prompt, aiMode, isLoading, activeProjectId, files, activeFile, terminalOutput, selectedModel, onCreateFile]","fix":{"range":[9141,9235],"text":"[prompt, aiMode, isLoading, activeProjectId, files, activeFile, terminalOutput, selectedModel, onCreateFile]"}}]}],"suppressedMessages":[],"errorCount":6,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useState, useRef, useEffect, useCallback } from 'react';\r\nimport {\r\n    ChevronDown, MessageSquare, Wrench, BookOpen, Zap,\r\n    Send, Loader2, Plus,\r\n} from 'lucide-react';\r\nimport { cn } from '../../lib/utils';\r\nimport { useIdeStore, type AiMode, type AiModel } from '../../stores/ideStore';\r\nimport DiffViewer from './DiffViewer';\r\nimport api from '../../lib/api';\r\n\r\nconst MODELS: AiModel[] = [\r\n    'gpt-oss:120b-cloud',\r\n    'DeepSeek-v3.1:671b-cloud',\r\n];\r\n\r\nconst MODES: { id: AiMode; icon: React.FC<any>; label: string; color: string; desc: string }[] = [\r\n    { id: 'chat', icon: MessageSquare, label: 'Chat', color: 'text-blue-400', desc: 'Ask anything about your code' },\r\n    { id: 'fix', icon: Wrench, label: 'Fix', color: 'text-red-400', desc: 'Debug and fix errors' },\r\n    { id: 'explain', icon: BookOpen, label: 'Explain', color: 'text-green-400', desc: 'Understand your code line by line' },\r\n    { id: 'optimize', icon: Zap, label: 'Optimize', color: 'text-yellow-400', desc: 'Improve performance & best practices' },\r\n];\r\n\r\ninterface AIAssistantPanelProps {\r\n    files: any[];\r\n    activeFile: any | null;\r\n    onCreateFile?: (name: string, content?: string) => void;\r\n}\r\n\r\ninterface Message {\r\n    id: string;\r\n    role: 'user' | 'assistant';\r\n    content: string;\r\n    codePatch?: string | null;\r\n    errorFix?: string | null;\r\n    changedLines?: any[];\r\n    model?: string;\r\n    suggestions?: string[];\r\n    newFile?: { name: string; content: string } | null;\r\n}\r\n\r\nexport default function AIAssistantPanel({ files, activeFile, onCreateFile }: AIAssistantPanelProps) {\r\n    const { activeProjectId, selectedModel, setSelectedModel, aiMode, setAiMode, terminalOutput } = useIdeStore();\r\n    const [messages, setMessages] = useState<Message[]>([]);\r\n    const [prompt, setPrompt] = useState('');\r\n    const [isLoading, setIsLoading] = useState(false);\r\n    const [showModelDropdown, setShowModelDropdown] = useState(false);\r\n    const [patchTargetId, setPatchTargetId] = useState<string | null>(null);\r\n    const messagesEndRef = useRef<HTMLDivElement>(null);\r\n    const textareaRef = useRef<HTMLTextAreaElement>(null);\r\n\r\n    // Auto-scroll\r\n    useEffect(() => {\r\n        messagesEndRef.current?.scrollIntoView({ behavior: 'smooth' });\r\n    }, [messages]);\r\n\r\n    // Listen for Ctrl+K inline AI trigger\r\n    useEffect(() => {\r\n        const handler = (e: CustomEvent) => {\r\n            if (e.detail?.selection) {\r\n                setPrompt(`Explain this code:\\n\\`\\`\\`\\n${e.detail.selection}\\n\\`\\`\\``);\r\n                setAiMode('explain');\r\n                textareaRef.current?.focus();\r\n            }\r\n        };\r\n        window.addEventListener('ide:ai-inline', handler as EventListener);\r\n        return () => window.removeEventListener('ide:ai-inline', handler as EventListener);\r\n    }, [setAiMode]);\r\n\r\n    const localMessagesRef = useRef(messages);\r\n    useEffect(() => { localMessagesRef.current = messages; }, [messages]);\r\n\r\n    // Load history on mount or when mode/project changes\r\n    useEffect(() => {\r\n        if (!activeProjectId) return;\r\n\r\n        const currentLocal = localMessagesRef.current;\r\n        // Check if we have local messages that aren't from the DB yet\r\n        const hasUnsavedLocal = currentLocal.length > 0 && String(currentLocal[0].id).startsWith('msg-');\r\n\r\n        api.get(`/ide/projects/${activeProjectId}/history?mode=${aiMode}`)\r\n            .then(({ data }) => {\r\n                if (data.messages && data.messages.length > 0) {\r\n                    setMessages(data.messages.map((m: any) => ({\r\n                        id: m._id,\r\n                        role: m.role,\r\n                        content: m.content,\r\n                        model: m.model,\r\n                        suggestions: m.suggestions || [],\r\n                        newFile: m.newFile || null,\r\n                        errorFix: m.errorFix || null,\r\n                        codePatch: m.codePatch || null,\r\n                    })));\r\n                } else if (hasUnsavedLocal) {\r\n                    // Upload existing local messages to the newly attached project\r\n                    currentLocal.forEach(msg => {\r\n                        api.post(`/ide/projects/${activeProjectId}/history`, {\r\n                            role: msg.role,\r\n                            content: msg.content,\r\n                            model: msg.model || 'unknown',\r\n                            mode: aiMode,\r\n                        }).catch(e => console.error('Failed to migrate local message', e));\r\n                    });\r\n                } else {\r\n                    setMessages([]);\r\n                }\r\n            })\r\n            .catch(err => console.error('Failed to load chat history', err));\r\n    }, [activeProjectId, aiMode]);\r\n\r\n    const handleSend = useCallback(async (\r\n        overridePrompt?: string,\r\n        overrideMode?: AiMode,\r\n    ) => {\r\n        const userPrompt = overridePrompt || prompt;\r\n        const mode = overrideMode || aiMode;\r\n        if (!userPrompt.trim() || isLoading) return;\r\n\r\n        const userMsg: Message = {\r\n            id: `msg-${Date.now()}`,\r\n            role: 'user',\r\n            content: userPrompt,\r\n        };\r\n        setMessages((prev) => [...prev, userMsg]);\r\n        setPrompt('');\r\n        setIsLoading(true);\r\n\r\n        // Save user message to history\r\n        if (activeProjectId) {\r\n            api.post(`/ide/projects/${activeProjectId}/history`, {\r\n                role: userMsg.role,\r\n                content: userMsg.content,\r\n                mode: mode, // Save with current mode\r\n            }).catch(e => console.error('Failed to save user message', e));\r\n        }\r\n\r\n        try {\r\n            const { data } = await api.post('/ai-router', {\r\n                projectFiles: files.slice(0, 10).map((f) => ({\r\n                    name: f.name,\r\n                    language: f.language,\r\n                    content: f.content?.slice(0, 3000),\r\n                })),\r\n                activeFile: activeFile ? {\r\n                    name: activeFile.name,\r\n                    language: activeFile.language,\r\n                    content: activeFile.content,\r\n                } : null,\r\n                userPrompt,\r\n                terminalOutput: terminalOutput?.slice(-3000) || '',\r\n                selectedModel,\r\n                mode,\r\n            });\r\n\r\n            let finalNewFile = data.newFile || null;\r\n            let finalCodePatch = data.codePatch || null;\r\n\r\n            // Failsafe: If the AI suggests a new file that has the exact same name as the active file,\r\n            // treat it as a codePatch to the active file instead of trying to create a duplicate.\r\n            if (finalNewFile && activeFile && finalNewFile.name.toLowerCase() === activeFile.name.toLowerCase()) {\r\n                finalCodePatch = finalNewFile.content;\r\n                finalNewFile = null;\r\n            }\r\n\r\n            const assistantMsg: Message = {\r\n                id: `msg-${Date.now() + 1}`,\r\n                role: 'assistant',\r\n                content: data.explanation || 'No explanation provided.',\r\n                codePatch: finalCodePatch,\r\n                errorFix: data.errorFix || null,\r\n                changedLines: data.changedLines || [],\r\n                model: data.model || selectedModel,\r\n                suggestions: data.suggestions || [],\r\n                newFile: finalNewFile,\r\n            };\r\n            setMessages((prev) => [...prev, assistantMsg]);\r\n\r\n            // Handle automated file creation\r\n            if (data.newFile?.name && data.newFile.content && onCreateFile) {\r\n                // Check if file already exists\r\n                const alreadyExists = files.some(f => f.name.toLowerCase() === data.newFile.name.toLowerCase());\r\n                if (!alreadyExists) {\r\n                    onCreateFile(data.newFile.name, data.newFile.content);\r\n                }\r\n            }\r\n\r\n            // Save assistant message to history\r\n            if (activeProjectId) {\r\n                api.post(`/ide/projects/${activeProjectId}/history`, {\r\n                    role: assistantMsg.role,\r\n                    content: assistantMsg.content,\r\n                    model: assistantMsg.model,\r\n                    mode: mode, // Save with current mode\r\n                }).catch(e => console.error('Failed to save assistant message', e));\r\n            }\r\n        } catch (err: any) {\r\n            const errorMsg = err?.response?.data?.error?.message || err.message || 'AI service unavailable';\r\n            const isOllamaModel = !selectedModel?.toLowerCase().includes('deepseek');\r\n            const hint = isOllamaModel\r\n                ? `Make sure **Ollama** is running with the \\`${selectedModel}\\` model.`\r\n                : `Make sure your **DeepSeek API key** is valid in \\`.env\\` (DEEPSEEK_API_KEY).`;\r\n            setMessages((prev) => [...prev, {\r\n                id: `err-${Date.now()}`,\r\n                role: 'assistant',\r\n                content: `âš ï¸ **Network Error**\\n\\n${errorMsg}\\n\\nðŸ’¡ ${hint}`,\r\n            }]);\r\n        } finally {\r\n            setIsLoading(false);\r\n        }\r\n    }, [prompt, aiMode, isLoading, files, activeFile, terminalOutput, selectedModel, activeProjectId]);\r\n\r\n    // Auto-fix on terminal error\r\n    useEffect(() => {\r\n        const handler = (e: CustomEvent) => {\r\n            const { errorOutput } = e.detail;\r\n            setPrompt(`Fix this error:\\n${errorOutput}`);\r\n            setAiMode('fix');\r\n            handleSend(\r\n                `Fix this runtime error:\\n\\`\\`\\`\\n${errorOutput}\\n\\`\\`\\``,\r\n                'fix'\r\n            );\r\n        };\r\n        window.addEventListener('terminal:error', handler as EventListener);\r\n        return () => window.removeEventListener('terminal:error', handler as EventListener);\r\n    }, [activeFile, files, handleSend, setAiMode]);\r\n\r\n    const handleApplyPatch = (msgId: string, patch: string) => {\r\n        const { activeTabId, updateTabContent } = useIdeStore.getState();\r\n        if (!activeTabId || !patch) return;\r\n\r\n        setPatchTargetId(msgId);\r\n\r\n        // Extract code from backticks if present\r\n        let cleanPatch = patch;\r\n        const codeBlockRegex = /```[\\s\\S]*?\\n([\\s\\S]*?)\\n```/g;\r\n        const matches = [...patch.matchAll(codeBlockRegex)];\r\n        if (matches.length > 0) {\r\n            cleanPatch = matches[0][1];\r\n        }\r\n\r\n        setTimeout(() => {\r\n            updateTabContent(activeTabId, cleanPatch);\r\n            setPatchTargetId(null);\r\n        }, 600);\r\n    };\r\n\r\n    const activeMode = MODES.find(m => m.id === aiMode);\r\n\r\n    return (\r\n        <div className=\"flex h-full flex-col bg-[#0d1425] text-white\">\r\n            {/* Header: Model Selector */}\r\n            <div className=\"flex items-center justify-between px-4 py-3 border-b ide-border bg-[#0a0f1e]/80 backdrop-blur-xl sticky top-0 z-20\">\r\n                <div className=\"relative flex-1\">\r\n                    <button\r\n                        onClick={() => setShowModelDropdown((v) => !v)}\r\n                        className=\"flex w-full items-center justify-between rounded-xl border border-white/5 bg-white/5 px-3.5 py-2 text-[10px] font-black uppercase tracking-widest text-indigo-400 transition-all hover:bg-white/10 active:scale-[0.98] shadow-sm\"\r\n                    >\r\n                        <div className=\"flex items-center gap-2.5\">\r\n                            <div className=\"h-2 w-2 rounded-full bg-indigo-500 shadow-[0_0_10px_rgba(99,102,241,0.6)] animate-pulse\" />\r\n                            <span>{selectedModel}</span>\r\n                        </div>\r\n                        <ChevronDown className={cn('h-4 w-4 text-slate-500 transition-transform duration-300', showModelDropdown && 'rotate-180')} />\r\n                    </button>\r\n\r\n                    {showModelDropdown && (\r\n                        <div className=\"absolute left-0 right-0 top-full z-50 mt-2 rounded-xl border border-white/10 bg-[#1e293b] shadow-2xl backdrop-blur-xl p-1.5\">\r\n                            {MODELS.map((m) => (\r\n                                <button\r\n                                    key={m}\r\n                                    onClick={() => { setSelectedModel(m); setShowModelDropdown(false); }}\r\n                                    className={cn(\r\n                                        'flex w-full items-center gap-2 px-3 py-2.5 rounded-lg text-xs transition-colors',\r\n                                        m === selectedModel ? 'bg-indigo-600 text-white font-bold' : 'text-slate-400 hover:bg-white/5 hover:text-white'\r\n                                    )}\r\n                                >\r\n                                    <div className={cn('h-1.5 w-1.5 rounded-full', m === selectedModel ? 'bg-white' : 'bg-slate-700')} />\r\n                                    {m}\r\n                                </button>\r\n                            ))}\r\n                        </div>\r\n                    )}\r\n                </div>\r\n            </div>\r\n\r\n            {/* Mode Selector */}\r\n            <div className=\"flex gap-2 flex-wrap p-4 border-b ide-border bg-[#0f172a]/40 backdrop-blur-sm\">\r\n                {MODES.map((mode) => {\r\n                    const Icon = mode.icon;\r\n                    const isActive = aiMode === mode.id;\r\n                    return (\r\n                        <button\r\n                            key={mode.id}\r\n                            onClick={() => setAiMode(mode.id)}\r\n                            title={mode.desc}\r\n                            className={cn(\r\n                                'flex items-center gap-2 rounded-xl px-3 py-2 text-[10px] font-black uppercase tracking-widest transition-all duration-300 relative overflow-hidden group',\r\n                                isActive\r\n                                    ? 'bg-indigo-600 text-white shadow-lg shadow-indigo-600/20 scale-105'\r\n                                    : 'bg-white/[0.03] text-slate-500 hover:bg-white/[0.08] hover:text-slate-200'\r\n                            )}\r\n                        >\r\n                            <Icon className={cn(\"h-3.5 w-3.5 transition-transform duration-300 group-hover:scale-110\", isActive ? \"text-white\" : \"text-slate-600\")} />\r\n                            {mode.label}\r\n                            {isActive && (\r\n                                <div className=\"absolute inset-0 bg-gradient-to-r from-white/0 via-white/10 to-white/0 translate-x-[-100%] animate-[shimmer_2s_infinite]\" />\r\n                            )}\r\n                        </button>\r\n                    );\r\n                })}\r\n            </div>\r\n\r\n            {/* Messages Area */}\r\n            <div className=\"flex-1 overflow-y-auto custom-scrollbar p-0\">\r\n                {messages.length === 0 && (\r\n                    <div className=\"flex h-full flex-col items-center justify-center text-center py-16 px-6 animate-in fade-in zoom-in duration-700\">\r\n                        <div className=\"relative mb-10\">\r\n                            <div className=\"absolute inset-0 bg-indigo-500/20 blur-[80px] rounded-full\"></div>\r\n                            <div className=\"relative h-24 w-24 flex items-center justify-center rounded-3xl bg-gradient-to-br from-[#1e293b] to-[#0d1425] border border-white/10 shadow-2xl rotate-3\">\r\n                                <div className=\"text-5xl drop-shadow-lg\">ðŸ¤–</div>\r\n                            </div>\r\n                        </div>\r\n                        <h3 className=\"text-[13px] font-black text-white mb-2 uppercase tracking-[0.2em] italic\">AI Tutor Ready</h3>\r\n                        <p className=\"text-xs text-slate-500 max-w-[260px] leading-relaxed mb-10\">\r\n                            Select a file to start editing, or ask me to help build a new feature.\r\n                        </p>\r\n\r\n                        <div className=\"grid grid-cols-1 gap-2.5 w-full max-w-[300px]\">\r\n                            {MODES.slice(0, 3).map(m => (\r\n                                <button\r\n                                    key={m.id}\r\n                                    onClick={() => setAiMode(m.id)}\r\n                                    className=\"flex items-center gap-4 w-full p-4 rounded-2xl bg-white/[0.03] border border-white/5 text-left transition-all hover:bg-white/[0.07] hover:border-indigo-500/30 group\"\r\n                                >\r\n                                    <div className={cn(\"p-2 rounded-xl transition-colors bg-white/5 shadow-sm group-hover:bg-white/10\", m.color)}>\r\n                                        <m.icon className=\"h-4 w-4\" />\r\n                                    </div>\r\n                                    <div className=\"flex-1 min-w-0\">\r\n                                        <div className=\"text-xs font-black text-slate-200 group-hover:text-white transition-colors uppercase tracking-wider\">{m.label}</div>\r\n                                        <div className=\"text-[10px] text-slate-600 group-hover:text-slate-400 transition-colors line-clamp-1\">{m.desc}</div>\r\n                                    </div>\r\n                                </button>\r\n                            ))}\r\n                        </div>\r\n                    </div>\r\n                )}\r\n\r\n                <div className=\"p-4 space-y-6\">\r\n                    {messages.map((msg) => (\r\n                        <div key={msg.id} className={cn('flex flex-col gap-3 animate-in fade-in slide-in-from-bottom-3 duration-500', msg.role === 'user' ? 'items-end pl-12' : 'items-start pr-12')}>\r\n                            <div\r\n                                className={cn(\r\n                                    'relative rounded-2xl px-5 py-4 text-[13px] leading-relaxed transition-all duration-300 ide-card',\r\n                                    msg.role === 'user'\r\n                                        ? 'bg-gradient-to-br from-indigo-600 to-indigo-700 text-white rounded-tr-none shadow-xl shadow-indigo-600/10 border-indigo-500/30'\r\n                                        : 'bg-[#1e293b]/40 text-slate-200 border ide-border rounded-tl-none backdrop-blur-md'\r\n                                )}\r\n                            >\r\n                                {msg.content && (\r\n                                    <div className=\"prose prose-invert max-w-none prose-p:leading-relaxed prose-pre:bg-black/40 prose-pre:border prose-pre:ide-border text-xs text-slate-200\">\r\n                                        <p className=\"whitespace-pre-wrap\">{msg.content}</p>\r\n                                    </div>\r\n                                )}\r\n\r\n                                {msg.newFile && (\r\n                                    <div className=\"mt-3 p-3 rounded-xl border border-emerald-500/20 bg-emerald-500/5 group/newfile\">\r\n                                        <div className=\"flex items-center justify-between mb-2\">\r\n                                            <div className=\"flex items-center gap-2 text-emerald-400 text-[10px] font-bold uppercase tracking-wider\">\r\n                                                <Plus className=\"h-3.5 w-3.5\" />\r\n                                                Suggested New File\r\n                                            </div>\r\n                                            <div className=\"h-1.5 w-1.5 rounded-full bg-emerald-500 shadow-[0_0_8px_rgba(16,185,129,0.5)]\" />\r\n                                        </div>\r\n                                        <div className=\"text-[11px] font-mono text-white mb-2 bg-black/30 px-2 py-1.5 rounded border border-white/5 truncate\">\r\n                                            {msg.newFile.name}\r\n                                        </div>\r\n                                        <button\r\n                                            onClick={() => onCreateFile?.(msg.newFile!.name, msg.newFile!.content)}\r\n                                            className=\"w-full py-1.5 rounded-lg bg-emerald-600/20 hover:bg-emerald-600/40 text-emerald-400 text-[10px] font-bold uppercase tracking-widest transition-all\"\r\n                                        >\r\n                                            Create and Insert\r\n                                        </button>\r\n                                    </div>\r\n                                )}\r\n\r\n                                {msg.errorFix && (\r\n                                    <div className=\"mt-3 rounded-xl border border-indigo-500/20 bg-indigo-500/5 p-4 text-indigo-300 text-[11px] flex items-start gap-3\">\r\n                                        <Wrench className=\"h-4 w-4 mt-0.5 shrink-0 text-indigo-400\" />\r\n                                        <div>\r\n                                            <span className=\"font-black text-indigo-400 uppercase tracking-widest block mb-1\">Architectural Fix</span>\r\n                                            {msg.errorFix}\r\n                                        </div>\r\n                                    </div>\r\n                                )}\r\n\r\n                                {msg.suggestions && msg.suggestions.length > 0 && (\r\n                                    <div className=\"mt-5 border-t border-white/5 pt-4 space-y-3\">\r\n                                        <div className=\"text-[10px] font-black text-slate-500 uppercase tracking-[0.2em] mb-2 flex items-center gap-2\">\r\n                                            <Zap className=\"h-3 w-3 text-yellow-500 shadow-[0_0_8px_rgba(234,179,8,0.3)]\" />\r\n                                            Expert Recommendations\r\n                                        </div>\r\n                                        <div className=\"grid gap-2\">\r\n                                            {msg.suggestions.map((s, i) => (\r\n                                                <div key={i} className=\"text-[11px] text-slate-400 flex items-start gap-2.5 group/sug transition-all hover:text-slate-200\">\r\n                                                    <div className=\"mt-1.5 h-1 w-1 rounded-full bg-slate-800 ring-1 ring-slate-700/50 group-hover/sug:bg-indigo-500 group-hover/sug:ring-indigo-400/50 shrink-0\" />\r\n                                                    <span className=\"leading-relaxed\">{s}</span>\r\n                                                </div>\r\n                                            ))}\r\n                                        </div>\r\n                                    </div>\r\n                                )}\r\n\r\n                                {/* Show which model responded */}\r\n                                {msg.model && msg.role === 'assistant' && (\r\n                                    <div className=\"mt-3 text-[9px] font-bold text-slate-600 border-t border-white/5 pt-2 flex items-center gap-1.5 uppercase tracking-widest\">\r\n                                        <div className=\"h-1 w-1 rounded-full bg-indigo-500/50\" />\r\n                                        {msg.model}\r\n                                    </div>\r\n                                )}\r\n                            </div>\r\n\r\n                            {msg.codePatch && (\r\n                                <div className=\"w-full mt-1\">\r\n                                    <DiffViewer\r\n                                        patch={msg.codePatch}\r\n                                        onApply={() => handleApplyPatch(msg.id, msg.codePatch!)}\r\n                                        isApplying={patchTargetId === msg.id}\r\n                                    />\r\n                                </div>\r\n                            )}\r\n                        </div>\r\n                    ))}\r\n                    <div ref={messagesEndRef} />\r\n                </div>\r\n            </div>\r\n\r\n            {/* Input Area */}\r\n            <div className=\"border-t ide-border p-5 bg-[#0a0f1e]/95 backdrop-blur-3xl relative z-20\">\r\n                {/* Active file indicator */}\r\n                {activeFile && (\r\n                    <div className=\"mb-4 px-3 flex items-center gap-2.5 text-[10px] font-black tracking-widest text-slate-500 uppercase\">\r\n                        <div className=\"h-2 w-2 rounded-full bg-indigo-500 shadow-[0_0_8px_rgba(99,102,241,0.6)] animate-pulse\" />\r\n                        Analyzing <span className=\"text-white bg-indigo-500/10 px-1.5 py-0.5 rounded border border-indigo-500/20\">{activeFile.name}</span>\r\n                        <span className=\"text-slate-700 italic\">({activeFile.language})</span>\r\n                    </div>\r\n                )}\r\n\r\n                <div className=\"relative group/input\">\r\n                    <div className=\"absolute -inset-0.5 bg-gradient-to-r from-indigo-500/20 to-purple-600/20 rounded-2xl blur opacity-0 group-focus-within/input:opacity-100 transition duration-500 pointer-events-none\" />\r\n                    <textarea\r\n                        ref={textareaRef}\r\n                        rows={1}\r\n                        value={prompt}\r\n                        onChange={(e) => setPrompt(e.target.value)}\r\n                        onKeyDown={(e) => {\r\n                            if (e.key === 'Enter' && !e.shiftKey) {\r\n                                e.preventDefault();\r\n                                handleSend();\r\n                            }\r\n                        }}\r\n                        placeholder={`Message AI Byte...`}\r\n                        className=\"w-full h-[52px] resize-none rounded-2xl border border-white/5 bg-[#0f172a]/80 pl-5 pr-14 py-4 text-xs text-white placeholder-slate-600 transition-all focus:border-indigo-500/50 focus:bg-[#0f172a] focus:outline-none focus:ring-4 focus:ring-indigo-500/10 custom-scrollbar max-h-48 relative z-10\"\r\n                    />\r\n                    <button\r\n                        onClick={() => handleSend()}\r\n                        disabled={isLoading || !prompt.trim()}\r\n                        className=\"absolute right-2.5 top-1/2 -translate-y-1/2 h-10 w-10 flex items-center justify-center rounded-xl bg-indigo-600 text-white shadow-lg shadow-indigo-600/20 transition-all hover:bg-indigo-500 hover:scale-105 active:scale-95 disabled:opacity-10 disabled:grayscale disabled:hover:scale-100 z-20\"\r\n                    >\r\n                        {isLoading ? (\r\n                            <Loader2 className=\"h-4.5 w-4.5 animate-spin\" />\r\n                        ) : (\r\n                            <Send className=\"h-4.5 w-4.5\" />\r\n                        )}\r\n                    </button>\r\n                </div>\r\n                <div className=\"mt-4 flex items-center justify-center text-[10px] font-black text-slate-600 uppercase tracking-[0.2em] italic\">\r\n                    <span className=\"px-2 py-0.5 rounded-md bg-white/5 text-slate-500 mr-2.5 border border-white/5 font-mono\">âŒ˜ K</span> Inline AI â€¢ {activeMode?.label || 'CHAT'} Mode\r\n                </div>\r\n            </div>\r\n        </div>\r\n    );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"E:\\AI_Byte_Solver\\frontend\\src\\components\\ide\\CodeEditor.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":99,"column":100,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":99,"endColumn":103,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3949,3952],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3949,3952],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":125,"column":24,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":125,"endColumn":27,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4976,4979],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4976,4979],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useCallback has an unnecessary dependency: 'monaco'. Either exclude it or remove the dependency array.","line":127,"column":8,"nodeType":"ArrayExpression","endLine":127,"endColumn":24,"suggestions":[{"desc":"Update the dependencies array to be: [onSave]","fix":{"range":[5094,5110],"text":"[onSave]"}}]}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useRef, useEffect, useCallback } from 'react';\r\nimport Editor, { useMonaco } from '@monaco-editor/react';\r\nimport type { editor } from 'monaco-editor';\r\n\r\ninterface CodeEditorProps {\r\n    fileId: string;\r\n    language: string;\r\n    content: string;\r\n    onChange: (content: string) => void;\r\n    onSave: (content: string) => void;\r\n}\r\n\r\nconst LANGUAGE_MAP: Record<string, string> = {\r\n    javascript: 'javascript',\r\n    typescript: 'typescript',\r\n    python: 'python',\r\n    cpp: 'cpp',\r\n    c: 'c',\r\n    csharp: 'csharp',\r\n    java: 'java',\r\n    html: 'html',\r\n    css: 'css',\r\n    scss: 'scss',\r\n    json: 'json',\r\n    markdown: 'markdown',\r\n    shell: 'shell',\r\n    bash: 'shell',\r\n    yaml: 'yaml',\r\n    xml: 'xml',\r\n    sql: 'sql',\r\n    rust: 'rust',\r\n    go: 'go',\r\n    ruby: 'ruby',\r\n    php: 'php',\r\n    swift: 'swift',\r\n    kotlin: 'kotlin',\r\n    text: 'plaintext',\r\n    other: 'plaintext',\r\n};\r\n\r\nexport default function CodeEditor({ fileId, language, content, onChange, onSave }: CodeEditorProps) {\r\n    const monaco = useMonaco();\r\n    const editorRef = useRef<editor.IStandaloneCodeEditor | null>(null);\r\n\r\n    // Define custom dark theme once Monaco is ready\r\n    useEffect(() => {\r\n        if (!monaco) return;\r\n\r\n        monaco.editor.defineTheme('ide-dark', {\r\n            base: 'vs-dark',\r\n            inherit: true,\r\n            rules: [\r\n                { token: 'keyword', foreground: 'c084fc', fontStyle: 'bold' },\r\n                { token: 'variable', foreground: '7dd3fc' },\r\n                { token: 'string', foreground: '4ade80' },\r\n                { token: 'string.escape', foreground: '10b981', fontStyle: 'bold' },\r\n                { token: 'number', foreground: 'fb923c' },\r\n                { token: 'comment', foreground: '475569', fontStyle: 'italic' },\r\n                { token: 'function', foreground: 'facc15', fontStyle: 'bold' },\r\n                { token: 'type', foreground: '38bdf8' },\r\n                { token: 'identifier', foreground: '94a3b8' },\r\n                { token: 'operator', foreground: '6366f1' },\r\n                { token: 'delimiter', foreground: '475569' },\r\n                { token: 'tag', foreground: 'f43f5e', fontStyle: 'bold' },\r\n                { token: 'attribute.name', foreground: 'c084fc' },\r\n                { token: 'attribute.value', foreground: '4ade80' },\r\n            ],\r\n            colors: {\r\n                'editor.background': '#0f172a',\r\n                'editor.foreground': '#94a3b8',\r\n                'editor.lineHighlightBackground': '#1e293b50',\r\n                'editor.selectionBackground': '#6366f140',\r\n                'editor.selectionHighlightBackground': '#6366f120',\r\n                'editorLineNumber.foreground': '#334155',\r\n                'editorLineNumber.activeForeground': '#6366f1',\r\n                'editorCursor.foreground': '#6366f1',\r\n                'editorIndentGuide.background': '#1e293b',\r\n                'editorIndentGuide.activeBackground': '#6366f150',\r\n                'editorGutter.background': '#0f172a',\r\n                'editorWidget.background': '#0f172a',\r\n                'editorWidget.border': '#1e293b',\r\n                'editorSuggestWidget.background': '#0f172a',\r\n                'editorSuggestWidget.border': '#1e293b',\r\n                'editorSuggestWidget.selectedBackground': '#6366f130',\r\n                'scrollbar.shadow': '#00000000',\r\n                'scrollbarSlider.background': '#33415550',\r\n                'scrollbarSlider.hoverBackground': '#33415580',\r\n                'scrollbarSlider.activeBackground': '#6366f140',\r\n                'minimap.background': '#0f172a',\r\n                'input.background': '#1e293b',\r\n                'input.border': '#334155',\r\n                'focusBorder': '#6366f1',\r\n            },\r\n        });\r\n\r\n        monaco.editor.setTheme('ide-dark');\r\n    }, [monaco]);\r\n\r\n    const handleMount = useCallback((editorInstance: editor.IStandaloneCodeEditor, monacoInstance: any) => {\r\n        editorRef.current = editorInstance;\r\n\r\n        // Ctrl+S / Cmd+S to save\r\n        editorInstance.addCommand(\r\n            monacoInstance.KeyMod.CtrlCmd | monacoInstance.KeyCode.KeyS,\r\n            () => {\r\n                const value = editorInstance.getValue();\r\n                onSave(value);\r\n            }\r\n        );\r\n\r\n        // Ctrl+K inline AI (placeholder - opens AI panel)\r\n        editorInstance.addCommand(\r\n            monacoInstance.KeyMod.CtrlCmd | monacoInstance.KeyCode.KeyK,\r\n            () => {\r\n                // Dispatch custom event that AIAssistantPanel listens to\r\n                window.dispatchEvent(new CustomEvent('ide:ai-inline', {\r\n                    detail: { selection: editorInstance.getModel()?.getValueInRange(editorInstance.getSelection()!) }\r\n                }));\r\n            }\r\n        );\r\n\r\n        // Format on button click\r\n        const formatAction = editorInstance.getAction('editor.action.formatDocument');\r\n        if (formatAction) {\r\n            (window as any).__ideFormat = () => editorInstance.trigger('keyboard', 'editor.action.formatDocument', null);\r\n        }\r\n    }, [monaco, onSave]);\r\n\r\n    return (\r\n        <div className=\"h-full w-full overflow-hidden\">\r\n            <Editor\r\n                key={fileId}\r\n                height=\"100%\"\r\n                language={LANGUAGE_MAP[language] || 'plaintext'}\r\n                value={content}\r\n                theme=\"ide-dark\"\r\n                onChange={(val) => onChange(val || '')}\r\n                onMount={handleMount}\r\n                options={{\r\n                    fontSize: 14,\r\n                    fontFamily: '\"JetBrains Mono\", \"Fira Code\", \"Cascadia Code\", Consolas, monospace',\r\n                    fontLigatures: true,\r\n                    lineNumbers: 'on',\r\n                    minimap: { enabled: true, scale: 1 },\r\n                    scrollBeyondLastLine: false,\r\n                    automaticLayout: true,\r\n                    tabSize: 2,\r\n                    insertSpaces: true,\r\n                    autoClosingBrackets: 'always',\r\n                    autoClosingQuotes: 'always',\r\n                    autoIndent: 'full',\r\n                    formatOnPaste: true,\r\n                    suggestOnTriggerCharacters: true,\r\n                    quickSuggestions: { other: true, comments: false, strings: true },\r\n                    parameterHints: { enabled: true },\r\n                    wordWrap: 'off',\r\n                    smoothScrolling: true,\r\n                    cursorBlinking: 'phase',\r\n                    cursorSmoothCaretAnimation: 'on',\r\n                    renderWhitespace: 'selection',\r\n                    bracketPairColorization: { enabled: true },\r\n                    guides: { bracketPairs: true, indentation: true },\r\n                    padding: { top: 12, bottom: 12 },\r\n                    scrollbar: {\r\n                        verticalScrollbarSize: 8,\r\n                        horizontalScrollbarSize: 8,\r\n                    },\r\n                }}\r\n                loading={\r\n                    <div className=\"flex h-full items-center justify-center bg-[#0f172a]\">\r\n                        <div className=\"text-sm text-slate-500 animate-pulse\">Loading editorâ€¦</div>\r\n                    </div>\r\n                }\r\n            />\r\n        </div>\r\n    );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"E:\\AI_Byte_Solver\\frontend\\src\\components\\ide\\DiffViewer.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\AI_Byte_Solver\\frontend\\src\\components\\ide\\FileExplorer.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'err' is defined but never used.","line":119,"column":22,"nodeType":"Identifier","messageId":"unusedVar","endLine":119,"endColumn":25}],"suppressedMessages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":21,"column":24,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":21,"endColumn":27,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[547,550],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[547,550],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}],"suppressions":[{"kind":"directive","justification":""}]}],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useState, useRef, useCallback } from 'react';\r\nimport {\r\n    File, Plus, Trash2, Edit2,\r\n    FileCode, FileText, FileCog, FileJson, FileType\r\n} from 'lucide-react';\r\nimport { cn } from '../../lib/utils';\r\n\r\ninterface FileItem {\r\n    _id: string;\r\n    name: string;\r\n    path: string;\r\n    language: string;\r\n    content: string;\r\n    project?: string;\r\n}\r\n\r\ninterface FileExplorerProps {\r\n    files: FileItem[];\r\n    activeFileId: string | null;\r\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\r\n    onOpenFile: (file: any) => void;\r\n    onCreateFile: (name: string) => void;\r\n    onDeleteFile: (fileId: string) => void;\r\n    onRenameFile: (fileId: string, name: string) => void;\r\n}\r\n\r\nfunction getFileIcon(language: string, name: string) {\r\n    const ext = name.includes('.') ? name.split('.').pop()?.toLowerCase() : '';\r\n    if (language === 'typescript' || ['ts', 'tsx'].includes(ext!))\r\n        return <span className=\"text-[9px] font-black text-blue-400 w-5 h-5 rounded bg-blue-400/10 flex items-center justify-center shrink-0\">TS</span>;\r\n    if (['javascript'].includes(language) || ['js', 'jsx', 'mjs'].includes(ext!))\r\n        return <span className=\"text-[9px] font-black text-yellow-400 w-5 h-5 rounded bg-yellow-400/10 flex items-center justify-center shrink-0\">JS</span>;\r\n    if (language === 'python' || ext === 'py')\r\n        return <span className=\"text-[9px] font-black text-green-400 w-5 h-5 rounded bg-green-400/10 flex items-center justify-center shrink-0\">PY</span>;\r\n    if (language === 'cpp' || ['cpp', 'cc', 'cxx'].includes(ext!))\r\n        return <span className=\"text-[9px] font-black text-purple-400 w-5 h-5 rounded bg-purple-400/10 flex items-center justify-center shrink-0\">C+</span>;\r\n    if (language === 'c' || ext === 'c')\r\n        return <span className=\"text-[9px] font-black text-purple-300 w-5 h-5 rounded bg-purple-300/10 flex items-center justify-center shrink-0\">C</span>;\r\n    if (language === 'java' || ext === 'java')\r\n        return <span className=\"text-[9px] font-black text-orange-400 w-5 h-5 rounded bg-orange-400/10 flex items-center justify-center shrink-0\">JA</span>;\r\n    if (language === 'csharp' || ext === 'cs')\r\n        return <span className=\"text-[9px] font-black text-green-400 w-5 h-5 rounded bg-green-400/10 flex items-center justify-center shrink-0\">C#</span>;\r\n    if (language === 'rust' || ext === 'rs')\r\n        return <span className=\"text-[9px] font-black text-orange-500 w-5 h-5 rounded bg-orange-500/10 flex items-center justify-center shrink-0\">RS</span>;\r\n    if (language === 'go' || ext === 'go')\r\n        return <span className=\"text-[9px] font-black text-cyan-400 w-5 h-5 rounded bg-cyan-400/10 flex items-center justify-center shrink-0\">GO</span>;\r\n    if (language === 'ruby' || ext === 'rb')\r\n        return <span className=\"text-[9px] font-black text-red-400 w-5 h-5 rounded bg-red-400/10 flex items-center justify-center shrink-0\">RB</span>;\r\n    if (language === 'php' || ext === 'php')\r\n        return <span className=\"text-[9px] font-black text-indigo-400 w-5 h-5 rounded bg-indigo-400/10 flex items-center justify-center shrink-0\">PH</span>;\r\n    if (language === 'html' || ['html', 'htm'].includes(ext!))\r\n        return <FileCode className=\"h-4 w-4 text-orange-400 shrink-0\" />;\r\n    if (['css', 'scss'].includes(language) || ['css', 'scss'].includes(ext!))\r\n        return <FileCog className=\"h-4 w-4 text-pink-400 shrink-0\" />;\r\n    if (language === 'json' || ext === 'json')\r\n        return <FileJson className=\"h-4 w-4 text-yellow-300 shrink-0\" />;\r\n    if (language === 'markdown' || ['md', 'mdx'].includes(ext!))\r\n        return <FileType className=\"h-4 w-4 text-slate-300 shrink-0\" />;\r\n    if (['shell', 'bash'].includes(language) || ['sh', 'bash', 'zsh'].includes(ext!))\r\n        return <FileText className=\"h-4 w-4 text-green-400 shrink-0\" />;\r\n    return <File className=\"h-4 w-4 text-slate-500 shrink-0\" />;\r\n}\r\n\r\ntype ContextMenuState = { x: number; y: number; fileId: string } | null;\r\n\r\nexport default function FileExplorer({\r\n    files,\r\n    activeFileId,\r\n    onOpenFile,\r\n    onCreateFile,\r\n    onDeleteFile,\r\n    onRenameFile,\r\n}: FileExplorerProps) {\r\n    const [contextMenu, setContextMenu] = useState<ContextMenuState>(null);\r\n    const [renamingId, setRenamingId] = useState<string | null>(null);\r\n    const [renameValue, setRenameValue] = useState('');\r\n    const [isCreating, setIsCreating] = useState(false);\r\n    const [newFileName, setNewFileName] = useState('');\r\n    const renameInputRef = useRef<HTMLInputElement>(null);\r\n    const createInputRef = useRef<HTMLInputElement>(null);\r\n\r\n    const handleContextMenu = (e: React.MouseEvent, fileId: string) => {\r\n        e.preventDefault();\r\n        setContextMenu({ x: e.clientX, y: e.clientY, fileId });\r\n    };\r\n\r\n    const closeContextMenu = useCallback(() => setContextMenu(null), []);\r\n\r\n    const startRename = useCallback((file: FileItem) => {\r\n        setRenamingId(file._id);\r\n        setRenameValue(file.name);\r\n        closeContextMenu();\r\n        setTimeout(() => {\r\n            renameInputRef.current?.focus();\r\n            renameInputRef.current?.select();\r\n        }, 50);\r\n    }, [closeContextMenu]);\r\n\r\n    const commitRename = useCallback(() => {\r\n        if (renamingId && renameValue.trim()) {\r\n            onRenameFile(renamingId, renameValue.trim());\r\n        }\r\n        setRenamingId(null);\r\n    }, [renamingId, renameValue, onRenameFile]);\r\n\r\n    const startCreate = () => {\r\n        setIsCreating(true);\r\n        setNewFileName('');\r\n        setTimeout(() => createInputRef.current?.focus(), 50);\r\n    };\r\n\r\n    const commitCreate = async () => {\r\n        const name = newFileName.trim();\r\n        if (name) {\r\n            try {\r\n                await onCreateFile(name);\r\n                setIsCreating(false);\r\n                setNewFileName('');\r\n            } catch (err) {\r\n                // Keep creating open so user can try again or fix name\r\n            }\r\n        } else {\r\n            setIsCreating(false);\r\n            setNewFileName('');\r\n        }\r\n    };\r\n\r\n    return (\r\n        <div className=\"flex flex-1 flex-col overflow-hidden bg-[#0d1425]\" onClick={closeContextMenu}>\r\n            {/* Toolbar */}\r\n            <div className=\"flex items-center justify-between px-4 py-3 border-b ide-border bg-[#0a0f1e]/80\">\r\n                <span className=\"text-[10px] font-black uppercase tracking-[0.2em] text-slate-500\">Files</span>\r\n                <button\r\n                    onClick={startCreate}\r\n                    title=\"New File\"\r\n                    className=\"flex items-center gap-1.5 rounded-lg px-2.5 py-1.5 text-[10px] font-black uppercase tracking-widest text-indigo-400 hover:bg-indigo-500/10 transition-all active:scale-95 shadow-sm border border-transparent hover:border-indigo-500/20\"\r\n                >\r\n                    <Plus className=\"h-3.5 w-3.5\" />\r\n                    New\r\n                </button>\r\n            </div>\r\n\r\n            {/* File list */}\r\n            <div className=\"flex-1 overflow-y-auto py-2 custom-scrollbar\">\r\n                {/* New file input */}\r\n                {isCreating && (\r\n                    <div className=\"flex items-center gap-2 px-3 py-2 mx-2 rounded-lg bg-indigo-500/5 border border-indigo-500/20 mb-1\">\r\n                        <File className=\"h-4 w-4 text-indigo-400 shrink-0\" />\r\n                        <input\r\n                            ref={createInputRef}\r\n                            type=\"text\"\r\n                            value={newFileName}\r\n                            onChange={(e) => setNewFileName(e.target.value)}\r\n                            onBlur={commitCreate}\r\n                            onKeyDown={(e) => {\r\n                                if (e.key === 'Enter') commitCreate();\r\n                                if (e.key === 'Escape') { setIsCreating(false); setNewFileName(''); }\r\n                            }}\r\n                            className=\"flex-1 bg-transparent text-xs text-white outline-none placeholder-indigo-300/40\"\r\n                            placeholder=\"filename.py\"\r\n                        />\r\n                    </div>\r\n                )}\r\n\r\n                {files.length === 0 && !isCreating && (\r\n                    <div className=\"flex flex-col items-center justify-center py-8 px-4 text-center opacity-40\">\r\n                        <File className=\"h-8 w-8 mb-2 text-slate-500\" />\r\n                        <p className=\"text-[10px] font-bold uppercase tracking-wider text-slate-500\">No files yet</p>\r\n                        <p className=\"text-[9px] text-slate-600 mt-1\">Click + New to create one</p>\r\n                    </div>\r\n                )}\r\n\r\n                {files.map((file) => (\r\n                    <div\r\n                        key={file._id}\r\n                        onContextMenu={(e) => handleContextMenu(e, file._id)}\r\n                        onClick={() => renamingId !== file._id && onOpenFile(file)}\r\n                        className={cn(\r\n                            'group relative flex items-center gap-3 px-4 py-2.5 cursor-pointer text-xs transition-all duration-300 select-none mx-2 rounded-xl mb-1 border',\r\n                            activeFileId === file._id\r\n                                ? 'bg-indigo-600/10 text-white border-indigo-500/40 shadow-lg shadow-indigo-600/5'\r\n                                : 'text-slate-400 hover:bg-white/[0.05] hover:text-slate-200 border-transparent hover:border-white/5'\r\n                        )}\r\n                    >\r\n                        {/* Active indicator */}\r\n                        {activeFileId === file._id && (\r\n                            <span className=\"absolute left-0 top-1/2 -translate-y-1/2 w-0.5 h-4 rounded-r-full bg-indigo-500 shadow-[0_0_8px_rgba(99,102,241,0.7)]\" />\r\n                        )}\r\n\r\n                        {getFileIcon(file.language, file.name)}\r\n\r\n                        {renamingId === file._id ? (\r\n                            <input\r\n                                ref={renameInputRef}\r\n                                type=\"text\"\r\n                                value={renameValue}\r\n                                onChange={(e) => setRenameValue(e.target.value)}\r\n                                onBlur={commitRename}\r\n                                onKeyDown={(e) => {\r\n                                    if (e.key === 'Enter') commitRename();\r\n                                    if (e.key === 'Escape') setRenamingId(null);\r\n                                }}\r\n                                className=\"flex-1 min-w-0 rounded bg-[#1e293b] px-1 text-xs text-white outline-none ring-1 ring-indigo-500\"\r\n                                onClick={(e) => e.stopPropagation()}\r\n                            />\r\n                        ) : (\r\n                            <span className=\"flex-1 min-w-0 truncate font-medium\">{file.name}</span>\r\n                        )}\r\n\r\n                        {/* Action buttons â€” visible on hover */}\r\n                        <div className=\"flex items-center gap-1 shrink-0 ml-auto opacity-0 group-hover:opacity-100 transition-opacity duration-300\">\r\n                            <button\r\n                                onClick={(e) => { e.stopPropagation(); startRename(file); }}\r\n                                className=\"p-1.5 rounded-lg text-slate-500 hover:text-indigo-400 hover:bg-indigo-500/10 transition-all\"\r\n                                title=\"Rename\"\r\n                            >\r\n                                <Edit2 className=\"h-3.5 w-3.5\" />\r\n                            </button>\r\n                            <button\r\n                                onClick={(e) => { e.stopPropagation(); onDeleteFile(file._id); }}\r\n                                className=\"p-1.5 rounded-lg text-slate-500 hover:text-red-400 hover:bg-red-400/10 transition-all\"\r\n                                title=\"Delete\"\r\n                            >\r\n                                <Trash2 className=\"h-3.5 w-3.5\" />\r\n                            </button>\r\n                        </div>\r\n                    </div>\r\n                ))}\r\n            </div>\r\n\r\n            {/* Context menu */}\r\n            {contextMenu && (\r\n                <div\r\n                    onClick={(e) => e.stopPropagation()}\r\n                    style={{ position: 'fixed', top: contextMenu.y, left: contextMenu.x, zIndex: 1000 }}\r\n                    className=\"rounded-xl border border-white/10 bg-[#0d1425] shadow-2xl backdrop-blur-xl py-1.5 min-w-[150px]\"\r\n                >\r\n                    <button\r\n                        className=\"flex w-full items-center gap-2.5 px-4 py-2 text-xs text-slate-300 hover:bg-white/5 hover:text-white transition-colors\"\r\n                        onClick={() => {\r\n                            const file = files.find((f) => f._id === contextMenu.fileId);\r\n                            if (file) startRename(file);\r\n                        }}\r\n                    >\r\n                        <Edit2 className=\"h-3 w-3 text-indigo-400\" /> Rename\r\n                    </button>\r\n                    <button\r\n                        className=\"flex w-full items-center gap-2.5 px-4 py-2 text-xs text-red-400 hover:bg-red-400/10 transition-colors\"\r\n                        onClick={() => { onDeleteFile(contextMenu.fileId); closeContextMenu(); }}\r\n                    >\r\n                        <Trash2 className=\"h-3 w-3\" /> Delete\r\n                    </button>\r\n                </div>\r\n            )}\r\n        </div>\r\n    );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"E:\\AI_Byte_Solver\\frontend\\src\\components\\ide\\IDESidebar.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":16,"column":78,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":16,"endColumn":81,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[469,472],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[469,472],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import {\r\n    LayoutDashboard, FolderOpen, History, User, X\r\n} from 'lucide-react';\r\nimport { Link } from 'react-router-dom';\r\nimport { cn } from '../../lib/utils';\r\nimport { AILogo } from '../ui/AILogo';\r\n\r\ntype SidebarView = 'projects' | 'history';\r\n\r\ninterface IDESidebarProps {\r\n    activeView: SidebarView;\r\n    onViewChange: (view: SidebarView) => void;\r\n    onClose: () => void;\r\n}\r\n\r\nconst NAV_ITEMS: { id: SidebarView | 'dashboard' | 'profile'; icon: React.FC<any>; label: string }[] = [\r\n    { id: 'dashboard', icon: LayoutDashboard, label: 'Dashboard' },\r\n    { id: 'projects', icon: FolderOpen, label: 'Projects' },\r\n    { id: 'history', icon: History, label: 'History' },\r\n    { id: 'profile', icon: User, label: 'Profile' },\r\n];\r\n\r\nexport default function IDESidebar({ activeView, onViewChange, onClose }: IDESidebarProps) {\r\n    return (\r\n        <div\r\n            className=\"flex flex-col items-center border-r border-[#1e293b] bg-[#111827] transition-all duration-200 shrink-0\"\r\n            style={{ width: 52 }}\r\n        >\r\n            {/* Logo */}\r\n            <div className=\"flex h-12 items-center justify-center border-b border-[#1e293b] w-full p-2\">\r\n                <div className=\"h-8 w-8\">\r\n                    <AILogo className=\"w-full h-full\" />\r\n                </div>\r\n            </div>\r\n\r\n            {/* Nav items */}\r\n            <div className=\"flex flex-1 flex-col items-center gap-1 py-2 w-full px-1\">\r\n                {NAV_ITEMS.map((item) => {\r\n                    const Icon = item.icon;\r\n                    const isActive = item.id === activeView;\r\n\r\n                    if (item.id === 'dashboard') {\r\n                        return (\r\n                            <Link\r\n                                key=\"dashboard\"\r\n                                to=\"/chat\"\r\n                                title=\"Dashboard\"\r\n                                className={cn(\r\n                                    'flex h-9 w-9 items-center justify-center rounded-lg transition-colors',\r\n                                    'text-slate-400 hover:bg-[#1e293b] hover:text-white'\r\n                                )}\r\n                            >\r\n                                <Icon className=\"h-4.5 w-4.5\" />\r\n                            </Link>\r\n                        );\r\n                    }\r\n\r\n                    if (item.id === 'profile') {\r\n                        return (\r\n                            <Link\r\n                                key=\"profile\"\r\n                                to=\"/profile\"\r\n                                title=\"Profile\"\r\n                                className=\"flex h-9 w-9 items-center justify-center rounded-lg text-slate-400 hover:bg-[#1e293b] hover:text-white transition-colors\"\r\n                            >\r\n                                <Icon className=\"h-4.5 w-4.5\" />\r\n                            </Link>\r\n                        );\r\n                    }\r\n\r\n                    return (\r\n                        <button\r\n                            key={item.id}\r\n                            title={item.label}\r\n                            onClick={() => onViewChange(item.id as SidebarView)}\r\n                            className={cn(\r\n                                'flex h-9 w-9 items-center justify-center rounded-lg transition-colors',\r\n                                isActive\r\n                                    ? 'bg-[#6366f1]/20 text-[#6366f1] border border-[#6366f1]/30'\r\n                                    : 'text-slate-400 hover:bg-[#1e293b] hover:text-white'\r\n                            )}\r\n                        >\r\n                            <Icon className=\"h-4 w-4\" />\r\n                        </button>\r\n                    );\r\n                })}\r\n            </div>\r\n\r\n            {/* Close IDE button */}\r\n            <div className=\"pb-2 px-1 w-full flex justify-center\">\r\n                <button\r\n                    onClick={onClose}\r\n                    title=\"Close IDE\"\r\n                    className=\"flex h-9 w-9 items-center justify-center rounded-lg text-slate-500 hover:bg-red-900/30 hover:text-red-400 transition-colors\"\r\n                >\r\n                    <X className=\"h-4 w-4\" />\r\n                </button>\r\n            </div>\r\n        </div>\r\n    );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"E:\\AI_Byte_Solver\\frontend\\src\\components\\ide\\Terminal.tsx","messages":[{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has missing dependencies: 'activeFile?.language' and 'isRunning'. Either include them or remove the dependency array.","line":91,"column":8,"nodeType":"ArrayExpression","endLine":91,"endColumn":24,"suggestions":[{"desc":"Update the dependencies array to be: [token, addLine, isRunning, activeFile?.language]","fix":{"range":[3505,3521],"text":"[token, addLine, isRunning, activeFile?.language]"}}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useEffect, useRef, useCallback, useState } from 'react';\r\nimport { io, Socket } from 'socket.io-client';\r\nimport { Play, Square, Trash2, Loader2, CornerDownLeft } from 'lucide-react';\r\nimport { useIdeStore } from '../../stores/ideStore';\r\nimport { useAuthStore } from '../../stores/authStore';\r\nimport { cn } from '../../lib/utils';\r\n\r\ninterface TerminalProps {\r\n    activeFile: { _id: string; name: string; content: string; language: string } | null;\r\n}\r\n\r\ninterface OutputLine {\r\n    id: string;\r\n    type: 'stdout' | 'stderr' | 'error' | 'info' | 'stdin';\r\n    data: string;\r\n}\r\n\r\nconst BACKEND_URL = import.meta.env.VITE_API_URL?.replace('/api/v1', '') || 'http://localhost:5000';\r\n\r\nexport default function Terminal({ activeFile }: TerminalProps) {\r\n    const { token } = useAuthStore();\r\n    const { appendTerminalOutput, clearTerminalOutput } = useIdeStore();\r\n    const [lines, setLines] = useState<OutputLine[]>([]);\r\n    const [isConnected, setIsConnected] = useState(false);\r\n    const [isRunning, setIsRunning] = useState(false);\r\n    const [stdinInput, setStdinInput] = useState('');\r\n    const socketRef = useRef<Socket | null>(null);\r\n    const bottomRef = useRef<HTMLDivElement>(null);\r\n    const inputRef = useRef<HTMLInputElement>(null);\r\n\r\n    const addLine = useCallback((type: OutputLine['type'], data: string) => {\r\n        setLines((prev) => [...prev, { id: `${Date.now()}-${Math.random()}`, type, data }]);\r\n        appendTerminalOutput(data);\r\n        setTimeout(() => bottomRef.current?.scrollIntoView({ behavior: 'smooth' }), 50);\r\n    }, [appendTerminalOutput]);\r\n\r\n    // Build socket connection\r\n    useEffect(() => {\r\n        if (!token) return;\r\n\r\n        const socket = io(BACKEND_URL, {\r\n            path: '/terminal',\r\n            auth: { token },\r\n            transports: ['websocket'],\r\n            reconnection: true,\r\n            reconnectionDelay: 2000,\r\n        });\r\n\r\n        socket.on('connect', () => {\r\n            setIsConnected(true);\r\n            addLine('info', 'âœ“ Terminal connected\\n');\r\n        });\r\n\r\n        socket.on('disconnect', () => {\r\n            setIsConnected(false);\r\n            setIsRunning(false);\r\n            addLine('info', 'âš  Terminal disconnected\\n');\r\n        });\r\n\r\n        socket.on('output', ({ type, data }: { type: string; data: string }) => {\r\n            addLine(type as OutputLine['type'], data);\r\n\r\n            // If we're running and get a timeout or fatal sandbox error, tell the AI\r\n            if (isRunning && (data.includes('timed out') || data.includes('limit reached'))) {\r\n                window.dispatchEvent(new CustomEvent('terminal:error', {\r\n                    detail: { errorOutput: data, language: activeFile?.language, code: '' }\r\n                }));\r\n            }\r\n        });\r\n\r\n        socket.on('run:complete', () => {\r\n            setIsRunning(false);\r\n        });\r\n\r\n        socket.on('run:error', (payload: { exitCode: number; errorOutput: string; language: string; code: string }) => {\r\n            setIsRunning(false);\r\n            window.dispatchEvent(new CustomEvent('terminal:error', { detail: payload }));\r\n            addLine('info', '\\nðŸ¤– Sending error to AI for auto-fixâ€¦\\n');\r\n        });\r\n\r\n        socket.on('connect_error', (err) => {\r\n            addLine('error', `Connection error: ${err.message}\\n`);\r\n        });\r\n\r\n        socketRef.current = socket;\r\n\r\n        return () => {\r\n            socket.disconnect();\r\n            socketRef.current = null;\r\n        };\r\n    }, [token, addLine]);\r\n\r\n    const handleRun = useCallback(() => {\r\n        if (!socketRef.current || !activeFile || isRunning) return;\r\n\r\n        const content = useIdeStore.getState().openTabs.find(\r\n            (t) => t.fileId === activeFile._id\r\n        )?.content ?? activeFile.content;\r\n\r\n        setIsRunning(true);\r\n        addLine('info', `\\nâ–¶ Running ${activeFile.name}â€¦\\n`);\r\n\r\n        socketRef.current.emit('run', {\r\n            content,\r\n            language: activeFile.language,\r\n            filename: activeFile.name,\r\n        });\r\n\r\n        // Focus the input field so user can type input immediately\r\n        setTimeout(() => inputRef.current?.focus(), 200);\r\n    }, [activeFile, isRunning, addLine]);\r\n\r\n    const handleKill = useCallback(() => {\r\n        if (!socketRef.current || !isRunning) return;\r\n        socketRef.current.emit('kill');\r\n        setIsRunning(false);\r\n    }, [isRunning]);\r\n\r\n    const handleClear = useCallback(() => {\r\n        setLines([]);\r\n        clearTerminalOutput();\r\n    }, [clearTerminalOutput]);\r\n\r\n    // Send stdin input to the running process\r\n    const handleSendInput = useCallback(() => {\r\n        if (!socketRef.current || !isRunning || !stdinInput) return;\r\n        // Show what user typed\r\n        addLine('stdin', `> ${stdinInput}\\n`);\r\n        // Send to backend (with newline so the program's readline gets it)\r\n        socketRef.current.emit('input', stdinInput + '\\n');\r\n        setStdinInput('');\r\n        inputRef.current?.focus();\r\n    }, [isRunning, stdinInput, addLine]);\r\n\r\n    const getLineColor = (type: OutputLine['type']) => {\r\n        switch (type) {\r\n            case 'stderr': return 'text-red-400';\r\n            case 'error': return 'text-red-500';\r\n            case 'info': return 'text-blue-400';\r\n            case 'stdin': return 'text-yellow-400';\r\n            default: return 'text-slate-200';\r\n        }\r\n    };\r\n\r\n    return (\r\n        <div className=\"flex h-full flex-col bg-[#030712] font-mono border-t ide-border\">\r\n            {/* Toolbar */}\r\n            <div className=\"flex items-center gap-3 border-b ide-border px-4 py-2 bg-[#0a0f1e]/80 shrink-0\">\r\n                <div className=\"flex items-center gap-2\">\r\n                    <div className={cn('h-2 w-2 rounded-full', isConnected ? 'bg-emerald-500 shadow-[0_0_8px_rgba(16,185,129,0.5)]' : 'bg-red-500 shadow-[0_0_8px_rgba(239,68,68,0.5)]')} />\r\n                    <span className=\"text-[10px] font-black uppercase tracking-widest text-slate-500\">{isConnected ? 'Online' : 'Offline'}</span>\r\n                </div>\r\n                <div className=\"flex-1\" />\r\n\r\n                {!isRunning ? (\r\n                    <button\r\n                        onClick={handleRun}\r\n                        disabled={!activeFile || !isConnected}\r\n                        className=\"flex items-center gap-2 rounded-xl bg-indigo-600 px-4 py-1.5 text-[10px] font-black uppercase tracking-widest text-white transition-all hover:bg-indigo-500 hover:scale-105 active:scale-95 disabled:opacity-20 shadow-lg shadow-indigo-600/20\"\r\n                    >\r\n                        <Play className=\"h-3.5 w-3.5 fill-current\" /> Run\r\n                    </button>\r\n                ) : (\r\n                    <button\r\n                        onClick={handleKill}\r\n                        className=\"flex items-center gap-2 rounded-xl bg-red-600 px-4 py-1.5 text-[10px] font-black uppercase tracking-widest text-white transition-all hover:bg-red-500 hover:scale-105 active:scale-95\"\r\n                    >\r\n                        <Square className=\"h-3.5 w-3.5 fill-current\" /> Stop\r\n                    </button>\r\n                )}\r\n\r\n                <button\r\n                    onClick={handleClear}\r\n                    className=\"p-1.5 rounded-lg text-slate-500 hover:text-white hover:bg-white/5 transition-all active:scale-90\"\r\n                    title=\"Clear Terminal\"\r\n                >\r\n                    <Trash2 className=\"h-4 w-4\" />\r\n                </button>\r\n            </div>\r\n\r\n            {/* Output */}\r\n            <div className=\"flex-1 overflow-y-auto p-3 custom-scrollbar\">\r\n                {lines.length === 0 && (\r\n                    <p className=\"text-xs text-slate-600 italic\">\r\n                        {isConnected\r\n                            ? 'Click RUN to execute the current fileâ€¦'\r\n                            : 'Connecting to terminalâ€¦'}\r\n                    </p>\r\n                )}\r\n                {lines.map((line) => (\r\n                    <span\r\n                        key={line.id}\r\n                        className={cn('block whitespace-pre-wrap text-xs leading-relaxed', getLineColor(line.type))}\r\n                    >\r\n                        {line.data}\r\n                    </span>\r\n                ))}\r\n                {isRunning && lines.length > 0 && (\r\n                    <div className=\"flex items-center gap-1.5 text-xs text-slate-500 mt-1\">\r\n                        <Loader2 className=\"h-3 w-3 animate-spin\" />\r\n                        <span>Runningâ€¦ (type input below)</span>\r\n                    </div>\r\n                )}\r\n                <div ref={bottomRef} />\r\n            </div>\r\n\r\n            {/* Stdin input bar â€” visible when a process is running */}\r\n            {isRunning && (\r\n                <div className=\"flex items-center gap-3 border-t ide-border bg-[#0a0f1e]/90 backdrop-blur-xl px-4 py-2.5 shrink-0\">\r\n                    <span className=\"text-[10px] text-indigo-400 font-extrabold uppercase tracking-widest\">Input</span>\r\n                    <div className=\"relative flex-1 group\">\r\n                        <input\r\n                            ref={inputRef}\r\n                            type=\"text\"\r\n                            value={stdinInput}\r\n                            onChange={(e) => setStdinInput(e.target.value)}\r\n                            onKeyDown={(e) => { if (e.key === 'Enter') handleSendInput(); }}\r\n                            placeholder=\"Type here...\"\r\n                            className=\"w-full bg-white/5 rounded-lg px-3 py-1.5 text-xs text-white placeholder-slate-600 outline-none border border-white/5 focus:border-indigo-500/30 transition-all\"\r\n                            autoFocus\r\n                        />\r\n                    </div>\r\n                    <button\r\n                        onClick={handleSendInput}\r\n                        disabled={!stdinInput}\r\n                        className=\"flex items-center gap-2 rounded-lg bg-indigo-600/10 px-3 py-1.5 text-[10px] font-black uppercase tracking-widest text-indigo-400 hover:bg-indigo-600 hover:text-white transition-all disabled:opacity-30\"\r\n                    >\r\n                        <CornerDownLeft className=\"h-3.5 w-3.5\" /> Send\r\n                    </button>\r\n                </div>\r\n            )}\r\n        </div>\r\n    );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"E:\\AI_Byte_Solver\\frontend\\src\\components\\layout\\DashboardHeader.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\AI_Byte_Solver\\frontend\\src\\components\\layout\\LeftSidebar.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\AI_Byte_Solver\\frontend\\src\\components\\layout\\RightSidebar.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'_timeline' is defined but never used.","line":41,"column":67,"nodeType":"Identifier","messageId":"unusedVar","endLine":41,"endColumn":76},{"ruleId":"@typescript-eslint/ban-ts-comment","severity":2,"message":"Use \"@ts-expect-error\" instead of \"@ts-ignore\", as \"@ts-ignore\" will do nothing if the following line is error-free.","line":55,"column":5,"nodeType":"Line","messageId":"tsIgnoreInsteadOfExpectError","endLine":55,"endColumn":18,"suggestions":[{"messageId":"replaceTsIgnoreWithTsExpectError","fix":{"range":[1696,1709],"text":"// @ts-expect-error"},"desc":"Replace \"@ts-ignore\" with \"@ts-expect-error\"."}]}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { BarChart3, TrendingUp, LineChart, HelpCircle, GraduationCap } from 'lucide-react';\r\nimport { useState, useEffect } from 'react';\r\nimport { Link } from 'react-router-dom';\r\nimport api from '../../lib/api';\r\nimport { Card, CardHeader, CardTitle, CardContent } from '../ui/Card';\r\nimport { cn } from '../../lib/utils';\r\n\r\ninterface Summary {\r\n  doubtsSolved: number;\r\n  studyTimeMinutes: number;\r\n  topicsCovered: number;\r\n  quizAttempts: number;\r\n  averageQuizScore: number;\r\n  accuracyPercent: number;\r\n}\r\n\r\ninterface Streak {\r\n  currentStreak: number;\r\n  longestStreak: number;\r\n  weeklyActivity: number[];\r\n  totalStudyDays: number;\r\n}\r\n\r\ninterface RightSidebarProps {\r\n  summary: Summary | null;\r\n  streak: Streak | null;\r\n  timeline: { date: string; doubtsSolved: number; studyTimeMinutes: number }[];\r\n  topics: { topic: string; count: number }[];\r\n}\r\n\r\ninterface Doubt {\r\n  _id: string;\r\n  question: string;\r\n  count: number;\r\n}\r\n\r\nconst WEEK_LABELS = ['M', 'T', 'W', 'T', 'F', 'S', 'S'];\r\n// Backend weeklyActivity: 0=Sun, 1=Mon, ... 6=Sat. Display Monâ€“Sun.\r\nconst WEEK_ORDER = [1, 2, 3, 4, 5, 6, 0];\r\n\r\nexport default function RightSidebar({ summary, streak, timeline: _timeline, topics }: RightSidebarProps) {\r\n  const maxTopicCount = Math.max(1, ...topics.map((t) => t.count));\r\n  const topTopics = topics.slice(0, 5).map((t) => ({\r\n    ...t,\r\n    percent: Math.round((t.count / maxTopicCount) * 100),\r\n  }));\r\n\r\n  const rawWeek = streak?.weeklyActivity ?? [0, 0, 0, 0, 0, 0, 0];\r\n  const weekActivity = WEEK_ORDER.map((i) => rawWeek[i] ?? 0);\r\n  const streakDays = streak?.currentStreak ?? 0;\r\n\r\n  const [doubts, setDoubts] = useState<Doubt[]>([]);\r\n\r\n  useEffect(() => {\r\n    // @ts-ignore\r\n    api.getTopDoubts?.(5).then(res => setDoubts(res.data.doubts || [])).catch(() => { });\r\n  }, [summary]); // Refresh when summary updates (implies chat activity)\r\n\r\n  return (\r\n    <aside className=\"glass flex h-full w-80 flex-col overflow-y-auto border-l p-4 transition-all\">\r\n      <h3 className=\"mb-4 flex items-center gap-2 text-sm font-extrabold text-slate-900 dark:text-white\">\r\n        <LineChart className=\"h-5 w-5 text-blue-600 dark:text-blue-400\" />\r\n        Learning Insights\r\n      </h3>\r\n\r\n      <div className=\"space-y-4\">\r\n        {topTopics.length > 0 && (\r\n          <Card className=\"overflow-hidden\">\r\n            <CardHeader className=\"py-2.5 pb-1\">\r\n              <CardTitle className=\"text-xs font-black uppercase tracking-wider text-slate-800 dark:text-slate-200\">\r\n                Most Asked Topics\r\n              </CardTitle>\r\n              <p className=\"text-xs font-medium text-slate-600 dark:text-slate-400\">Based on last 30 days</p>\r\n            </CardHeader>\r\n            <CardContent className=\"space-y-3 pb-3\">\r\n              {topTopics.map((t, i) => (\r\n                <div key={t.topic}>\r\n                  <div className=\"mb-1 flex justify-between text-xs\">\r\n                    <span className=\"truncate text-[hsl(var(--foreground-secondary))]\">{t.topic}</span>\r\n                    <span className=\"tabular-nums text-[hsl(var(--foreground-tertiary))]\">{t.percent}%</span>\r\n                  </div>\r\n                  <div className=\"h-2 overflow-hidden rounded-full bg-slate-100 dark:bg-slate-800\">\r\n                    <div\r\n                      className={cn(\r\n                        'h-full rounded-full',\r\n                        i % 2 === 0 ? 'bg-violet-500' : 'bg-violet-400'\r\n                      )}\r\n                      style={{ width: `${t.percent}%` }}\r\n                    />\r\n                  </div>\r\n                </div>\r\n              ))}\r\n            </CardContent>\r\n          </Card>\r\n        )}\r\n\r\n        {doubts.length > 0 && (\r\n          <Card className=\"overflow-hidden\">\r\n            <CardHeader className=\"py-2.5 pb-1\">\r\n              <CardTitle className=\"text-xs font-black uppercase tracking-wider text-slate-800 dark:text-slate-200\">\r\n                Frequent Doubts\r\n              </CardTitle>\r\n            </CardHeader>\r\n            <CardContent className=\"space-y-2 pb-3\">\r\n              {doubts.map((d) => (\r\n                <div key={d._id} className=\"flex items-start gap-2 text-xs\">\r\n                  <HelpCircle className=\"h-3.5 w-3.5 mt-0.5 text-violet-500 shrink-0\" />\r\n                  <span className=\"text-[hsl(var(--foreground-secondary))] line-clamp-2\" title={d.question}>\r\n                    {d.question}\r\n                  </span>\r\n                </div>\r\n              ))}\r\n            </CardContent>\r\n          </Card>\r\n        )}\r\n\r\n        <Card className=\"overflow-hidden\">\r\n          <CardHeader className=\"py-2.5 pb-1\">\r\n            <CardTitle className=\"text-xs font-black uppercase tracking-wider text-slate-800 dark:text-slate-200\">\r\n              Study Consistency\r\n            </CardTitle>\r\n            <p className=\"text-xs font-medium text-slate-600 dark:text-slate-400\">This week</p>\r\n          </CardHeader>\r\n          <CardContent className=\"pb-3\">\r\n            <div className=\"mb-2 flex justify-between\">\r\n              <div className=\"flex gap-1\">\r\n                {WEEK_LABELS.map((label, i) => (\r\n                  <div\r\n                    key={i}\r\n                    className={cn(\r\n                      'flex h-8 w-8 items-center justify-center rounded-full text-xs font-medium',\r\n                      weekActivity[i] > 0\r\n                        ? 'bg-violet-500 text-white'\r\n                        : 'bg-slate-100 text-slate-400 dark:bg-slate-800 dark:text-slate-500'\r\n                    )}\r\n                  >\r\n                    {label}\r\n                  </div>\r\n                ))}\r\n              </div>\r\n            </div>\r\n            <p className=\"text-sm\">\r\n              <span className=\"font-bold text-[hsl(var(--primary))]\">{streakDays} days</span>\r\n              <span className=\"text-[hsl(var(--foreground-secondary))]\"> streak</span>\r\n            </p>\r\n          </CardContent>\r\n        </Card>\r\n\r\n        <div className=\"grid grid-cols-1 gap-3\">\r\n          <Card className=\"overflow-hidden\">\r\n            <CardContent className=\"flex items-center gap-3 p-4\">\r\n              <div className=\"flex h-12 w-12 items-center justify-center rounded-2xl bg-violet-600 shadow-xl shadow-violet-500/30 ring-4 ring-white/10 overflow-hidden relative\">\r\n                <div className=\"absolute inset-0 bg-gradient-to-tr from-transparent via-white/10 to-transparent animate-shimmer\" />\r\n                <BarChart3 className=\"relative z-10 h-7 w-7 text-white\" />\r\n              </div>\r\n              <div>\r\n                <p\r\n                  className=\"text-4xl font-black tabular-nums text-white leading-none mb-1 drop-shadow-[0_2px_4px_rgba(0,0,0,0.3)]\"\r\n                  style={{ textShadow: '1px 1px 0 #000, -1px -1px 0 #000, 1px -1px 0 #000, -1px 1px 0 #000, 0 1px 2px rgba(0,0,0,0.5)' }}\r\n                >\r\n                  {summary?.doubtsSolved ?? 0}\r\n                </p>\r\n                <p className=\"text-[10px] font-black uppercase tracking-[0.2em] text-slate-900 dark:text-slate-300\">\r\n                  Doubts Solved\r\n                </p>\r\n              </div>\r\n            </CardContent>\r\n          </Card>\r\n          <Card className=\"overflow-hidden\">\r\n            <CardContent className=\"flex items-center gap-3 p-4\">\r\n              <div className=\"flex h-12 w-12 items-center justify-center rounded-2xl bg-violet-600 shadow-xl shadow-violet-500/30 ring-4 ring-white/10 overflow-hidden relative\">\r\n                <div className=\"absolute inset-0 bg-gradient-to-tr from-transparent via-white/10 to-transparent animate-shimmer\" />\r\n                <TrendingUp className=\"relative z-10 h-7 w-7 text-white\" />\r\n              </div>\r\n              <div>\r\n                <p\r\n                  className=\"text-4xl font-black tabular-nums text-white leading-none mb-1 drop-shadow-[0_2px_4px_rgba(0,0,0,0.3)]\"\r\n                  style={{ textShadow: '1px 1px 0 #000, -1px -1px 0 #000, 1px -1px 0 #000, -1px 1px 0 #000, 0 1px 2px rgba(0,0,0,0.5)' }}\r\n                >\r\n                  {summary?.quizAttempts ?? 0}\r\n                </p>\r\n                <p className=\"text-[10px] font-black uppercase tracking-[0.2em] text-slate-900 dark:text-slate-300\">\r\n                  Quizzes Taken\r\n                </p>\r\n              </div>\r\n            </CardContent>\r\n          </Card>\r\n        </div>\r\n\r\n        <Link to=\"/mock-tests\" className=\"block mt-4 mb-2\">\r\n          <Card className=\"overflow-hidden bg-gradient-to-r from-violet-600 to-indigo-600 hover:from-violet-500 hover:to-indigo-500 transition-all shadow-lg hover:shadow-violet-500/25 border-none group transform hover:-translate-y-0.5\">\r\n            <CardContent className=\"flex items-center gap-4 p-5\">\r\n              <div className=\"flex h-12 w-12 shrink-0 items-center justify-center rounded-full bg-white/20 text-white backdrop-blur-sm group-hover:scale-110 transition-transform\">\r\n                <GraduationCap className=\"h-6 w-6\" />\r\n              </div>\r\n              <div>\r\n                <h4 className=\"text-base font-black text-white tracking-tight drop-shadow-sm mb-0.5\">Mock Test Portal</h4>\r\n                <p className=\"text-[11px] font-bold uppercase tracking-widest text-white/70\">Take PYQ Exams</p>\r\n              </div>\r\n            </CardContent>\r\n          </Card>\r\n        </Link>\r\n\r\n        {(summary?.doubtsSolved === 0 && summary?.quizAttempts === 0) || (!summary && topics.length === 0) ? (\r\n          <p className=\"text-center text-xs text-slate-500 dark:text-slate-400\">\r\n            Start chatting to see your insights here.\r\n          </p>\r\n        ) : null}\r\n      </div>\r\n    </aside>\r\n  );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"E:\\AI_Byte_Solver\\frontend\\src\\components\\profile\\AccountInfoCard.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\AI_Byte_Solver\\frontend\\src\\components\\profile\\ActivityProgressCard.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\AI_Byte_Solver\\frontend\\src\\components\\profile\\LearningSummaryCard.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\AI_Byte_Solver\\frontend\\src\\components\\profile\\ProfileActions.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\AI_Byte_Solver\\frontend\\src\\components\\profile\\ProfileEditModal.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\AI_Byte_Solver\\frontend\\src\\components\\profile\\ProfileHeader.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\AI_Byte_Solver\\frontend\\src\\components\\profile\\ThemePreferencesCard.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\AI_Byte_Solver\\frontend\\src\\components\\profile\\index.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\AI_Byte_Solver\\frontend\\src\\components\\ui\\AILogo.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\AI_Byte_Solver\\frontend\\src\\components\\ui\\Badge.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\AI_Byte_Solver\\frontend\\src\\components\\ui\\Button.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\AI_Byte_Solver\\frontend\\src\\components\\ui\\Card.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\AI_Byte_Solver\\frontend\\src\\components\\ui\\Input.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\AI_Byte_Solver\\frontend\\src\\components\\ui\\Logo.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\AI_Byte_Solver\\frontend\\src\\components\\ui\\Modal.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\AI_Byte_Solver\\frontend\\src\\lib\\animations.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\AI_Byte_Solver\\frontend\\src\\lib\\api.ts","messages":[{"ruleId":"@typescript-eslint/ban-ts-comment","severity":2,"message":"Use \"@ts-expect-error\" instead of \"@ts-ignore\", as \"@ts-ignore\" will do nothing if the following line is error-free.","line":32,"column":1,"nodeType":"Line","messageId":"tsIgnoreInsteadOfExpectError","endLine":32,"endColumn":14,"suggestions":[{"messageId":"replaceTsIgnoreWithTsExpectError","fix":{"range":[858,871],"text":"// @ts-expect-error"},"desc":"Replace \"@ts-ignore\" with \"@ts-expect-error\"."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import axios from 'axios';\r\nimport { useAuthStore } from '../stores/authStore';\r\nimport { API_BASE } from './utils';\r\n\r\nconst api = axios.create({\r\n  baseURL: API_BASE,\r\n  headers: { 'Content-Type': 'application/json' },\r\n});\r\n\r\napi.interceptors.request.use((config) => {\r\n  const token = localStorage.getItem('token');\r\n  if (token) config.headers.Authorization = `Bearer ${token}`;\r\n  if (config.data instanceof FormData) {\r\n    delete config.headers['Content-Type'];\r\n  }\r\n  return config;\r\n});\r\n\r\napi.interceptors.response.use(\r\n  (r) => r,\r\n  (err) => {\r\n    if (err.response?.status === 401) {\r\n      useAuthStore.getState().logout();\r\n      if (!window.location.pathname.startsWith('/login') && !window.location.pathname.startsWith('/register')) {\r\n        window.location.href = '/login';\r\n      }\r\n    }\r\n    return Promise.reject(err);\r\n  }\r\n);\r\n\r\n// @ts-ignore\r\napi.getTopDoubts = (limit = 5) => api.get(`/doubts?limit=${limit}`);\r\n\r\nexport default api;\r\n","usedDeprecatedRules":[]},{"filePath":"E:\\AI_Byte_Solver\\frontend\\src\\lib\\markdownCleaner.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":47,"column":48,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":47,"endColumn":51,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1413,1416],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1413,1416],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"no-useless-escape","severity":2,"message":"Unnecessary escape character: \\$.","line":118,"column":29,"nodeType":"Literal","messageId":"unnecessaryEscape","endLine":118,"endColumn":30,"suggestions":[{"messageId":"removeEscape","fix":{"range":[4802,4803],"text":""},"desc":"Remove the `\\`. This maintains the current functionality."},{"messageId":"escapeBackslash","fix":{"range":[4802,4802],"text":"\\"},"desc":"Replace the `\\` with `\\\\` to include the actual backslash character."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'e' is defined but never used.","line":151,"column":16,"nodeType":"Identifier","messageId":"unusedVar","endLine":151,"endColumn":17},{"ruleId":"no-useless-escape","severity":2,"message":"Unnecessary escape character: \\$.","line":289,"column":29,"nodeType":"Literal","messageId":"unnecessaryEscape","endLine":289,"endColumn":30,"suggestions":[{"messageId":"removeEscape","fix":{"range":[13245,13246],"text":""},"desc":"Remove the `\\`. This maintains the current functionality."},{"messageId":"escapeBackslash","fix":{"range":[13245,13245],"text":"\\"},"desc":"Replace the `\\` with `\\\\` to include the actual backslash character."}]}],"suppressedMessages":[],"errorCount":4,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\r\n * Markdown Cleaner + Math Renderer\r\n * Cleans markdown syntax and renders math in one pass to avoid placeholder issues\r\n */\r\n\r\nimport katex from 'katex';\r\nimport 'katex/dist/katex.min.css';\r\n\r\n/**\r\n * Render a single math expression with KaTeX\r\n */\r\nfunction renderKatex(expr: string, displayMode: boolean): string {\r\n  try {\r\n    return katex.renderToString(expr.trim(), {\r\n      displayMode,\r\n      throwOnError: false,\r\n      errorColor: '#cc0000',\r\n      strict: false,\r\n    } as katex.KatexOptions);\r\n  } catch {\r\n    return `<code class=\"math-error\">${expr}</code>`;\r\n  }\r\n}\r\n\r\n/**\r\n * Wrap consecutive <li data-type=\"ul\"> in <ul> and <li data-type=\"ol\"> in <ol>\r\n */\r\nfunction wrapLists(html: string): string {\r\n  // Wrap unordered list items\r\n  html = html.replace(/((?:<li data-type=\"ul\">[\\s\\S]*?<\\/li>\\n?)+)/g, (match) => {\r\n    const items = match.replace(/<li data-type=\"ul\">/g, '<li>');\r\n    return `<ul class=\"list-disc pl-5 my-1.5 space-y-0.5\">${items}</ul>`;\r\n  });\r\n\r\n  // Wrap ordered list items\r\n  html = html.replace(/((?:<li data-type=\"ol\">[\\s\\S]*?<\\/li>\\n?)+)/g, (match) => {\r\n    const items = match.replace(/<li data-type=\"ol\">/g, '<li>');\r\n    return `<ol class=\"list-decimal pl-5 my-1.5 space-y-0.5\">${items}</ol>`;\r\n  });\r\n\r\n  return html;\r\n}\r\n\r\n/**\r\n * Format specialized DeepSeek JSON coding responses into a premium UI card\r\n */\r\nfunction buildStructuredCodingResponse(parsed: any): string {\r\n  let explanationHtml = '';\r\n  if (parsed.explanation) {\r\n    // Process the explanation to support markdown inside it\r\n    explanationHtml = processAIResponse(parsed.explanation);\r\n  }\r\n\r\n  const escapedCode = (parsed.codePatch || '')\r\n    .replace(/&/g, '&amp;')\r\n    .replace(/</g, '&lt;')\r\n    .replace(/>/g, '&gt;')\r\n    .trim();\r\n\r\n  return `<div class=\"ai-structured-response my-6 flex flex-col overflow-hidden rounded-2xl border border-[hsl(var(--glass-border))] bg-gradient-to-br from-slate-900 to-slate-950 shadow-2xl\">\r\n    <div class=\"flex items-center gap-2 border-b border-white/10 bg-white/5 px-5 py-3 backdrop-blur-md\">\r\n      <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\" class=\"text-violet-400\"><path d=\"m18 16 4-4-4-4\"/><path d=\"m6 8-4 4 4 4\"/><path d=\"m14.5 4-5 16\"/></svg>\r\n      <span class=\"text-[13px] font-bold tracking-wide text-slate-200\">AI Coding Assistant</span>\r\n    </div>\r\n    ${explanationHtml ? `\r\n    <div class=\"px-5 py-5 prose prose-invert max-w-none text-[14.5px] leading-relaxed text-slate-300 [&_strong]:text-white [&_strong]:font-semibold\">\r\n      ${explanationHtml}\r\n    </div>\r\n    ` : ''}\r\n    ${escapedCode ? `\r\n    <div class=\"border-t border-white/10 bg-[#0a0f1a] p-5\">\r\n      <div class=\"mb-3 flex items-center justify-between\">\r\n        <div class=\"flex items-center gap-2\">\r\n          <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"14\" height=\"14\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\" class=\"text-indigo-400\"><rect x=\"3\" y=\"3\" width=\"18\" height=\"18\" rx=\"2\" ry=\"2\"/><line x1=\"9\" y1=\"3\" x2=\"9\" y2=\"21\"/></svg>\r\n          <span class=\"text-[11px] font-bold uppercase tracking-wider text-slate-400\">Implementation</span>\r\n        </div>\r\n        <div class=\"flex gap-1.5\">\r\n          <div class=\"h-2 w-2 rounded-full bg-emerald-500/80 shadow-[0_0_8px_rgba(16,185,129,0.5)]\"></div>\r\n          <div class=\"h-2 w-2 rounded-full bg-amber-500/80 shadow-[0_0_8px_rgba(245,158,11,0.5)]\"></div>\r\n          <div class=\"h-2 w-2 rounded-full bg-rose-500/80 shadow-[0_0_8px_rgba(244,63,94,0.5)]\"></div>\r\n        </div>\r\n      </div>\r\n      <div class=\"relative rounded-xl border border-white/5 bg-black/40 p-4\">\r\n        <pre class=\"m-0 overflow-x-auto custom-scrollbar\"><code class=\"block text-[13.5px] font-mono leading-relaxed text-slate-200\">${escapedCode}</code></pre>\r\n      </div>\r\n    </div>\r\n    ` : ''}\r\n  </div>`;\r\n}\r\n\r\n/**\r\n * Process AI response: render math first, then clean markdown\r\n * This avoids the placeholder corruption bugs\r\n */\r\nexport function processAIResponse(text: string): string {\r\n  if (!text) return '';\r\n\r\n  let html = text;\r\n\r\n  // ---- STEP 1: Render math FIRST (before any markdown processing) ----\r\n\r\n  // Block math $$...$$ (must be before single $)\r\n  html = html.replace(/\\$\\$([\\s\\S]*?)\\$\\$/g, (_, math) =>\r\n    renderKatex(math, true)\r\n  );\r\n\r\n  // Block math \\[...\\]\r\n  html = html.replace(/\\\\\\[([\\s\\S]*?)\\\\\\]/g, (_, math) =>\r\n    renderKatex(math, true)\r\n  );\r\n\r\n  // Inline math \\(...\\)\r\n  html = html.replace(/\\\\\\(([\\s\\S]*?)\\\\\\)/g, (_, math) =>\r\n    renderKatex(math, false)\r\n  );\r\n\r\n  // Inline math $...$ (single dollar, not inside katex output)\r\n  html = html.replace(/\\$([^\\$\\n]+)\\$/g, (_, math) => {\r\n    if (math.includes('class=\"katex\"')) return `$${math}$`;\r\n    return renderKatex(math, false);\r\n  });\r\n\r\n  // ---- STEP 1.1: Reasoning Blocks ----\r\n  // Detect and render <thought> blocks (DeepSeek Reasoning)\r\n  html = html.replace(/<thought>([\\s\\S]*?)<\\/thought>/g, (_, content) => {\r\n    return `<div class=\"ai-reasoning my-5 rounded-2xl border border-amber-500/10 bg-amber-500/[0.03] p-5 shadow-sm backdrop-blur-sm\">\r\n      <div class=\"mb-3 flex items-center gap-2 text-amber-600/80 dark:text-amber-500/80\">\r\n        <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"14\" height=\"14\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2.5\" stroke-linecap=\"round\" stroke-linejoin=\"round\"><path d=\"M12 2a7 7 0 0 0-7 7c0 2.38 1.19 4.47 3 5.74V17a2 2 0 0 0 2 2h4a2 2 0 0 0 2-2v-2.26c1.81-1.27 3-3.36 3-5.74a7 7 0 0 0-7-7z\"/><path d=\"M10 22h4\"/></svg>\r\n        <span class=\"text-[11px] font-black uppercase tracking-[0.1em] font-sans\">Byte Reasoning</span>\r\n      </div>\r\n      <div class=\"text-[13.5px] italic leading-relaxed text-slate-600 dark:text-slate-400/90 font-sans border-l-2 border-amber-500/20 pl-4 py-1\">\r\n        ${content.trim().replace(/\\n/g, '<br/>')}\r\n      </div>\r\n    </div>`;\r\n  });\r\n\r\n  // ---- STEP 1.5: Clean backslash escapes ----\r\n  // DeepSeek often returns `\\*\\*Explanation\\*\\*` and `\\```cpp`. We unescape these before formatting.\r\n  html = html.replace(/\\\\([<>[\\]{}()|#*_`~\\\\])/g, '$1');\r\n\r\n  // ---- STEP 2: Code Blocks ----\r\n\r\n  // Triple backtick code blocks ```[lang]\\n[code]\\n```\r\n  html = html.replace(/```(\\w+)?\\n?([\\s\\S]*?)```/g, (_, lang, code) => {\r\n    if (lang?.toLowerCase() === 'json') {\r\n      try {\r\n        const parsed = JSON.parse(code);\r\n        if (parsed.explanation || parsed.codePatch) {\r\n          return buildStructuredCodingResponse(parsed);\r\n        }\r\n      } catch (e) {\r\n        // Fall back to standard code block formatting if JSON is invalid\r\n      }\r\n    }\r\n\r\n    // Basic HTML escaping for code content\r\n    const escaped = code\r\n      .replace(/&/g, '&amp;')\r\n      .replace(/</g, '&lt;')\r\n      .replace(/>/g, '&gt;')\r\n      .trim();\r\n\r\n    // Check if it's a tiny snippet (often used in explanations)\r\n    const lines = code.trim().split('\\n');\r\n    const isTiny = lines.length <= 2 && code.length < 150;\r\n\r\n    if (isTiny && lang !== 'json') {\r\n      return `<div class=\"my-3 rounded-xl bg-slate-900 border border-slate-800/50 px-5 py-3.5 font-mono text-[13.5px] text-slate-300 shadow-inner group/tiny relative overflow-x-auto custom-scrollbar\">\r\n        <code class=\"whitespace-pre\">${escaped}</code>\r\n        <div class=\"absolute right-3 top-3 h-1.5 w-1.5 rounded-full bg-violet-500/30\"></div>\r\n      </div>`;\r\n    }\r\n\r\n    return `<div class=\"code-block-container my-4 group/code shadow-lg\">\r\n      <div class=\"flex items-center justify-between px-4 py-2 bg-slate-800 rounded-t-xl border-x border-t border-slate-700/50\">\r\n        <span class=\"text-[11px] font-bold uppercase tracking-wider text-slate-300\">${lang || 'code'}</span>\r\n        <div class=\"flex gap-1.5\">\r\n          <div class=\"h-2.5 w-2.5 rounded-full bg-slate-600/50\"></div>\r\n          <div class=\"h-2.5 w-2.5 rounded-full bg-indigo-500 shadow-[0_0_8px_rgba(99,102,241,0.5)]\" title=\"Byte AI Snippet\"></div>\r\n        </div>\r\n      </div>\r\n      <pre class=\"code-block m-0 p-4 bg-slate-900 border-x border-b border-slate-700/50 rounded-b-xl overflow-x-auto custom-scrollbar\"><code class=\"text-[13px] font-mono leading-relaxed text-slate-200\">${escaped}</code></pre>\r\n    </div>`;\r\n  });\r\n\r\n  // ---- STEP 3: Tables ----\r\n\r\n  // Detect and render markdown tables\r\n  // Matches: | col | col | \\n |---|---| \\n | val | val |\r\n  const tableRegex = /^\\|(.+)\\|\\s*\\n\\|([-| :]+)\\|\\s*\\n((?:\\|.+\\|\\s*\\n?)*)/gm;\r\n  html = html.replace(tableRegex, (_match, header, _separator, body) => {\r\n    const headers = header.split('|').map((h: string) => h.trim()).filter((h: string) => h !== '');\r\n    const rows = body.trim().split('\\n').map((row: string) => {\r\n      return row.split('|').map((c: string) => c.trim()).filter((c: string, i: number, arr: string[]) => {\r\n        // Only ignore empty strings at the start/end of the row split by |\r\n        return (i > 0 && i < arr.length - 1) || c !== '';\r\n      });\r\n    });\r\n\r\n    const headerHtml = `<thead><tr>${headers.map((h: string) => `<th>${h}</th>`).join('')}</tr></thead>`;\r\n    const bodyHtml = `<tbody>${rows.map((row: string[]) => `<tr>${row.map((c: string) => `<td>${c}</td>`).join('')}</tr>`).join('')}</tbody>`;\r\n\r\n    return `<div class=\"table-wrapper prose\"><table>${headerHtml}${bodyHtml}</table></div>`;\r\n  });\r\n\r\n  // ---- STEP 4: Clean markdown syntax ----\r\n\r\n  // Remove --- horizontal rules\r\n  html = html.replace(/^---+$/gm, '<hr class=\"my-3 border-slate-300 dark:border-slate-600\"/>');\r\n\r\n  // Images ![alt](url)\r\n  // Allows optional whitespace/newlines and captures any URL string robustly, encoding it to fix unescaped spaces\r\n  html = html.replace(/!\\[(.*?)\\]\\s*\\((.*?)\\)/g, (_match, alt, url) => {\r\n    const safeUrl = url.trim().replace(/ /g, '%20');\r\n    return `<img src=\"${safeUrl}\" alt=\"${alt}\" class=\"my-4 w-full max-w-md rounded-2xl shadow-lg border border-[hsl(var(--glass-border))] object-cover object-center bg-slate-900/50\" loading=\"lazy\" />`;\r\n  });\r\n\r\n  // Links [text](url)\r\n  html = html.replace(/(?<!!)\\[(.*?)\\]\\s*\\((.*?)\\)/g, '<a href=\"$2\" target=\"_blank\" rel=\"noopener noreferrer\" class=\"text-violet-500 hover:text-violet-600 dark:text-violet-400 dark:hover:text-violet-300 underline underline-offset-2 transition-colors\">$1</a>');\r\n\r\n  // Headings â†’ bold text (Increased spacing and size)\r\n  html = html.replace(/^#{1,6}\\s+(.+)$/gm, '<strong class=\"block text-lg mt-6 mb-2 text-[hsl(var(--foreground))]\">$1</strong>');\r\n\r\n  // Bold/italic\r\n  html = html.replace(/\\*\\*\\*([\\s\\S]+?)\\*\\*\\*/g, '<strong><em>$1</em></strong>');\r\n  html = html.replace(/\\*\\*([\\s\\S]+?)\\*\\*/g, '<strong>$1</strong>');\r\n  html = html.replace(/(?<!\\*)\\*([^*\\n]+)\\*(?!\\*)/g, '<em>$1</em>');\r\n  html = html.replace(/___([\\s\\S]+?)___/g, '<strong><em>$1</em></strong>');\r\n  html = html.replace(/__([\\s\\S]+?)__/g, '<strong>$1</strong>');\r\n\r\n  // Inline code (Non-block)\r\n  html = html.replace(/`([^`\\n]+)`/g, '<code class=\"px-1.5 py-0.5 rounded bg-slate-200 dark:bg-slate-700 text-sm font-mono\">$1</code>');\r\n\r\n  // ---- STEP 4: List processing ----\r\n\r\n  // Unordered lists â€” mark with data-type for wrapping\r\n  html = html.replace(/^[\\t ]*[-*+]\\s+(.+)$/gm, (match, content) => {\r\n    if (content.includes('code-block-container') || content.includes('table-wrapper')) return match;\r\n    return `<li data-type=\"ul\">${content}</li>`;\r\n  });\r\n\r\n  // Ordered lists â€” mark with data-type for wrapping\r\n  html = html.replace(/^\\s*\\d+\\.\\s+(.+)$/gm, (match, content) => {\r\n    if (content.includes('code-block-container') || content.includes('table-wrapper')) return match;\r\n    return `<li data-type=\"ol\">${content}</li>`;\r\n  });\r\n\r\n  // Wrap consecutive list items in their respective list tags\r\n  html = wrapLists(html);\r\n\r\n  // ---- STEP 5: Paragraphs and line breaks ----\r\n\r\n  // Avoid braking code blocks and tables into paragraphs\r\n  // Split by code-block or table-wrapper blocks\r\n  const parts = html.split(/(<div class=\"(?:code-block-container|table-wrapper)[\\s\\S]*?<\\/div>)/);\r\n  html = parts.map(part => {\r\n    if (part.startsWith('<div class=\"code-block-container') || part.startsWith('<div class=\"table-wrapper')) {\r\n      return part;\r\n    }\r\n\r\n    let processed = part;\r\n    // Double newlines â†’ paragraph breaks\r\n    processed = processed.replace(/\\n\\n+/g, '</p><p class=\"mt-2.5\">');\r\n    // Single newlines â†’ line breaks\r\n    processed = processed.replace(/\\n/g, '<br/>');\r\n    return processed;\r\n  }).join('');\r\n\r\n  // Wrap in paragraph if not already a block element\r\n  if (html.trim() && !html.startsWith('<p') && !html.startsWith('<div') && !html.startsWith('<strong')) {\r\n    html = `<p>${html}</p>`;\r\n  }\r\n\r\n  return html;\r\n}\r\n\r\n/**\r\n * Process user message (minimal formatting, just math + line breaks)\r\n */\r\nexport function processUserMessage(text: string): string {\r\n  if (!text) return '';\r\n\r\n  let html = text;\r\n\r\n  // Render math\r\n  html = html.replace(/\\$\\$([\\s\\S]*?)\\$\\$/g, (_, m) => renderKatex(m, true));\r\n  html = html.replace(/\\\\\\[([\\s\\S]*?)\\\\\\]/g, (_, m) => renderKatex(m, true));\r\n  html = html.replace(/\\\\\\(([\\s\\S]*?)\\\\\\)/g, (_, m) => renderKatex(m, false));\r\n  html = html.replace(/\\$([^\\$\\n]+)\\$/g, (_, m) => renderKatex(m, false));\r\n\r\n  // Line breaks\r\n  html = html.replace(/\\n/g, '<br/>');\r\n\r\n  return html;\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"E:\\AI_Byte_Solver\\frontend\\src\\lib\\mathRenderer.ts","messages":[{"ruleId":"no-useless-escape","severity":2,"message":"Unnecessary escape character: \\$.","line":64,"column":31,"nodeType":"Literal","messageId":"unnecessaryEscape","endLine":64,"endColumn":32,"suggestions":[{"messageId":"removeEscape","fix":{"range":[1748,1749],"text":""},"desc":"Remove the `\\`. This maintains the current functionality."},{"messageId":"escapeBackslash","fix":{"range":[1748,1748],"text":"\\"},"desc":"Replace the `\\` with `\\\\` to include the actual backslash character."}]},{"ruleId":"no-useless-escape","severity":2,"message":"Unnecessary escape character: \\$.","line":81,"column":14,"nodeType":"Literal","messageId":"unnecessaryEscape","endLine":81,"endColumn":15,"suggestions":[{"messageId":"removeEscape","fix":{"range":[2210,2211],"text":""},"desc":"Remove the `\\`. This maintains the current functionality."},{"messageId":"escapeBackslash","fix":{"range":[2210,2210],"text":"\\"},"desc":"Replace the `\\` with `\\\\` to include the actual backslash character."}]},{"ruleId":"no-useless-escape","severity":2,"message":"Unnecessary escape character: \\$.","line":114,"column":24,"nodeType":"Literal","messageId":"unnecessaryEscape","endLine":114,"endColumn":25,"suggestions":[{"messageId":"removeEscape","fix":{"range":[2995,2996],"text":""},"desc":"Remove the `\\`. This maintains the current functionality."},{"messageId":"escapeBackslash","fix":{"range":[2995,2995],"text":"\\"},"desc":"Replace the `\\` with `\\\\` to include the actual backslash character."}]}],"suppressedMessages":[],"errorCount":3,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\r\n * Math Rendering Utility\r\n * Handles KaTeX rendering for inline and block math expressions\r\n */\r\n\r\nimport katex from 'katex';\r\n\r\nexport interface MathRenderOptions {\r\n    displayMode?: boolean;\r\n    throwOnError?: boolean;\r\n    errorColor?: string;\r\n    strict?: boolean;\r\n}\r\n\r\n/**\r\n * Renders math expression using KaTeX\r\n */\r\nexport function renderMath(\r\n    expression: string,\r\n    options: MathRenderOptions = {}\r\n): string {\r\n    const defaultOptions: MathRenderOptions = {\r\n        displayMode: false,\r\n        throwOnError: false,\r\n        errorColor: '#cc0000',\r\n        strict: false,\r\n        ...options,\r\n    };\r\n\r\n    try {\r\n        return katex.renderToString(expression.trim(), defaultOptions as katex.KatexOptions);\r\n    } catch (error) {\r\n        console.error('KaTeX rendering error:', error);\r\n        // Return the original expression wrapped in code tags\r\n        return `<code class=\"math-error\">${expression}</code>`;\r\n    }\r\n}\r\n\r\n/**\r\n * Renders all math expressions in text (inline and block)\r\n * Converts LaTeX delimiters to rendered HTML\r\n */\r\nexport function renderMathInText(text: string): string {\r\n    if (!text) return '';\r\n\r\n    let html = text;\r\n\r\n    // Render block math \\[...\\]\r\n    html = html.replace(/\\\\\\[([\\s\\S]*?)\\\\\\]/g, (_, math) => {\r\n        return renderMath(math, { displayMode: true });\r\n    });\r\n\r\n    // Render inline math \\(...\\)\r\n    html = html.replace(/\\\\\\(([\\s\\S]*?)\\\\\\)/g, (_, math) => {\r\n        return renderMath(math, { displayMode: false });\r\n    });\r\n\r\n    // Render block math $$...$$\r\n    html = html.replace(/\\$\\$([\\s\\S]*?)\\$\\$/g, (_, math) => {\r\n        return renderMath(math, { displayMode: true });\r\n    });\r\n\r\n    // Render inline math $...$\r\n    html = html.replace(/\\$([^\\$\\n]+)\\$/g, (_, math) => {\r\n        return renderMath(math, { displayMode: false });\r\n    });\r\n\r\n    return html;\r\n}\r\n\r\n/**\r\n * Checks if text contains math expressions\r\n */\r\nexport function hasMath(text: string): boolean {\r\n    if (!text) return false;\r\n\r\n    const mathPatterns = [\r\n        /\\\\\\[[\\s\\S]*?\\\\\\]/,    // Block math \\[...\\]\r\n        /\\\\\\([\\s\\S]*?\\\\\\)/,    // Inline math \\(...\\)\r\n        /\\$\\$[\\s\\S]*?\\$\\$/,    // Block math $$...$$\r\n        /\\$[^\\$\\n]+\\$/,        // Inline math $...$\r\n    ];\r\n\r\n    return mathPatterns.some(pattern => pattern.test(text));\r\n}\r\n\r\n/**\r\n * Extracts math expressions from text\r\n */\r\nexport function extractMathExpressions(text: string): {\r\n    inline: string[];\r\n    block: string[];\r\n} {\r\n    const inline: string[] = [];\r\n    const block: string[] = [];\r\n\r\n    // Extract block math\r\n    text.replace(/\\\\\\[([\\s\\S]*?)\\\\\\]/g, (_, math) => {\r\n        block.push(math.trim());\r\n        return '';\r\n    });\r\n\r\n    text.replace(/\\$\\$([\\s\\S]*?)\\$\\$/g, (_, math) => {\r\n        block.push(math.trim());\r\n        return '';\r\n    });\r\n\r\n    // Extract inline math\r\n    text.replace(/\\\\\\(([\\s\\S]*?)\\\\\\)/g, (_, math) => {\r\n        inline.push(math.trim());\r\n        return '';\r\n    });\r\n\r\n    text.replace(/\\$([^\\$\\n]+)\\$/g, (_, math) => {\r\n        inline.push(math.trim());\r\n        return '';\r\n    });\r\n\r\n    return { inline, block };\r\n}\r\n\r\n/**\r\n * Validates if a math expression can be rendered\r\n */\r\nexport function isValidMath(expression: string): boolean {\r\n    try {\r\n        katex.renderToString(expression.trim(), {\r\n            displayMode: false,\r\n            throwOnError: true,\r\n            strict: 'error',\r\n        } as katex.KatexOptions);\r\n        return true;\r\n    } catch {\r\n        return false;\r\n    }\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"E:\\AI_Byte_Solver\\frontend\\src\\lib\\utils.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\AI_Byte_Solver\\frontend\\src\\main.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\AI_Byte_Solver\\frontend\\src\\pages\\Dashboard.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'_' is defined but never used.","line":82,"column":14,"nodeType":"Identifier","messageId":"unusedVar","endLine":82,"endColumn":15},{"ruleId":"no-empty","severity":2,"message":"Empty block statement.","line":82,"column":17,"nodeType":"BlockStatement","messageId":"unexpected","endLine":82,"endColumn":20,"suggestions":[{"messageId":"suggestComment","data":{"type":"block"},"fix":{"range":[3241,3242],"text":" /* empty */ "},"desc":"Add comment inside empty block statement."}]},{"ruleId":"@typescript-eslint/no-unused-expressions","severity":2,"message":"Expected an assignment or function call and instead saw an expression.","line":97,"column":10,"nodeType":"ExpressionStatement","messageId":"unusedExpression","endLine":97,"endColumn":51},{"ruleId":"prefer-const","severity":2,"message":"'activeSessionId' is never reassigned. Use 'const' instead.","line":107,"column":9,"nodeType":"Identifier","messageId":"useConst","endLine":107,"endColumn":24,"fix":{"range":[3856,3888],"text":"const activeSessionId = sessionId;"}},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'_' is defined but never used.","line":170,"column":14,"nodeType":"Identifier","messageId":"unusedVar","endLine":170,"endColumn":15},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'_' is defined but never used.","line":184,"column":14,"nodeType":"Identifier","messageId":"unusedVar","endLine":184,"endColumn":15},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'_' is defined but never used.","line":201,"column":14,"nodeType":"Identifier","messageId":"unusedVar","endLine":201,"endColumn":15},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'_' is defined but never used.","line":226,"column":14,"nodeType":"Identifier","messageId":"unusedVar","endLine":226,"endColumn":15},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'_' is defined but never used.","line":249,"column":14,"nodeType":"Identifier","messageId":"unusedVar","endLine":249,"endColumn":15},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'_' is defined but never used.","line":268,"column":14,"nodeType":"Identifier","messageId":"unusedVar","endLine":268,"endColumn":15}],"suppressedMessages":[],"errorCount":10,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":1,"fixableWarningCount":0,"source":"import { useState, useEffect, useCallback, useRef } from 'react';\r\nimport { useParams, useNavigate } from 'react-router-dom';\r\nimport LeftSidebar from '../components/layout/LeftSidebar';\r\nimport RightSidebar from '../components/layout/RightSidebar';\r\nimport DashboardHeader from '../components/layout/DashboardHeader';\r\nimport ChatPanel from '../components/chat/ChatPanel';\r\nimport PDFUploadModal from '../components/chat/PDFUploadModal';\r\nimport api from '../lib/api';\r\n\r\ninterface Session {\r\n  _id: string;\r\n  title: string;\r\n  mode: 'syllabus' | 'open';\r\n  lastMessageAt?: string;\r\n  pdfIds?: string[] | { _id: string; originalName: string }[] | null;\r\n}\r\n\r\ninterface Message {\r\n  _id: string;\r\n  role: 'user' | 'assistant';\r\n  content: string;\r\n  createdAt?: string;\r\n}\r\n\r\ninterface PDF {\r\n  _id: string;\r\n  originalName: string;\r\n}\r\n\r\nexport default function Dashboard() {\r\n  const { sessionId } = useParams<{ sessionId?: string }>();\r\n  const navigate = useNavigate();\r\n  const [sessions, setSessions] = useState<Session[]>([]);\r\n  const [messages, setMessages] = useState<Message[]>([]);\r\n  const [currentSession, setCurrentSession] = useState<Session | null>(null);\r\n  const [pdfs, setPdfs] = useState<PDF[]>([]);\r\n  const [pendingPdfIds, setPendingPdfIds] = useState<string[]>([]);\r\n  const [summary, setSummary] = useState<Record<string, unknown> | null>(null);\r\n  const [streak, setStreak] = useState<Record<string, unknown> | null>(null);\r\n  const [timeline, setTimeline] = useState<{ date: string; doubtsSolved: number; studyTimeMinutes: number }[]>([]);\r\n  const [topics, setTopics] = useState<{ topic: string; count: number }[]>([]);\r\n  const [isUploadOpen, setIsUploadOpen] = useState(false);\r\n  const [isLoading, setIsLoading] = useState(false);\r\n  const [chatError, setChatError] = useState<string | null>(null);\r\n  const [defaultMode, setDefaultMode] = useState<'syllabus' | 'open'>('syllabus');\r\n  const justCreatedSessionIdRef = useRef<string | null>(null);\r\n\r\n  const normalizeMessage = (m: { _id?: string; id?: string; role: string; content?: string }): Message => ({\r\n    _id: (m._id ?? m.id ?? `msg-${Date.now()}`).toString(),\r\n    role: m.role === 'assistant' ? 'assistant' : 'user',\r\n    content: typeof m.content === 'string' ? m.content : '',\r\n  });\r\n\r\n  const fetchSessions = useCallback(async () => {\r\n    const { data } = await api.get('/chat/sessions');\r\n    setSessions(data.sessions || []);\r\n  }, []);\r\n\r\n  const fetchSession = useCallback(async (id: string) => {\r\n    const { data } = await api.get(`/chat/sessions/${id}`);\r\n    setCurrentSession(data.session);\r\n    setMessages(data.messages || []);\r\n  }, []);\r\n\r\n  const fetchPdfs = useCallback(async () => {\r\n    const { data } = await api.get('/pdf');\r\n    setPdfs(data.pdfs || []);\r\n  }, []);\r\n\r\n  const fetchStats = useCallback(async () => {\r\n    try {\r\n      const [s, st, t, tp] = await Promise.all([\r\n        api.get('/stats/summary'),\r\n        api.get('/streaks'),\r\n        api.get('/stats/timeline?range=week'),\r\n        api.get('/stats/topics'),\r\n      ]);\r\n      setSummary(s.data.summary || null);\r\n      setStreak(st.data.streak || null);\r\n      setTimeline(t.data.timeline || []);\r\n      setTopics(tp.data.topics || []);\r\n    } catch (_) { }\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    fetchSessions();\r\n    fetchPdfs();\r\n    fetchStats();\r\n  }, [fetchSessions, fetchPdfs, fetchStats]);\r\n\r\n  useEffect(() => {\r\n    if (sessionId === justCreatedSessionIdRef.current) {\r\n      justCreatedSessionIdRef.current = null;\r\n      return;\r\n    }\r\n    if (sessionId) fetchSession(sessionId);\r\n    else setCurrentSession(null), setMessages([]);\r\n  }, [sessionId, fetchSession]);\r\n\r\n  const handleNewChat = () => {\r\n    navigate('/chat');\r\n    setCurrentSession(null);\r\n    setMessages([]);\r\n  };\r\n\r\n  const handleSend = async (content: string, pdfId?: string) => {\r\n    let activeSessionId = sessionId;\r\n    if (!activeSessionId) {\r\n      setIsLoading(true);\r\n      setChatError(null);\r\n      try {\r\n        const selectedPdfIds = pendingPdfIds.length > 0 ? pendingPdfIds : (pdfId ? [pdfId] : []);\r\n        const { data } = await api.post('/chat/sessions', {\r\n          title: 'New Chat',\r\n          mode: defaultMode,\r\n          pdfIds: selectedPdfIds,\r\n        });\r\n        const newId = data?.session?._id;\r\n        if (!newId) throw new Error('No session ID returned');\r\n        const msgRes = await api.post(`/chat/sessions/${newId}/messages`, { content });\r\n        const userMsgRes = normalizeMessage(msgRes.data?.userMessage ?? { role: 'user', content });\r\n        const aiMsgRes = normalizeMessage(msgRes.data?.aiMessage ?? { role: 'assistant', content: '' });\r\n        setSessions((prev) => [data.session, ...prev]);\r\n        setCurrentSession(data.session);\r\n        setMessages([userMsgRes, aiMsgRes]);\r\n        justCreatedSessionIdRef.current = newId;\r\n        navigate(`/chat/${newId}`);\r\n        setPendingPdfIds([]);\r\n        setChatError(null);\r\n        fetchStats();\r\n      } catch (err: unknown) {\r\n        const msg = (err as { response?: { data?: { error?: { message?: string } } } })?.response?.data?.error?.message;\r\n        setChatError(msg || 'AI is unavailable. Is Ollama running? Check RUN.md.');\r\n      } finally {\r\n        setIsLoading(false);\r\n      }\r\n      return;\r\n    }\r\n    setIsLoading(true);\r\n    const userMsg: Message = {\r\n      _id: `temp-${Date.now()}`,\r\n      role: 'user',\r\n      content,\r\n    };\r\n    setMessages((prev) => [...prev, userMsg]);\r\n    try {\r\n      const { data } = await api.post(`/chat/sessions/${activeSessionId}/messages`, { content });\r\n      const userMsgRes = normalizeMessage(data?.userMessage ?? { role: 'user', content });\r\n      const aiMsgRes = normalizeMessage(data?.aiMessage ?? { role: 'assistant', content: '' });\r\n      setMessages((prev) =>\r\n        prev.filter((m) => m._id !== userMsg._id).concat(userMsgRes, aiMsgRes)\r\n      );\r\n      setChatError(null);\r\n      fetchStats();\r\n    } catch (err: unknown) {\r\n      setMessages((prev) => prev.filter((m) => m._id !== userMsg._id));\r\n      const msg = (err as { response?: { data?: { error?: { message?: string } } } })?.response?.data?.error?.message;\r\n      setChatError(msg || 'AI is unavailable. Is Ollama running? Check RUN.md.');\r\n    } finally {\r\n      setIsLoading(false);\r\n    }\r\n  };\r\n\r\n  const handleToggleBookmark = async (id: string) => {\r\n    try {\r\n      const { data } = await api.patch(`/chat/sessions/${id}/bookmark`);\r\n      setSessions((prev) =>\r\n        prev.map((s) => (s._id === id ? { ...s, isBookmarked: data.isBookmarked } : s))\r\n      );\r\n    } catch (_) {\r\n      // ignore\r\n    }\r\n  };\r\n\r\n  const handleDeleteSession = async (id: string) => {\r\n    try {\r\n      await api.delete(`/chat/sessions/${id}`);\r\n      setSessions((prev) => prev.filter((s) => s._id !== id));\r\n      if (currentSession?._id === id) {\r\n        setCurrentSession(null);\r\n        setMessages([]);\r\n        navigate('/chat', { replace: true });\r\n      }\r\n    } catch (_) {\r\n      // ignore\r\n    }\r\n  };\r\n\r\n  const handleUpload = async (file: File) => {\r\n    const form = new FormData();\r\n    form.append('file', file);\r\n    await api.post('/pdf/upload', form);\r\n    fetchPdfs();\r\n  };\r\n\r\n  const handleModeChange = async (mode: 'syllabus' | 'open') => {\r\n    if (!sessionId || !currentSession) return;\r\n    try {\r\n      const { data } = await api.patch(`/chat/sessions/${sessionId}`, { mode });\r\n      setCurrentSession(data.session);\r\n    } catch (_) {\r\n      // ignore\r\n    }\r\n  };\r\n\r\n  const handleAttachPdf = async (pdfId: string) => {\r\n    if (!sessionId) {\r\n      setPendingPdfIds((prev) => prev.includes(pdfId) ? prev : [...prev, pdfId]);\r\n      return;\r\n    }\r\n\r\n    // Get current IDs\r\n    const currentIds = currentSession?.pdfIds\r\n      ? (Array.isArray(currentSession.pdfIds)\r\n        ? currentSession.pdfIds.map(p => typeof p === 'string' ? p : p._id)\r\n        : [])\r\n      : [];\r\n\r\n    if (currentIds.includes(pdfId)) return; // Already attached\r\n\r\n    const newIds = [...currentIds, pdfId];\r\n\r\n    try {\r\n      const { data } = await api.patch(`/chat/sessions/${sessionId}`, { pdfIds: newIds });\r\n      setCurrentSession(data.session);\r\n    } catch (_) {\r\n      // ignore\r\n    }\r\n  };\r\n\r\n  const handleDetachPdf = async (pdfId: string) => {\r\n    if (!sessionId) {\r\n      setPendingPdfIds((prev) => prev.filter(id => id !== pdfId));\r\n      return;\r\n    }\r\n\r\n    // Get current IDs\r\n    const currentIds = currentSession?.pdfIds\r\n      ? (Array.isArray(currentSession.pdfIds)\r\n        ? currentSession.pdfIds.map(p => typeof p === 'string' ? p : p._id)\r\n        : [])\r\n      : [];\r\n\r\n    const newIds = currentIds.filter(id => id !== pdfId);\r\n\r\n    try {\r\n      const { data } = await api.patch(`/chat/sessions/${sessionId}`, { pdfIds: newIds });\r\n      setCurrentSession(data.session);\r\n    } catch (_) {\r\n      // ignore\r\n    }\r\n  };\r\n\r\n  const handleDeletePdf = async (pdfId: string) => {\r\n    try {\r\n      await api.delete(`/pdf/${pdfId}`);\r\n      fetchPdfs();\r\n\r\n      const currentIds = currentSession?.pdfIds\r\n        ? (Array.isArray(currentSession.pdfIds)\r\n          ? currentSession.pdfIds.map(p => typeof p === 'string' ? p : p._id)\r\n          : [])\r\n        : [];\r\n\r\n      if (currentIds.includes(pdfId)) {\r\n        await handleDetachPdf(pdfId);\r\n      }\r\n    } catch (_) {\r\n      // ignore\r\n    }\r\n  };\r\n\r\n  const attachedPdfIds = currentSession?.pdfIds\r\n    ? (Array.isArray(currentSession.pdfIds)\r\n      ? currentSession.pdfIds.map(p => typeof p === 'string' ? p : p._id)\r\n      : [])\r\n    : [];\r\n\r\n  const attachedPdfNames = currentSession?.pdfIds\r\n    ? (Array.isArray(currentSession.pdfIds)\r\n      ? currentSession.pdfIds.map(p => typeof p === 'object' && p !== null && 'originalName' in p ? p.originalName : '')\r\n        .filter(Boolean)\r\n      : [])\r\n    : [];\r\n\r\n  const effectivePdfIds = sessionId ? attachedPdfIds : pendingPdfIds;\r\n\r\n  // Resolve names for pending IDs or loaded IDs if not populated\r\n  const effectivePdfNames = sessionId && attachedPdfNames.length === attachedPdfIds.length\r\n    ? attachedPdfNames\r\n    : effectivePdfIds.map(id => pdfs.find(p => p._id === id)?.originalName || 'Unknown PDF');\r\n\r\n  return (\r\n    <div className=\"flex h-screen overflow-hidden bg-[hsl(var(--background))]\">\r\n      <LeftSidebar\r\n        sessions={sessions}\r\n        pdfs={pdfs}\r\n        attachedPdfIds={effectivePdfIds}\r\n        attachedPdfNames={effectivePdfNames}\r\n        onNewChat={handleNewChat}\r\n        onUploadClick={() => setIsUploadOpen((v) => !v)}\r\n        onDeleteSession={handleDeleteSession}\r\n        onToggleBookmark={handleToggleBookmark}\r\n        onAttachPdf={handleAttachPdf}\r\n        onDetachPdf={handleDetachPdf}\r\n        onDeletePdf={handleDeletePdf}\r\n      />\r\n      <main className=\"flex min-h-0 flex-1 flex-col overflow-hidden\">\r\n        <DashboardHeader\r\n          mode={currentSession?.mode ?? defaultMode}\r\n          onModeChange={sessionId ? handleModeChange : (m) => setDefaultMode(m)}\r\n        />\r\n        <ChatPanel\r\n          sessionId={sessionId || null}\r\n          messages={messages}\r\n          onSend={handleSend}\r\n          isLoading={isLoading}\r\n          error={chatError}\r\n          onDismissError={() => setChatError(null)}\r\n          mode={currentSession?.mode || 'syllabus'}\r\n          pdfs={pdfs}\r\n          attachedPdfIds={effectivePdfIds}\r\n          onClearPdf={handleDetachPdf}\r\n        />\r\n      </main>\r\n      <RightSidebar\r\n        summary={summary as Parameters<typeof RightSidebar>[0]['summary']}\r\n        streak={streak as Parameters<typeof RightSidebar>[0]['streak']}\r\n        timeline={timeline}\r\n        topics={topics}\r\n      />\r\n      <PDFUploadModal\r\n        isOpen={isUploadOpen}\r\n        onClose={() => setIsUploadOpen(false)}\r\n        onUpload={handleUpload}\r\n        pdfs={pdfs}\r\n      />\r\n    </div>\r\n  );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"E:\\AI_Byte_Solver\\frontend\\src\\pages\\IDEHistory.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\AI_Byte_Solver\\frontend\\src\\pages\\IDEPage.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":27,"column":40,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":27,"endColumn":43,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1295,1298],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1295,1298],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":28,"column":44,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":28,"endColumn":47,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1351,1354],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1351,1354],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":45,"column":64,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":45,"endColumn":67,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2108,2111],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2108,2111],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":95,"column":23,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":95,"endColumn":26,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4138,4141],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4138,4141],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":112,"column":23,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":112,"endColumn":26,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4817,4820],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4817,4820],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":330,"column":51,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":330,"endColumn":54,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[18227,18230],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[18227,18230],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":350,"column":23,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":350,"endColumn":26,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[18951,18954],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[18951,18954],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":451,"column":43,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":451,"endColumn":46,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[25632,25635],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[25632,25635],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":466,"column":32,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":466,"endColumn":35,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[26379,26382],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[26379,26382],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":467,"column":41,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":467,"endColumn":44,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[26430,26433],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[26430,26433],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":484,"column":49,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":484,"endColumn":52,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[27285,27288],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[27285,27288],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":11,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useEffect, useState, useCallback } from 'react';\r\nimport { useNavigate, useParams } from 'react-router-dom';\r\nimport { X, Loader2, ChevronDown, History, FolderOpen, FileCode, Keyboard, ArrowRight, Plus, Terminal as TerminalIcon } from 'lucide-react';\r\nimport { Panel, PanelGroup, PanelResizeHandle } from 'react-resizable-panels';\r\nimport { cn } from '../lib/utils';\r\nimport IDESidebar from '../components/ide/IDESidebar';\r\nimport FileExplorer from '../components/ide/FileExplorer';\r\nimport CodeEditor from '../components/ide/CodeEditor';\r\nimport AIAssistantPanel from '../components/ide/AIAssistantPanel';\r\nimport Terminal from '../components/ide/Terminal';\r\nimport { useIdeStore } from '../stores/ideStore';\r\nimport api from '../lib/api';\r\nimport { AILogo } from '../components/ui/AILogo';\r\n\r\nexport default function IDEPage() {\r\n    const navigate = useNavigate();\r\n    const { projectId } = useParams<{ projectId?: string }>();\r\n\r\n    const {\r\n        activeProjectId, setActiveProject, openTabs, activeTabId,\r\n        openTab, closeTab, setActiveTab, updateTabContent, markTabSaved,\r\n        renameTab, closeAllTabs,\r\n        sidebarCollapsed, sidebarView, setSidebarView, toggleSidebar,\r\n        addToRecentFiles,\r\n    } = useIdeStore();\r\n\r\n    const [files, setFiles] = useState<any[]>([]);\r\n    const [project, setProject] = useState<any>(null);\r\n    const [isLoadingProject, setIsLoadingProject] = useState(false);\r\n    const [terminalOpen, setTerminalOpen] = useState(true);\r\n\r\n    const effectiveProjectId = projectId || activeProjectId;\r\n\r\n    const loadProject = useCallback(async (id: string) => {\r\n        setIsLoadingProject(true);\r\n        closeAllTabs(); // Clear stale tabs from previous project\r\n        try {\r\n            const { data } = await api.get(`/ide/projects/${id}`);\r\n            setProject(data.project);\r\n            setFiles(data.files || []);\r\n            setActiveProject(id);\r\n\r\n            // Restore last open file or auto-open first file\r\n            const lastId = data.project.lastOpenFileId;\r\n            const fileToOpen = (lastId && data.files?.find((f: any) => f._id === lastId)) || data.files?.[0];\r\n\r\n            if (fileToOpen) {\r\n                openTab(fileToOpen);\r\n                addToRecentFiles(fileToOpen._id);\r\n            }\r\n        } catch (err) {\r\n            console.error('Failed to load project', err);\r\n        } finally {\r\n            setIsLoadingProject(false);\r\n        }\r\n    }, [setActiveProject, openTab, closeAllTabs, addToRecentFiles]);\r\n\r\n    useEffect(() => {\r\n        if (effectiveProjectId) {\r\n            loadProject(effectiveProjectId);\r\n        }\r\n    }, [effectiveProjectId, loadProject]);\r\n\r\n    // Track recently opened files\r\n    useEffect(() => {\r\n        if (activeTabId) {\r\n            const tab = openTabs.find(t => t.fileId === activeTabId);\r\n            if (tab) {\r\n                addToRecentFiles({ _id: tab.fileId, name: tab.name, language: tab.language, path: '', content: tab.content, project: '' });\r\n            }\r\n            if (effectiveProjectId) {\r\n                api.put(`/ide/projects/${effectiveProjectId}/state`, { lastOpenFileId: activeTabId })\r\n                    .catch(e => console.error('Failed to save project state', e));\r\n            }\r\n        }\r\n    }, [activeTabId, effectiveProjectId, addToRecentFiles, openTabs]);\r\n\r\n    const handleSaveFile = async (fileId: string, content: string) => {\r\n        if (!effectiveProjectId) return;\r\n        try {\r\n            await api.put(`/ide/projects/${effectiveProjectId}/files/${fileId}`, { content });\r\n            markTabSaved(fileId);\r\n            setFiles((prev) => prev.map((f) => f._id === fileId ? { ...f, content } : f));\r\n        } catch (err) {\r\n            console.error('Save failed', err);\r\n        }\r\n    };\r\n\r\n    const ensureProject = async (): Promise<string | null> => {\r\n        if (effectiveProjectId) return effectiveProjectId;\r\n        try {\r\n            const { data } = await api.post('/ide/projects', { name: 'Untitled Project' });\r\n            navigate(`/ide/${data.project._id}`);\r\n            return data.project._id;\r\n        } catch (err: any) {\r\n            console.error('Failed to auto-create project', err);\r\n            alert('Please create a project first before adding files.');\r\n            return null;\r\n        }\r\n    };\r\n\r\n    const handleCreateFile = async (name: string, content?: string) => {\r\n        const pId = await ensureProject();\r\n        if (!pId) return;\r\n        try {\r\n            const { data } = await api.post(`/ide/projects/${pId}/files`, { name, content });\r\n            setFiles((prev) => {\r\n                if (prev.some(f => f.name === data.file.name)) return prev;\r\n                return [...prev, data.file];\r\n            });\r\n            openTab(data.file);\r\n        } catch (err: any) {\r\n            console.error('Create file failed', err?.response?.data?.error?.message || err.message);\r\n            alert(err?.response?.data?.error?.message || err.message);\r\n        }\r\n    };\r\n\r\n    const handleDeleteFile = async (fileId: string) => {\r\n        if (!effectiveProjectId) return;\r\n        try {\r\n            await api.delete(`/ide/projects/${effectiveProjectId}/files/${fileId}`);\r\n            setFiles((prev) => prev.filter((f) => f._id !== fileId));\r\n        } catch (err) {\r\n            console.error('Delete file failed', err);\r\n        }\r\n    };\r\n\r\n    const handleRenameFile = async (fileId: string, name: string) => {\r\n        if (!effectiveProjectId) return;\r\n        try {\r\n            const { data } = await api.put(`/ide/projects/${effectiveProjectId}/files/${fileId}`, { name });\r\n            setFiles((prev) => prev.map((f) => f._id === fileId ? data.file : f));\r\n            renameTab(fileId, data.file.name, data.file.language);\r\n        } catch (err) {\r\n            console.error('Rename failed', err);\r\n        }\r\n    };\r\n\r\n    const activeTab = openTabs.find((t) => t.fileId === activeTabId);\r\n    const activeFile = files.find((f) => f._id === activeTabId);\r\n\r\n    const handleViewChange = (view: 'projects' | 'history') => {\r\n        if (sidebarView === view) {\r\n            toggleSidebar();\r\n        } else {\r\n            setSidebarView(view);\r\n            if (sidebarCollapsed) toggleSidebar();\r\n        }\r\n    };\r\n\r\n    return (\r\n        <div className=\"flex h-screen w-screen overflow-hidden bg-[#0f172a] text-white font-mono\">\r\n            <IDESidebar\r\n                activeView={sidebarView}\r\n                onViewChange={handleViewChange}\r\n                onClose={() => navigate('/chat')}\r\n            />\r\n\r\n            <PanelGroup direction=\"horizontal\">\r\n                {!sidebarCollapsed && (\r\n                    <>\r\n                        <Panel defaultSize={15} minSize={10} maxSize={30} className=\"flex flex-col border-r border-[#1e293b]\">\r\n                            {sidebarView === 'projects' ? (\r\n                                <div className=\"flex flex-col h-full bg-[#0f172a]\">\r\n                                    <div className=\"flex items-center justify-between px-4 py-2 bg-[#0d1425] border-b border-white/5\">\r\n                                        <span className=\"text-[10px] font-extrabold uppercase tracking-[0.2em] text-indigo-400 truncate mr-2\">\r\n                                            {project ? project.name : 'EXPLORER'}\r\n                                        </span>\r\n                                        <button\r\n                                            onClick={toggleSidebar}\r\n                                            className=\"p-1 rounded-md hover:bg-white/5 text-slate-500 hover:text-white transition-all active:scale-95\"\r\n                                        >\r\n                                            <X className=\"h-3.5 w-3.5\" />\r\n                                        </button>\r\n                                    </div>\r\n                                    <FileExplorer\r\n                                        files={files}\r\n                                        activeFileId={activeTabId}\r\n                                        onOpenFile={openTab}\r\n                                        onCreateFile={handleCreateFile}\r\n                                        onDeleteFile={handleDeleteFile}\r\n                                        onRenameFile={handleRenameFile}\r\n                                    />\r\n                                </div>\r\n                            ) : (\r\n                                <div className=\"flex flex-col h-full bg-[#0f172a]\">\r\n                                    <div className=\"flex items-center justify-between px-3 py-2 border-b border-[#1e293b]\">\r\n                                        <span className=\"text-[10px] font-bold uppercase tracking-widest text-slate-400 flex items-center gap-1.5\">\r\n                                            <History className=\"h-3 w-3\" /> History\r\n                                        </span>\r\n                                        <button\r\n                                            onClick={toggleSidebar}\r\n                                            className=\"p-1 rounded hover:bg-[#1e293b] text-slate-500 hover:text-white transition-colors\"\r\n                                        >\r\n                                            <X className=\"h-3 w-3\" />\r\n                                        </button>\r\n                                    </div>\r\n                                    <div className=\"flex-1 overflow-y-auto\">\r\n                                        <HistoryPanel files={files} />\r\n                                    </div>\r\n                                </div>\r\n                            )}\r\n                        </Panel>\r\n                        <PanelResizeHandle className=\"w-1 bg-[#1e293b] hover:bg-indigo-500 transition-colors\" />\r\n                    </>\r\n                )}\r\n\r\n                <Panel defaultSize={60} minSize={30}>\r\n                    <PanelGroup direction=\"vertical\">\r\n                        <Panel defaultSize={75} minSize={20} className=\"flex flex-col min-w-0 overflow-hidden ide-bg mb-1 rounded-t-2xl border-t border-x ide-border\">\r\n                            <div className=\"flex items-center border-b ide-border bg-[#0a0f1e]/80 backdrop-blur-md overflow-x-auto min-h-[44px] shrink-0 custom-scrollbar\">\r\n                                {openTabs.length === 0 && (\r\n                                    <div className=\"flex items-center gap-2 px-4 py-2 text-[10px] font-bold uppercase tracking-wider text-slate-600 italic\">\r\n                                        No files active\r\n                                    </div>\r\n                                )}\r\n                                {openTabs.map((tab) => (\r\n                                    <button\r\n                                        key={tab.fileId}\r\n                                        onClick={() => setActiveTab(tab.fileId)}\r\n                                        className={cn(\r\n                                            \"flex items-center gap-2.5 px-5 py-2.5 text-[11px] font-bold border-r ide-border whitespace-nowrap transition-all group\",\r\n                                            tab.fileId === activeTabId\r\n                                                ? \"bg-[#0f172a] text-white border-t-2 border-t-indigo-500 shadow-[inset_0_1px_10px_rgba(99,102,241,0.05)]\"\r\n                                                : \"bg-transparent text-slate-400 hover:bg-white/[0.03] hover:text-slate-200\"\r\n                                        )}\r\n                                    >\r\n                                        {tab.isUnsaved && <span className=\"w-1.5 h-1.5 rounded-full bg-indigo-500 shadow-[0_0_8px_rgba(99,102,241,0.5)] animate-pulse\" />}\r\n                                        {tab.name}\r\n                                        <span\r\n                                            onClick={(e) => { e.stopPropagation(); closeTab(tab.fileId); }}\r\n                                            className=\"ml-2 w-4 h-4 flex items-center justify-center rounded hover:bg-white/10 text-slate-500 hover:text-red-400 transition-all opacity-0 group-hover:opacity-100\"\r\n                                        >\r\n                                            <X className=\"h-2.5 w-2.5\" />\r\n                                        </span>\r\n                                    </button>\r\n                                ))}\r\n                                <div className=\"flex-1\" />\r\n\r\n                                {/* Terminal Toggle */}\r\n                                <button\r\n                                    onClick={() => setTerminalOpen(!terminalOpen)}\r\n                                    className={cn(\r\n                                        \"flex items-center gap-2 px-4 py-2.5 text-[10px] font-extrabold uppercase tracking-widest transition-all border-l ide-border shrink-0 bg-transparent active:scale-95\",\r\n                                        terminalOpen ? \"text-indigo-400 bg-indigo-500/5 shadow-[inset_0_-2px_0_rgba(99,102,241,1)]\" : \"text-slate-500 hover:text-slate-300\"\r\n                                    )}\r\n                                    title={terminalOpen ? \"Hide Terminal\" : \"Show Terminal\"}\r\n                                >\r\n                                    <TerminalIcon className=\"h-3.5 w-3.5\" />\r\n                                    Terminal\r\n                                </button>\r\n\r\n                                <button\r\n                                    onClick={() => navigate('/chat')}\r\n                                    className=\"flex items-center gap-2 px-4 py-2.5 text-[10px] font-extrabold uppercase tracking-widest text-slate-500 hover:text-red-400 transition-all border-l ide-border shrink-0 bg-transparent active:scale-95\"\r\n                                    title=\"Close IDE\"\r\n                                >\r\n                                    <X className=\"h-3.5 w-3.5\" />\r\n                                    Close IDE\r\n                                </button>\r\n                            </div>\r\n\r\n                            <div className=\"flex-1 min-h-0 overflow-hidden bg-[#0f172a]\">\r\n                                {isLoadingProject ? (\r\n                                    <div className=\"flex h-full items-center justify-center bg-[#0f172a]\">\r\n                                        <Loader2 className=\"h-8 w-8 animate-spin text-[#6366f1]\" />\r\n                                    </div>\r\n                                ) : !effectiveProjectId ? (\r\n                                    <NoProjectState />\r\n                                ) : !activeTab ? (\r\n                                    <div className=\"flex h-full flex-col items-center justify-center text-slate-500 bg-[#0f172a] p-10 text-center\">\r\n                                        <div className=\"w-20 h-20 bg-white/5 rounded-3xl flex items-center justify-center mb-6 rotate-3\">\r\n                                            <FileCode className=\"h-10 w-10 text-slate-700\" />\r\n                                        </div>\r\n                                        <p className=\"text-sm font-bold text-slate-400 mb-1\">No file selected</p>\r\n                                        <p className=\"text-xs text-slate-600\">Select a file from the explorer or create a new one to start coding</p>\r\n                                    </div>\r\n                                ) : (\r\n                                    <CodeEditor\r\n                                        key={activeTab.fileId}\r\n                                        fileId={activeTab.fileId}\r\n                                        language={activeTab.language}\r\n                                        content={activeTab.content}\r\n                                        onChange={(content) => updateTabContent(activeTab.fileId, content)}\r\n                                        onSave={(content) => handleSaveFile(activeTab.fileId, content)}\r\n                                    />\r\n                                )}\r\n                            </div>\r\n                        </Panel>\r\n\r\n                        {terminalOpen && (\r\n                            <>\r\n                                <PanelResizeHandle className=\"h-1 bg-[#1e293b] hover:bg-indigo-500 transition-colors\" />\r\n                                <Panel defaultSize={25} minSize={10} className=\"border-t border-[#1e293b] flex flex-col shrink-0\">\r\n                                    <div className=\"flex items-center px-3 py-1 bg-[#0a0f1e] border-b border-[#1e293b] shrink-0\">\r\n                                        <span className=\"text-[10px] font-bold uppercase tracking-widest text-slate-400 flex-1\">Terminal</span>\r\n                                        <button\r\n                                            onClick={() => setTerminalOpen(false)}\r\n                                            className=\"p-1 text-slate-400 hover:text-white\"\r\n                                        >\r\n                                            <ChevronDown className=\"h-3.5 w-3.5\" />\r\n                                        </button>\r\n                                    </div>\r\n                                    <div className=\"flex-1 min-h-0 overflow-hidden bg-black/20\">\r\n                                        <Terminal activeFile={activeFile || null} />\r\n                                    </div>\r\n                                </Panel>\r\n                            </>\r\n                        )}\r\n                    </PanelGroup>\r\n                </Panel>\r\n\r\n                <PanelResizeHandle className=\"w-1 bg-[#1e293b] hover:bg-indigo-500 transition-colors\" />\r\n\r\n                <Panel defaultSize={25} minSize={20} maxSize={40} className=\"border-l border-[#1e293b] bg-[#0f172a]\">\r\n                    <AIAssistantPanel\r\n                        files={files}\r\n                        activeFile={activeFile || null}\r\n                        onCreateFile={handleCreateFile}\r\n                    />\r\n                </Panel>\r\n            </PanelGroup >\r\n        </div >\r\n    );\r\n}\r\n\r\nfunction NoProjectState() {\r\n    const navigate = useNavigate();\r\n    const { setProjects } = useIdeStore();\r\n    const [projects, setLocalProjects] = useState<any[]>([]);\r\n    const [isCreating, setIsCreating] = useState(false);\r\n    const [newName, setNewName] = useState('');\r\n    const [error, setError] = useState('');\r\n\r\n    useEffect(() => {\r\n        api.get('/ide/projects').then(({ data }) => {\r\n            setLocalProjects(data.projects || []);\r\n            setProjects(data.projects || []);\r\n        }).catch(console.error);\r\n    }, [setProjects]);\r\n\r\n    const handleCreate = async () => {\r\n        const name = newName.trim();\r\n        if (!name) return;\r\n        setError('');\r\n        setIsCreating(true);\r\n        try {\r\n            const { data } = await api.post('/ide/projects', { name });\r\n            navigate(`/ide/${data.project._id}`);\r\n        } catch (err: any) {\r\n            setError(err?.response?.data?.error?.message || 'Failed to create project');\r\n        } finally {\r\n            setIsCreating(false);\r\n        }\r\n    };\r\n\r\n    const getLangIcon = (lang: string) => {\r\n        switch (lang?.toLowerCase()) {\r\n            case 'javascript':\r\n            case 'js': return <div className=\"p-1.5 rounded-md bg-yellow-400/10 text-yellow-500 font-bold text-[10px]\">JS</div>;\r\n            case 'typescript':\r\n            case 'ts': return <div className=\"p-1.5 rounded-md bg-blue-400/10 text-blue-500 font-bold text-[10px]\">TS</div>;\r\n            case 'cpp':\r\n            case 'c++': return <div className=\"p-1.5 rounded-md bg-indigo-400/10 text-indigo-500 font-bold text-[10px]\">C++</div>;\r\n            case 'python':\r\n            case 'py': return <div className=\"p-1.5 rounded-md bg-emerald-400/10 text-emerald-500 font-bold text-[10px]\">PY</div>;\r\n            default: return <FileCode className=\"h-4 w-4 text-slate-400\" />;\r\n        }\r\n    };\r\n\r\n    return (\r\n        <div className=\"flex h-full flex-col items-center justify-center p-6 mesh-gradient-premium\">\r\n            <div className=\"w-full max-w-2xl glass-premium rounded-3xl p-10 flex flex-col items-center shadow-2xl relative z-10\">\r\n                <div className=\"mb-8 relative group\">\r\n                    <div className=\"absolute -inset-4 bg-gradient-to-r from-indigo-500 to-purple-600 rounded-full blur-xl opacity-20 group-hover:opacity-40 transition duration-1000\"></div>\r\n                    <div className=\"relative h-24 w-24 transition-transform duration-500 hover:scale-105\">\r\n                        <AILogo className=\"w-full h-full\" />\r\n                    </div>\r\n                </div>\r\n\r\n                <h2 className=\"mb-3 text-3xl font-extrabold text-white tracking-tight\">Welcome to AI Byte IDE</h2>\r\n                <p className=\"mb-10 text-base text-slate-300 max-w-md text-center\">\r\n                    The next-gen intelligent workspace. Create a project or pick up where you left off.\r\n                </p>\r\n\r\n                <div className=\"w-full max-w-lg space-y-8\">\r\n                    <div className=\"space-y-3\">\r\n                        <div className=\"flex gap-3\">\r\n                            <div className=\"relative flex-1 group\">\r\n                                <input\r\n                                    type=\"text\"\r\n                                    placeholder=\"Project name (e.g. main.py, dashboard.js)\"\r\n                                    value={newName}\r\n                                    onChange={(e) => setNewName(e.target.value)}\r\n                                    onKeyDown={(e) => e.key === 'Enter' && handleCreate()}\r\n                                    className=\"w-full rounded-xl border border-white/10 bg-white/5 pl-4 pr-10 py-3.5 text-sm text-white placeholder-slate-500 transition-all focus:border-indigo-500 focus:bg-white/10 focus:outline-none focus:ring-4 focus:ring-indigo-500/10\"\r\n                                />\r\n                                <div className=\"absolute right-3 top-1/2 -translate-y-1/2 opacity-0 group-focus-within:opacity-100 transition-opacity\">\r\n                                    <Keyboard className=\"h-3.5 w-3.5 text-indigo-400\" />\r\n                                </div>\r\n                            </div>\r\n                            <button\r\n                                onClick={handleCreate}\r\n                                disabled={isCreating || !newName.trim()}\r\n                                className=\"flex items-center gap-2 rounded-xl bg-indigo-600 px-6 py-3.5 text-sm font-bold text-white shadow-lg shadow-indigo-600/30 transition-all hover:bg-indigo-500 hover:scale-[1.02] active:scale-[0.98] disabled:opacity-50 disabled:grayscale\"\r\n                            >\r\n                                {isCreating ? <Loader2 className=\"h-4 w-4 animate-spin\" /> : <Plus className=\"h-4 w-4\" />}\r\n                                Create\r\n                            </button>\r\n                        </div>\r\n                        {error && <p className=\"text-xs text-red-400 px-2 text-center\">{error}</p>}\r\n                    </div>\r\n\r\n                    {projects.length > 0 && (\r\n                        <div className=\"space-y-4 pt-4 border-t border-white/5\">\r\n                            <div className=\"flex items-center justify-between px-1\">\r\n                                <h3 className=\"text-xs font-bold uppercase tracking-[0.2em] text-slate-500\">Recent Projects</h3>\r\n                                <div className=\"h-px flex-1 mx-4 bg-white/5\"></div>\r\n                            </div>\r\n\r\n                            <div className=\"grid grid-cols-2 gap-3\">\r\n                                {projects.slice(0, 4).map((p) => (\r\n                                    <button\r\n                                        key={p._id}\r\n                                        onClick={() => navigate(`/ide/${p._id}`)}\r\n                                        className=\"group relative flex flex-col gap-1 rounded-2xl border border-white/5 bg-white/[0.03] p-4 text-left transition-all hover:bg-white/[0.07] hover:border-indigo-500/30 hover:shadow-xl hover:-translate-y-1\"\r\n                                    >\r\n                                        <div className=\"flex items-center justify-between mb-2\">\r\n                                            {getLangIcon(p.language)}\r\n                                            <ArrowRight className=\"h-3 w-3 text-slate-600 group-hover:text-indigo-400 group-hover:translate-x-0.5 transition-all\" />\r\n                                        </div>\r\n                                        <div className=\"font-bold text-white text-sm truncate\">{p.name}</div>\r\n                                        <div className=\"text-[10px] text-slate-500 flex items-center gap-1.5\">\r\n                                            <span className=\"w-1 h-1 rounded-full bg-slate-700\"></span>\r\n                                            {new Date(p.updatedAt).toLocaleDateString()}\r\n                                        </div>\r\n                                    </button>\r\n                                ))}\r\n                            </div>\r\n                        </div>\r\n                    )}\r\n                </div>\r\n\r\n                <div className=\"absolute top-0 right-0 -mr-20 -mt-20 h-64 w-64 bg-indigo-600/10 rounded-full blur-[100px] pointer-events-none\"></div>\r\n                <div className=\"absolute bottom-0 left-0 -ml-20 -mb-20 h-64 w-64 bg-purple-600/10 rounded-full blur-[100px] pointer-events-none\"></div>\r\n            </div>\r\n        </div>\r\n    );\r\n}\r\n\r\nfunction HistoryPanel({ files }: { files: any[] }) {\r\n    const { recentFiles, openTab, removeFromRecentFiles, openTabs, setActiveTab } = useIdeStore();\r\n\r\n    if (recentFiles.length === 0) {\r\n        return (\r\n            <div className=\"flex-1 flex flex-col items-center justify-center p-6 text-center\">\r\n                <div className=\"w-10 h-10 rounded-xl bg-white/5 flex items-center justify-center mb-3\">\r\n                    <History className=\"h-5 w-5 text-slate-600\" />\r\n                </div>\r\n                <p className=\"text-[10px] font-bold uppercase tracking-wider text-slate-600\">No history yet</p>\r\n                <p className=\"text-[10px] text-slate-700 mt-1\">Files you open will appear here</p>\r\n            </div>\r\n        );\r\n    }\r\n\r\n    const handleOpen = (entry: any) => {\r\n        const liveFile = files.find((f: any) => f._id === entry.id);\r\n        if (liveFile) { openTab(liveFile); return; }\r\n        const openTab_ = openTabs.find(t => t.fileId === entry.id);\r\n        if (openTab_) { setActiveTab(entry.id); return; }\r\n        if (entry.content !== undefined) {\r\n            openTab({ _id: entry.id, name: entry.name, language: entry.language, content: entry.content, path: '', project: '' });\r\n            return;\r\n        }\r\n        alert(`Content for \"${entry.name}\" is no longer available.`);\r\n    };\r\n\r\n    return (\r\n        <div className=\"flex-1 overflow-y-auto custom-scrollbar py-2\">\r\n            <div className=\"px-3 pb-2\">\r\n                <p className=\"text-[9px] font-black text-slate-600 uppercase tracking-[0.2em]\">Recently Opened</p>\r\n            </div>\r\n            {recentFiles.map((entry) => {\r\n                const liveFile = files.find((f: any) => f._id === entry.id);\r\n                const isDeleted = !liveFile;\r\n                const stillInTab = openTabs.some(t => t.fileId === entry.id);\r\n                const canOpen = !!liveFile || stillInTab || entry.content !== undefined;\r\n\r\n                return (\r\n                    <div key={entry.id} className=\"relative group/hitem mx-1\">\r\n                        <button\r\n                            onClick={() => handleOpen(entry)}\r\n                            title={canOpen ? `Open ${entry.name}` : 'Content no longer available'}\r\n                            className={`w-full flex items-center gap-2.5 rounded-lg px-3 py-2 text-left transition-all group ${canOpen ? 'hover:bg-white/[0.04] cursor-pointer' : 'opacity-30 cursor-default'}`}\r\n                        >\r\n                            <FolderOpen className={`h-3.5 w-3.5 shrink-0 transition-colors ${canOpen ? 'text-slate-600 group-hover:text-indigo-400' : 'text-slate-700'}`} />\r\n                            <div className=\"flex-1 min-w-0\">\r\n                                <div className={`text-xs font-medium truncate transition-colors ${canOpen ? 'text-slate-300 group-hover:text-white' : 'text-slate-700'}`}>\r\n                                    {entry.name}\r\n                                </div>\r\n                                <div className=\"text-[9px] truncate uppercase tracking-wider mt-0.5 text-slate-600\">\r\n                                    {isDeleted ? (\r\n                                        <span className=\"text-amber-600/80\">deleted â€¢ view only</span>\r\n                                    ) : entry.language}\r\n                                </div>\r\n                            </div>\r\n                        </button>\r\n                        <button\r\n                            onClick={(e) => {\r\n                                e.stopPropagation();\r\n                                removeFromRecentFiles(entry.id);\r\n                            }}\r\n                            className=\"absolute right-2 top-1/2 -translate-y-1/2 p-1.5 rounded-md text-red-900 hover:text-red-400 hover:bg-red-400/10 transition-all\"\r\n                            title=\"Remove from history\"\r\n                        >\r\n                            <X className=\"h-3 w-3\" />\r\n                        </button>\r\n                    </div>\r\n                );\r\n            })}\r\n        </div>\r\n    );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"E:\\AI_Byte_Solver\\frontend\\src\\pages\\Login.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\AI_Byte_Solver\\frontend\\src\\pages\\MockTestDashboard.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":61,"column":44,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":61,"endColumn":47,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2032,2035],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2032,2035],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":82,"column":23,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":82,"endColumn":26,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2776,2779],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2776,2779],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useState, useEffect } from 'react';\r\nimport { Link, useNavigate } from 'react-router-dom';\r\nimport { BookOpen, Clock, Search, Trophy, Loader2, Play, HelpCircle, CheckCircle2, XCircle } from 'lucide-react';\r\nimport api from '../lib/api';\r\nimport { cn } from '../lib/utils';\r\nimport Logo from '../components/ui/Logo';\r\nimport { Card, CardContent } from '../components/ui/Card';\r\n\r\nconst EXAMS = [\r\n    {\r\n        id: 'jee-main',\r\n        title: 'JEE Main (NTA)',\r\n        description: 'National Level Engineering Entrance',\r\n        subjects: 'Physics, Chemistry, Mathematics',\r\n        duration: 180,\r\n        questions: 75, // Full Mock\r\n        positive: '+4',\r\n        negative: '-1',\r\n        color: 'from-blue-500 to-cyan-500'\r\n    },\r\n    {\r\n        id: 'neet',\r\n        title: 'NEET (UG)',\r\n        description: 'National Level Medical Entrance',\r\n        subjects: 'Physics, Chemistry, Biology',\r\n        duration: 180,\r\n        questions: 180,\r\n        positive: '+4',\r\n        negative: '-1',\r\n        color: 'from-emerald-500 to-teal-500'\r\n    },\r\n    {\r\n        id: 'upsc',\r\n        title: 'UPSC Civil Services',\r\n        description: 'Preliminary Examination',\r\n        subjects: 'History, Polity, Geography, Economy',\r\n        duration: 120,\r\n        questions: 100,\r\n        positive: '+2',\r\n        negative: '-0.66',\r\n        color: 'from-violet-500 to-purple-500'\r\n    },\r\n    {\r\n        id: 'gate',\r\n        title: 'GATE',\r\n        description: 'Graduate Aptitude Test in Engg.',\r\n        subjects: 'Core Subject + Aptitude + Math',\r\n        duration: 180,\r\n        questions: 65,\r\n        positive: '+2',\r\n        negative: '-0.66',\r\n        color: 'from-orange-500 to-red-500'\r\n    }\r\n];\r\n\r\nexport default function MockTestDashboard() {\r\n    const navigate = useNavigate();\r\n    const [search, setSearch] = useState('');\r\n    const [isGenerating, setIsGenerating] = useState<string | null>(null);\r\n    const [error, setError] = useState<string | null>(null);\r\n    const [history, setHistory] = useState<any[]>([]);\r\n    const [loadingHistory, setLoadingHistory] = useState(true);\r\n\r\n    useEffect(() => {\r\n        api.get('/mock-tests')\r\n            .then(res => {\r\n                setHistory(res.data.tests || []);\r\n            })\r\n            .catch(err => {\r\n                console.error(\"Failed to load history\", err);\r\n            })\r\n            .finally(() => setLoadingHistory(false));\r\n    }, []);\r\n\r\n    const handleGenerate = async (examId: string) => {\r\n        setIsGenerating(examId);\r\n        setError(null);\r\n        try {\r\n            const { data } = await api.post('/mock-tests/generate', { examId });\r\n            // Redirect to the taking UI\r\n            navigate(`/mock-tests/${data.test._id}/take`);\r\n        } catch (err: any) {\r\n            setError(err.response?.data?.error?.message || 'Failed to generate mock test');\r\n            setIsGenerating(null);\r\n        }\r\n    };\r\n\r\n    const filteredExams = EXAMS.filter(e =>\r\n        e.title.toLowerCase().includes(search.toLowerCase()) ||\r\n        e.subjects.toLowerCase().includes(search.toLowerCase())\r\n    );\r\n\r\n    return (\r\n        <div className=\"flex h-screen flex-col bg-[hsl(var(--background))] overflow-y-auto\">\r\n            <header className=\"glass sticky top-0 z-50 flex h-16 shrink-0 items-center justify-between border-b px-6\">\r\n                <div className=\"flex items-center gap-4\">\r\n                    <Link to=\"/\" className=\"hover:opacity-90 transition-opacity\">\r\n                        <Logo />\r\n                    </Link>\r\n                    <div className=\"h-6 w-px bg-slate-200 dark:bg-slate-700 mx-2\" />\r\n                    <h1 className=\"text-xl font-black text-slate-800 dark:text-white uppercase tracking-tight\">Mock Exam Portal</h1>\r\n                </div>\r\n                <Link to=\"/chat\" className=\"text-sm font-semibold text-violet-600 hover:text-violet-700 dark:text-violet-400 dark:hover:text-violet-300\">\r\n                    Back to Dashboard\r\n                </Link>\r\n            </header>\r\n\r\n            <main className=\"flex-1 p-6 md:p-10 max-w-7xl mx-auto w-full space-y-10\">\r\n                {/* Search & Intro */}\r\n                <section className=\"text-center space-y-6 max-w-2xl mx-auto pt-8\">\r\n                    <h2 className=\"text-4xl md:text-5xl font-black tracking-tight text-slate-900 dark:text-white\">\r\n                        Generate Authentic <span className=\"text-transparent bg-clip-text bg-gradient-to-r from-violet-600 to-indigo-600\">PYQ Papers</span>\r\n                    </h2>\r\n                    <p className=\"text-lg text-slate-600 dark:text-slate-400\">\r\n                        Dynamically generated standard mock tests matching exact exam patterns, timings, and negative marking constraints.\r\n                    </p>\r\n\r\n                    <div className=\"relative max-w-xl mx-auto group\">\r\n                        <Search className=\"absolute left-4 top-1/2 -translate-y-1/2 h-5 w-5 text-slate-400 group-focus-within:text-violet-500 transition-colors\" />\r\n                        <input\r\n                            type=\"text\"\r\n                            placeholder=\"Search exams (e.g., JEE, NEET, UPSC)...\"\r\n                            value={search}\r\n                            onChange={(e) => setSearch(e.target.value)}\r\n                            className=\"w-full pl-12 pr-4 py-4 rounded-2xl border-2 border-[hsl(var(--glass-border))] bg-[hsl(var(--glass-bg))] text-lg shadow-sm focus:border-violet-500 focus:outline-none focus:ring-4 focus:ring-violet-500/20 transition-all dark:text-white placeholder:text-slate-400\"\r\n                        />\r\n                    </div>\r\n                    {error && (\r\n                        <div className=\"p-4 bg-red-50 text-red-600 dark:bg-red-900/30 dark:text-red-400 rounded-lg text-sm font-semibold animate-fade-in\">\r\n                            {error}\r\n                        </div>\r\n                    )}\r\n                </section>\r\n\r\n                {/* Exams Grid */}\r\n                <section>\r\n                    <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-2 gap-6\">\r\n                        {filteredExams.map(exam => (\r\n                            <Card key={exam.id} className=\"relative overflow-hidden group hover:shadow-xl transition-all duration-300 border-[hsl(var(--glass-border))] bg-[hsl(var(--glass-bg))]\">\r\n                                <div className={cn(\"absolute top-0 left-0 w-1.5 h-full bg-gradient-to-b\", exam.color)} />\r\n                                <CardContent className=\"p-6 sm:p-8 flex flex-col h-full pl-8\">\r\n                                    <div className=\"flex justify-between items-start mb-4\">\r\n                                        <div>\r\n                                            <h3 className=\"text-2xl font-black text-slate-900 dark:text-white tracking-tight\">{exam.title}</h3>\r\n                                            <p className=\"text-sm font-semibold text-slate-500 uppercase tracking-widest mt-1\">{exam.description}</p>\r\n                                        </div>\r\n                                        <div className={cn(\"p-3 rounded-xl bg-gradient-to-br text-white shadow-lg\", exam.color)}>\r\n                                            <BookOpen className=\"h-6 w-6\" />\r\n                                        </div>\r\n                                    </div>\r\n\r\n                                    <div className=\"grid grid-cols-2 gap-4 my-6 text-sm\">\r\n                                        <div className=\"space-y-1\">\r\n                                            <p className=\"text-slate-500 dark:text-slate-400 flex items-center gap-1.5\"><Clock className=\"h-4 w-4\" /> Duration</p>\r\n                                            <p className=\"font-semibold text-slate-800 dark:text-slate-200\">{exam.duration} Mins</p>\r\n                                        </div>\r\n                                        <div className=\"space-y-1\">\r\n                                            <p className=\"text-slate-500 dark:text-slate-400 flex items-center gap-1.5\"><HelpCircle className=\"h-4 w-4\" /> Questions</p>\r\n                                            <p className=\"font-semibold text-slate-800 dark:text-slate-200\">{exam.questions} {(exam.id === 'jee-main' || exam.id === 'neet' || exam.id === 'upsc' || exam.id === 'gate') ? '(Full Mock)' : '(Mini Mock)'}</p>\r\n                                        </div>\r\n                                        <div className=\"space-y-1\">\r\n                                            <p className=\"text-slate-500 dark:text-slate-400 flex items-center gap-1.5\"><CheckCircle2 className=\"h-4 w-4\" /> Correct</p>\r\n                                            <p className=\"font-semibold text-emerald-600 dark:text-emerald-400\">{exam.positive} Marks</p>\r\n                                        </div>\r\n                                        <div className=\"space-y-1\">\r\n                                            <p className=\"text-slate-500 dark:text-slate-400 flex items-center gap-1.5\"><XCircle className=\"h-4 w-4\" /> Incorrect</p>\r\n                                            <p className=\"font-semibold text-red-600 dark:text-red-400\">{exam.negative} Marks</p>\r\n                                        </div>\r\n                                    </div>\r\n\r\n                                    <p className=\"text-xs text-slate-500 dark:text-slate-400 mb-6 bg-slate-100 dark:bg-slate-800/50 p-3 rounded-lg border border-slate-200 dark:border-slate-700\">\r\n                                        <span className=\"font-bold text-slate-700 dark:text-slate-300\">Syllabus:</span> {exam.subjects}\r\n                                    </p>\r\n\r\n                                    <div className=\"mt-auto pt-4 border-t border-slate-200 dark:border-slate-800\">\r\n                                        <button\r\n                                            onClick={() => handleGenerate(exam.id)}\r\n                                            disabled={isGenerating !== null}\r\n                                            className=\"w-full flex items-center justify-center gap-2 py-3 rounded-xl font-bold text-white shadow-md transition-all active:scale-[0.98] disabled:opacity-70 disabled:cursor-not-allowed bg-slate-900 hover:bg-slate-800 dark:bg-white dark:text-slate-900 dark:hover:bg-slate-100\"\r\n                                        >\r\n                                            {isGenerating === exam.id ? (\r\n                                                <><Loader2 className=\"h-5 w-5 animate-spin\" /> Generating Paper...</>\r\n                                            ) : (\r\n                                                <><Play className=\"h-5 w-5 fill-current\" /> Initialize CBT Engine</>\r\n                                            )}\r\n                                        </button>\r\n                                    </div>\r\n                                </CardContent>\r\n                            </Card>\r\n                        ))}\r\n                    </div>\r\n                </section>\r\n\r\n                {/* History Section */}\r\n                <section className=\"pt-10 border-t border-[hsl(var(--glass-border))]\">\r\n                    <div className=\"flex items-center gap-3 mb-6\">\r\n                        <Trophy className=\"h-6 w-6 text-amber-500\" />\r\n                        <h2 className=\"text-2xl font-black text-slate-900 dark:text-white tracking-tight\">Previous Attempts</h2>\r\n                    </div>\r\n\r\n                    {loadingHistory ? (\r\n                        <div className=\"py-10 flex justify-center\"><Loader2 className=\"h-8 w-8 text-violet-500 animate-spin\" /></div>\r\n                    ) : history.length === 0 ? (\r\n                        <div className=\"text-center py-12 bg-[hsl(var(--glass-bg))] border border-[hsl(var(--glass-border))] rounded-2xl\">\r\n                            <p className=\"text-slate-500 dark:text-slate-400\">No mock tests attempted yet.</p>\r\n                        </div>\r\n                    ) : (\r\n                        <div className=\"grid gap-4 md:grid-cols-2 lg:grid-cols-3\">\r\n                            {history.map(test => (\r\n                                <Link key={test._id} to={`/mock-tests/${test._id}/${test.status === 'completed' ? 'result' : 'take'}`} className=\"block\">\r\n                                    <Card className=\"hover:border-violet-500 hover:shadow-md transition-colors h-full bg-[hsl(var(--glass-bg))] border-[hsl(var(--glass-border))]\">\r\n                                        <CardContent className=\"p-5\">\r\n                                            <div className=\"flex justify-between items-start mb-2\">\r\n                                                <h4 className=\"font-bold text-slate-800 dark:text-slate-200 truncate pr-4\">{test.title}</h4>\r\n                                                {test.status === 'completed' ? (\r\n                                                    <span className=\"px-2 py-0.5 rounded text-xs font-bold bg-green-100 text-green-700 dark:bg-green-900/40 dark:text-green-400\">Complete</span>\r\n                                                ) : (\r\n                                                    <span className=\"px-2 py-0.5 rounded text-xs font-bold bg-amber-100 text-amber-700 dark:bg-amber-900/40 dark:text-amber-400\">In Progress</span>\r\n                                                )}\r\n                                            </div>\r\n                                            <p className=\"text-xs text-slate-500 mb-4\">{new Date(test.createdAt).toLocaleDateString()}</p>\r\n\r\n                                            {test.status === 'completed' && (\r\n                                                <div className=\"flex justify-between items-center text-sm border-t border-slate-100 dark:border-slate-800 pt-3\">\r\n                                                    <span className=\"text-slate-600 dark:text-slate-400\">Score</span>\r\n                                                    <span className=\"font-black text-violet-600 dark:text-violet-400\">{test.score} <span className=\"text-xs text-slate-400\">Marks</span></span>\r\n                                                </div>\r\n                                            )}\r\n                                        </CardContent>\r\n                                    </Card>\r\n                                </Link>\r\n                            ))}\r\n                        </div>\r\n                    )}\r\n                </section>\r\n\r\n            </main>\r\n        </div>\r\n    );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"E:\\AI_Byte_Solver\\frontend\\src\\pages\\MockTestResult.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'ArrowLeft' is defined but never used.","line":3,"column":18,"nodeType":"Identifier","messageId":"unusedVar","endLine":3,"endColumn":27,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"ArrowLeft"},"fix":{"range":[127,138],"text":""},"desc":"Remove unused variable \"ArrowLeft\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'ChevronRight' is defined but never used.","line":3,"column":68,"nodeType":"Identifier","messageId":"unusedVar","endLine":3,"endColumn":80,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"ChevronRight"},"fix":{"range":[177,191],"text":""},"desc":"Remove unused variable \"ChevronRight\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'TrendingUp' is defined but never used.","line":3,"column":93,"nodeType":"Identifier","messageId":"unusedVar","endLine":3,"endColumn":103,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"TrendingUp"},"fix":{"range":[202,214],"text":""},"desc":"Remove unused variable \"TrendingUp\"."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":18,"column":38,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":18,"endColumn":41,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[885,888],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[885,888],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":171,"column":53,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":171,"endColumn":56,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[11094,11097],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[11094,11097],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":5,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useState, useEffect } from 'react';\r\nimport { useParams, useNavigate, Link } from 'react-router-dom';\r\nimport { Trophy, ArrowLeft, Home, FileText, CheckCircle2, XCircle, ChevronRight, BarChart3, TrendingUp, AlertCircle, Loader2 } from 'lucide-react';\r\nimport ReactMarkdown from 'react-markdown';\r\nimport remarkGfm from 'remark-gfm';\r\nimport remarkMath from 'remark-math';\r\nimport rehypeKatex from 'rehype-katex';\r\nimport { PieChart, Pie, Cell, ResponsiveContainer, Tooltip as RechartsTooltip } from 'recharts';\r\nimport api from '../lib/api';\r\nimport { cn } from '../lib/utils';\r\nimport Logo from '../components/ui/Logo';\r\nimport { Card, CardHeader, CardTitle, CardContent } from '../components/ui/Card';\r\n\r\nexport default function MockTestResult() {\r\n    const { id } = useParams<{ id: string }>();\r\n    const navigate = useNavigate();\r\n\r\n    const [test, setTest] = useState<any>(null);\r\n    const [error, setError] = useState<string | null>(null);\r\n    const [loading, setLoading] = useState(true);\r\n\r\n    useEffect(() => {\r\n        api.get(`/mock-tests/${id}`)\r\n            .then(res => {\r\n                const t = res.data.test;\r\n                if (t.status !== 'completed') {\r\n                    navigate(`/mock-tests/${id}/take`);\r\n                    return;\r\n                }\r\n                setTest(t);\r\n            })\r\n            .catch(err => setError(err.response?.data?.error?.message || 'Failed to load test result'))\r\n            .finally(() => setLoading(false));\r\n    }, [id, navigate]);\r\n\r\n    if (loading) {\r\n        return (\r\n            <div className=\"flex h-screen items-center justify-center bg-[hsl(var(--background))]\">\r\n                <Loader2 className=\"h-10 w-10 text-violet-500 animate-spin\" />\r\n            </div>\r\n        );\r\n    }\r\n\r\n    if (error || !test) {\r\n        return (\r\n            <div className=\"flex h-screen items-center justify-center bg-[hsl(var(--background))] p-6 text-center\">\r\n                <div className=\"bg-red-50 text-red-600 dark:bg-red-900/30 dark:text-red-400 p-6 rounded-2xl max-w-md w-full shadow-lg\">\r\n                    <AlertCircle className=\"h-10 w-10 mx-auto mb-4 opacity-80\" />\r\n                    <p className=\"font-bold text-lg mb-4\">{error || 'Test not found'}</p>\r\n                    <button onClick={() => navigate('/mock-tests')} className=\"px-4 py-2 bg-red-600 text-white rounded-lg\">Go Back</button>\r\n                </div>\r\n            </div>\r\n        );\r\n    }\r\n\r\n    const attemptedCount = test.correctAnswers + test.incorrectAnswers;\r\n    const unattemptedCount = test.totalQuestions - attemptedCount;\r\n    const accuracy = attemptedCount > 0 ? Math.round((test.correctAnswers / attemptedCount) * 100) : 0;\r\n\r\n    const pieData = [\r\n        { name: 'Correct', value: test.correctAnswers, color: '#10b981' }, // emerald-500\r\n        { name: 'Incorrect', value: test.incorrectAnswers, color: '#ef4444' }, // red-500\r\n        { name: 'Unattempted', value: unattemptedCount, color: '#94a3b8' }, // slate-400\r\n    ].filter(d => d.value > 0);\r\n\r\n    return (\r\n        <div className=\"flex flex-col min-h-screen bg-[hsl(var(--background))]\">\r\n            <header className=\"glass sticky top-0 z-50 flex h-16 shrink-0 items-center justify-between border-b px-6\">\r\n                <div className=\"flex items-center gap-4\">\r\n                    <Link to=\"/\" className=\"hover:opacity-90 transition-opacity\">\r\n                        <Logo />\r\n                    </Link>\r\n                    <div className=\"h-6 w-px bg-slate-200 dark:bg-slate-700 mx-2\" />\r\n                    <h1 className=\"text-xl font-black text-slate-800 dark:text-white uppercase tracking-tight\">Performance Report</h1>\r\n                </div>\r\n                <div className=\"flex items-center gap-2\">\r\n                    <button onClick={() => navigate('/mock-tests')} className=\"flex items-center gap-2 text-sm font-semibold text-slate-600 hover:text-slate-800 dark:text-slate-400 dark:hover:text-slate-200 px-3 py-1.5 rounded-lg hover:bg-slate-100 dark:hover:bg-slate-800 transition\">\r\n                        <Home className=\"h-4 w-4\" /> Portal\r\n                    </button>\r\n                </div>\r\n            </header>\r\n\r\n            <main className=\"flex-1 p-6 md:p-10 max-w-7xl mx-auto w-full space-y-8\">\r\n                <div className=\"grid grid-cols-1 lg:grid-cols-3 gap-8\">\r\n                    {/* Left Column: Score & Summary */}\r\n                    <div className=\"lg:col-span-1 space-y-8\">\r\n                        <Card className=\"bg-[hsl(var(--glass-bg))] border-[hsl(var(--glass-border))] overflow-hidden shadow-xl\">\r\n                            <div className=\"bg-gradient-to-br from-violet-600 to-indigo-600 p-8 text-center text-white\">\r\n                                <Trophy className=\"h-16 w-16 mx-auto mb-4 opacity-90 drop-shadow-md text-amber-300\" />\r\n                                <h2 className=\"text-sm font-black uppercase tracking-widest text-white/80 mb-2\">{test.title}</h2>\r\n                                <div className=\"flex items-baseline justify-center gap-2 relative\">\r\n                                    <span className=\"text-7xl font-black tabular-nums tracking-tighter drop-shadow-lg\">{test.score}</span>\r\n                                    <span className=\"text-xl font-bold uppercase tracking-wider text-white/70\">Marks</span>\r\n                                </div>\r\n                            </div>\r\n                            <CardContent className=\"p-6\">\r\n                                <div className=\"grid grid-cols-2 gap-4\">\r\n                                    <div className=\"p-4 bg-emerald-50 dark:bg-emerald-900/10 rounded-2xl border border-emerald-100 dark:border-emerald-900/30 text-center\">\r\n                                        <CheckCircle2 className=\"h-6 w-6 text-emerald-500 mx-auto mb-2\" />\r\n                                        <p className=\"text-2xl font-black text-emerald-600 dark:text-emerald-400\">{test.correctAnswers}</p>\r\n                                        <p className=\"text-[10px] font-bold uppercase tracking-widest text-emerald-700/70 dark:text-emerald-500/70 mt-1\">Correct</p>\r\n                                    </div>\r\n                                    <div className=\"p-4 bg-red-50 dark:bg-red-900/10 rounded-2xl border border-red-100 dark:border-red-900/30 text-center\">\r\n                                        <XCircle className=\"h-6 w-6 text-red-500 mx-auto mb-2\" />\r\n                                        <p className=\"text-2xl font-black text-red-600 dark:text-red-400\">{test.incorrectAnswers}</p>\r\n                                        <p className=\"text-[10px] font-bold uppercase tracking-widest text-red-700/70 dark:text-red-500/70 mt-1\">Incorrect</p>\r\n                                    </div>\r\n                                </div>\r\n                            </CardContent>\r\n                        </Card>\r\n\r\n                        {/* Accuracy Pie Chart */}\r\n                        <Card className=\"bg-[hsl(var(--glass-bg))] border-[hsl(var(--glass-border))]\">\r\n                            <CardHeader className=\"pb-2\">\r\n                                <CardTitle className=\"text-sm font-black uppercase tracking-widest flex items-center gap-2\">\r\n                                    <BarChart3 className=\"h-4 w-4 text-violet-500\" /> Attempt Accuracy\r\n                                </CardTitle>\r\n                            </CardHeader>\r\n                            <CardContent className=\"pt-0\">\r\n                                <div className=\"h-48 w-full relative mb-4\">\r\n                                    <ResponsiveContainer width=\"100%\" height=\"100%\">\r\n                                        <PieChart>\r\n                                            <Pie\r\n                                                data={pieData}\r\n                                                cx=\"50%\"\r\n                                                cy=\"50%\"\r\n                                                innerRadius={60}\r\n                                                outerRadius={80}\r\n                                                paddingAngle={5}\r\n                                                dataKey=\"value\"\r\n                                                stroke=\"none\"\r\n                                            >\r\n                                                {pieData.map((entry, index) => (\r\n                                                    <Cell key={`cell-${index}`} fill={entry.color} />\r\n                                                ))}\r\n                                            </Pie>\r\n                                            <RechartsTooltip\r\n                                                contentStyle={{ backgroundColor: 'hsl(var(--popover))', border: '1px solid hsl(var(--border))', borderRadius: '0.5rem', color: 'hsl(var(--popover-foreground))', fontWeight: 'bold' }}\r\n                                                itemStyle={{ fontWeight: 'bold' }}\r\n                                            />\r\n                                        </PieChart>\r\n                                    </ResponsiveContainer>\r\n                                    <div className=\"absolute inset-0 flex flex-col items-center justify-center pointer-events-none\">\r\n                                        <span className=\"text-3xl font-black text-slate-800 dark:text-white\">{accuracy}%</span>\r\n                                        <span className=\"text-[10px] uppercase font-bold text-slate-500 tracking-wider\">Hit Rate</span>\r\n                                    </div>\r\n                                </div>\r\n\r\n                                <div className=\"space-y-2\">\r\n                                    {pieData.map(d => (\r\n                                        <div key={d.name} className=\"flex justify-between items-center text-sm font-semibold\">\r\n                                            <div className=\"flex items-center gap-2\">\r\n                                                <div className=\"w-3 h-3 rounded-full\" style={{ backgroundColor: d.color }} />\r\n                                                <span className=\"text-slate-600 dark:text-slate-400\">{d.name}</span>\r\n                                            </div>\r\n                                            <span className=\"text-slate-900 dark:text-white\">{d.value}</span>\r\n                                        </div>\r\n                                    ))}\r\n                                </div>\r\n                            </CardContent>\r\n                        </Card>\r\n                    </div>\r\n\r\n                    {/* Right Column: Detailed Solutions */}\r\n                    <div className=\"lg:col-span-2 space-y-6\">\r\n                        <h3 className=\"text-2xl font-black text-slate-900 dark:text-white tracking-tight flex items-center gap-3\">\r\n                            <FileText className=\"h-6 w-6 text-violet-500\" /> Question Solutions\r\n                        </h3>\r\n\r\n                        <div className=\"space-y-6\">\r\n                            {test.questions.map((q: any, i: number) => {\r\n                                const isAttempted = q.userAnswerIndex !== null;\r\n                                const isCorrect = isAttempted && q.userAnswerIndex === q.correctAnswerIndex;\r\n\r\n                                return (\r\n                                    <Card key={i} className={cn(\r\n                                        \"overflow-hidden border-l-4 transition-all hover:shadow-md\",\r\n                                        !isAttempted ? \"border-l-slate-400 dark:border-l-slate-600 bg-white dark:bg-slate-900/50\" :\r\n                                            isCorrect ? \"border-l-emerald-500 bg-emerald-50/30 dark:bg-emerald-900/5\" :\r\n                                                \"border-l-red-500 bg-red-50/30 dark:bg-red-900/5\"\r\n                                    )}>\r\n                                        <div className=\"p-6\">\r\n                                            <div className=\"flex justify-between items-start mb-4\">\r\n                                                <div className=\"flex items-center gap-3\">\r\n                                                    <span className=\"flex h-8 w-8 shrink-0 items-center justify-center rounded-lg bg-slate-100 dark:bg-slate-800 text-sm font-black text-slate-700 dark:text-slate-300\">\r\n                                                        Q{i + 1}\r\n                                                    </span>\r\n                                                    {!isAttempted ? (\r\n                                                        <span className=\"text-xs font-bold uppercase tracking-widest text-slate-500\">Unattempted</span>\r\n                                                    ) : isCorrect ? (\r\n                                                        <span className=\"text-xs font-bold uppercase tracking-widest text-emerald-600 flex items-center gap-1\"><CheckCircle2 className=\"h-3 w-3\" /> Correct</span>\r\n                                                    ) : (\r\n                                                        <span className=\"text-xs font-bold uppercase tracking-widest text-red-600 flex items-center gap-1\"><XCircle className=\"h-3 w-3\" /> Incorrect</span>\r\n                                                    )}\r\n                                                </div>\r\n                                                <span className=\"text-[10px] font-bold uppercase tracking-widest text-slate-400\">{q.topic}</span>\r\n                                            </div>\r\n\r\n                                            <div className=\"prose prose-slate dark:prose-invert max-w-none text-base mb-6 font-medium\">\r\n                                                <ReactMarkdown remarkPlugins={[remarkGfm, remarkMath]} rehypePlugins={[rehypeKatex]}>{q.text}</ReactMarkdown>\r\n                                            </div>\r\n\r\n                                            <div className=\"grid grid-cols-1 sm:grid-cols-2 gap-3 mb-6\">\r\n                                                {q.options.map((opt: string, optIdx: number) => {\r\n                                                    const isUserChoice = optIdx === q.userAnswerIndex;\r\n                                                    const isActualCorrect = optIdx === q.correctAnswerIndex;\r\n\r\n                                                    let styleClass = \"border-slate-200 dark:border-slate-800 bg-slate-50 dark:bg-slate-800/50 opacity-70\";\r\n                                                    if (isActualCorrect) {\r\n                                                        styleClass = \"border-emerald-500 bg-emerald-50 dark:bg-emerald-900/20 shadow-sm ring-1 ring-emerald-500/50\";\r\n                                                    } else if (isUserChoice && !isActualCorrect) {\r\n                                                        styleClass = \"border-red-500 bg-red-50 dark:bg-red-900/20 shadow-sm ring-1 ring-red-500/50\";\r\n                                                    }\r\n\r\n                                                    return (\r\n                                                        <div key={optIdx} className={cn(\"flex items-start gap-3 p-3 rounded-xl border-2 transition-all\", styleClass)}>\r\n                                                            <div className={cn(\r\n                                                                \"flex h-6 w-6 shrink-0 items-center justify-center rounded-full text-xs font-bold mt-1\",\r\n                                                                isActualCorrect ? \"bg-emerald-500 text-white\" :\r\n                                                                    (isUserChoice && !isActualCorrect) ? \"bg-red-500 text-white\" :\r\n                                                                        \"bg-slate-200 dark:bg-slate-700 text-slate-500\"\r\n                                                            )}>\r\n                                                                {String.fromCharCode(65 + optIdx)}\r\n                                                            </div>\r\n                                                            <div className=\"prose prose-sm dark:prose-invert max-w-none\">\r\n                                                                <ReactMarkdown remarkPlugins={[remarkGfm, remarkMath]} rehypePlugins={[rehypeKatex]}>{opt}</ReactMarkdown>\r\n                                                            </div>\r\n\r\n                                                            {/* Status Icon Indicator relative to the option block */}\r\n                                                            <div className=\"ml-auto mt-1 shrink-0\">\r\n                                                                {isActualCorrect && <CheckCircle2 className=\"h-5 w-5 text-emerald-500\" />}\r\n                                                                {(isUserChoice && !isActualCorrect) && <XCircle className=\"h-5 w-5 text-red-500\" />}\r\n                                                            </div>\r\n                                                        </div>\r\n                                                    );\r\n                                                })}\r\n                                            </div>\r\n\r\n                                            <div className=\"bg-indigo-50 dark:bg-indigo-900/20 border border-indigo-100 dark:border-indigo-800/50 rounded-xl p-5\">\r\n                                                <h4 className=\"flex items-center gap-2 text-xs font-black uppercase tracking-widest text-indigo-800 dark:text-indigo-400 mb-2\">\r\n                                                    AI Explanation\r\n                                                </h4>\r\n                                                <div className=\"prose prose-sm dark:prose-invert max-w-none text-indigo-900/80 dark:text-indigo-200/80\">\r\n                                                    <ReactMarkdown remarkPlugins={[remarkGfm, remarkMath]} rehypePlugins={[rehypeKatex]}>{q.explanation}</ReactMarkdown>\r\n                                                </div>\r\n                                            </div>\r\n\r\n                                        </div>\r\n                                    </Card>\r\n                                );\r\n                            })}\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            </main>\r\n        </div>\r\n    );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"E:\\AI_Byte_Solver\\frontend\\src\\pages\\MockTestRunner.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":16,"column":38,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":16,"endColumn":41,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[668,671],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[668,671],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":37,"column":60,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":37,"endColumn":63,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1585,1588],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1585,1588],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"react-hooks/immutability","severity":2,"message":"Error: Cannot access variable before it is declared\n\n`handleAutoSubmit` is accessed before it is declared, which prevents the earlier access from updating when this value changes over time.\n\nE:\\AI_Byte_Solver\\frontend\\src\\pages\\MockTestRunner.tsx:64:21\n  62 |                 if (prev !== null && prev <= 1) {\n  63 |                     clearInterval(timer);\n> 64 |                     handleAutoSubmit();\n     |                     ^^^^^^^^^^^^^^^^ `handleAutoSubmit` accessed before it is declared\n  65 |                     return 0;\n  66 |                 }\n  67 |                 return prev ? prev - 1 : 0;\n\nE:\\AI_Byte_Solver\\frontend\\src\\pages\\MockTestRunner.tsx:75:5\n  73 |\n  74 |     // Use useCallback so it can be called safely from useEffect\n> 75 |     const handleAutoSubmit = useCallback(async () => {\n     |     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n> 76 |         if (isSubmitting) return;\n     | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n> 77 |         handleSubmit(true);\n     | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n> 78 |     }, [isSubmitting, answers]);\n     | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ `handleAutoSubmit` is declared here\n  79 |\n  80 |     const handleSubmit = async (isAuto = false) => {\n  81 |         if (!isAuto) {","line":64,"column":21,"nodeType":null,"endLine":64,"endColumn":37},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'handleAutoSubmit'. Either include it or remove the dependency array.","line":72,"column":8,"nodeType":"ArrayExpression","endLine":72,"endColumn":24,"suggestions":[{"desc":"Update the dependencies array to be: [timeLeft, test, handleAutoSubmit]","fix":{"range":[2910,2926],"text":"[timeLeft, test, handleAutoSubmit]"}}]},{"ruleId":"react-hooks/immutability","severity":2,"message":"Error: Cannot access variable before it is declared\n\n`handleSubmit` is accessed before it is declared, which prevents the earlier access from updating when this value changes over time.\n\nE:\\AI_Byte_Solver\\frontend\\src\\pages\\MockTestRunner.tsx:77:9\n  75 |     const handleAutoSubmit = useCallback(async () => {\n  76 |         if (isSubmitting) return;\n> 77 |         handleSubmit(true);\n     |         ^^^^^^^^^^^^ `handleSubmit` accessed before it is declared\n  78 |     }, [isSubmitting, answers]);\n  79 |\n  80 |     const handleSubmit = async (isAuto = false) => {\n\nE:\\AI_Byte_Solver\\frontend\\src\\pages\\MockTestRunner.tsx:80:5\n  78 |     }, [isSubmitting, answers]);\n  79 |\n> 80 |     const handleSubmit = async (isAuto = false) => {\n     |     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n> 81 |         if (!isAuto) {\n     | ^^^^^^^^^^^^^^^^^^^^^^\n> 82 |             const confirmSubmit = window.confirm(\"Are you sure you want to submit the test? You cannot change answers after submitting.\");\n     â€¦\n     | ^^^^^^^^^^^^^^^^^^^^^^\n> 93 |         }\n     | ^^^^^^^^^^^^^^^^^^^^^^\n> 94 |     };\n     | ^^^^^^^ `handleSubmit` is declared here\n  95 |\n  96 |     const formatTime = (secs: number) => {\n  97 |         const h = Math.floor(secs / 3600);","line":77,"column":9,"nodeType":null,"endLine":77,"endColumn":21},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useCallback has a missing dependency: 'handleSubmit'. Either include it or remove the dependency array.","line":78,"column":8,"nodeType":"ArrayExpression","endLine":78,"endColumn":31,"suggestions":[{"desc":"Update the dependencies array to be: [isSubmitting, handleSubmit]","fix":{"range":[3125,3148],"text":"[isSubmitting, handleSubmit]"}}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":90,"column":23,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":90,"endColumn":26,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3616,3619],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3616,3619],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":131,"column":57,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":131,"endColumn":60,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[5027,5030],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[5027,5030],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":166,"column":70,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":166,"endColumn":73,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[6664,6667],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[6664,6667],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":362,"column":53,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":362,"endColumn":56,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[20730,20733],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[20730,20733],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":8,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useState, useEffect, useCallback } from 'react';\r\nimport { useParams, useNavigate } from 'react-router-dom';\r\nimport { Clock, ChevronLeft, ChevronRight, Save, LayoutGrid, AlertCircle, Loader2 } from 'lucide-react';\r\nimport ReactMarkdown from 'react-markdown';\r\nimport remarkGfm from 'remark-gfm';\r\nimport remarkMath from 'remark-math';\r\nimport rehypeKatex from 'rehype-katex';\r\nimport api from '../lib/api';\r\nimport { cn } from '../lib/utils';\r\nimport Logo from '../components/ui/Logo';\r\n\r\nexport default function MockTestRunner() {\r\n    const { id } = useParams<{ id: string }>();\r\n    const navigate = useNavigate();\r\n\r\n    const [test, setTest] = useState<any>(null);\r\n    const [currentQ, setCurrentQ] = useState(0);\r\n    const [answers, setAnswers] = useState<(number | string | null)[]>([]);\r\n    const [timeLeft, setTimeLeft] = useState<number | null>(null);\r\n    const [error, setError] = useState<string | null>(null);\r\n    const [isSubmitting, setIsSubmitting] = useState(false);\r\n    const [showPalette, setShowPalette] = useState(false);\r\n\r\n    const [activeSubject, setActiveSubject] = useState<string | null>(null);\r\n\r\n    useEffect(() => {\r\n        api.get(`/mock-tests/${id}`)\r\n            .then(res => {\r\n                const t = res.data.test;\r\n                if (t.status === 'completed') {\r\n                    navigate(`/mock-tests/${id}/result`); // already submitted\r\n                    return;\r\n                }\r\n                setTest(t);\r\n\r\n                // initialize answers array\r\n                const initialAnswers = t.questions.map((q: any) => q.userAnswerIndex !== undefined ? q.userAnswerIndex : null);\r\n                setAnswers(initialAnswers);\r\n\r\n                // Initialize active subject if available\r\n                if (t.questions.length > 0 && t.questions[0].subject) {\r\n                    setActiveSubject(t.questions[0].subject);\r\n                }\r\n\r\n                // Calculate remaining time\r\n                const elapsed = (Date.now() - new Date(t.createdAt).getTime()) / 1000;\r\n                const totalSecs = t.durationMinutes * 60;\r\n                const remain = Math.max(0, Math.floor(totalSecs - elapsed));\r\n                setTimeLeft(remain);\r\n            })\r\n            .catch(err => {\r\n                setError(err.response?.data?.error?.message || 'Failed to load test');\r\n            });\r\n    }, [id, navigate]);\r\n\r\n    // Timer Tick\r\n    useEffect(() => {\r\n        if (timeLeft === null || timeLeft <= 0 || !test) return;\r\n\r\n        const timer = setInterval(() => {\r\n            setTimeLeft(prev => {\r\n                if (prev !== null && prev <= 1) {\r\n                    clearInterval(timer);\r\n                    handleAutoSubmit();\r\n                    return 0;\r\n                }\r\n                return prev ? prev - 1 : 0;\r\n            });\r\n        }, 1000);\r\n\r\n        return () => clearInterval(timer);\r\n    }, [timeLeft, test]);\r\n\r\n    // Use useCallback so it can be called safely from useEffect\r\n    const handleAutoSubmit = useCallback(async () => {\r\n        if (isSubmitting) return;\r\n        handleSubmit(true);\r\n    }, [isSubmitting, answers]);\r\n\r\n    const handleSubmit = async (isAuto = false) => {\r\n        if (!isAuto) {\r\n            const confirmSubmit = window.confirm(\"Are you sure you want to submit the test? You cannot change answers after submitting.\");\r\n            if (!confirmSubmit) return;\r\n        }\r\n\r\n        setIsSubmitting(true);\r\n        try {\r\n            await api.post(`/mock-tests/${id}/submit`, { answers });\r\n            navigate(`/mock-tests/${id}/result`);\r\n        } catch (err: any) {\r\n            setError(err.response?.data?.error?.message || 'Submission failed');\r\n            setIsSubmitting(false);\r\n        }\r\n    };\r\n\r\n    const formatTime = (secs: number) => {\r\n        const h = Math.floor(secs / 3600);\r\n        const m = Math.floor((secs % 3600) / 60);\r\n        const s = secs % 60;\r\n        return `${h.toString().padStart(2, '0')}:${m.toString().padStart(2, '0')}:${s.toString().padStart(2, '0')}`;\r\n    };\r\n\r\n    const handleOptionSelect = (optIndex: number) => {\r\n        const newAnswers = [...answers];\r\n        newAnswers[currentQ] = optIndex;\r\n        setAnswers(newAnswers);\r\n    };\r\n\r\n    const handleNumericalChange = (val: string) => {\r\n        const newAnswers = [...answers];\r\n        newAnswers[currentQ] = val;\r\n        setAnswers(newAnswers);\r\n    };\r\n\r\n    const handleClearResponse = () => {\r\n        const newAnswers = [...answers];\r\n        newAnswers[currentQ] = null;\r\n        setAnswers(newAnswers);\r\n    };\r\n\r\n    const handleNavigateQuestion = (newIndex: number) => {\r\n        setCurrentQ(newIndex);\r\n        if (test?.questions[newIndex]?.subject) {\r\n            setActiveSubject(test.questions[newIndex].subject);\r\n        }\r\n    };\r\n\r\n    const handleSubjectClick = (subject: string) => {\r\n        setActiveSubject(subject);\r\n        // Find the first question of this subject and jump to it\r\n        const firstIndex = test.questions.findIndex((q: any) => q.subject === subject);\r\n        if (firstIndex !== -1) {\r\n            setCurrentQ(firstIndex);\r\n        }\r\n        setShowPalette(false);\r\n    };\r\n\r\n    if (error) {\r\n        return (\r\n            <div className=\"flex h-screen items-center justify-center bg-[hsl(var(--background))] p-6 text-center\">\r\n                <div className=\"bg-red-50 text-red-600 dark:bg-red-900/30 dark:text-red-400 p-6 rounded-2xl max-w-md w-full shadow-lg\">\r\n                    <AlertCircle className=\"h-10 w-10 mx-auto mb-4 opacity-80\" />\r\n                    <h2 className=\"text-xl font-bold mb-2\">Error</h2>\r\n                    <p>{error}</p>\r\n                    <button onClick={() => navigate('/mock-tests')} className=\"mt-6 px-4 py-2 bg-red-600 text-white rounded-lg font-semibold hover:bg-red-700 transition\">Return to Portal</button>\r\n                </div>\r\n            </div>\r\n        );\r\n    }\r\n\r\n    if (!test || timeLeft === null) {\r\n        return (\r\n            <div className=\"flex h-screen items-center justify-center bg-[hsl(var(--background))]\">\r\n                <div className=\"flex flex-col items-center text-slate-500 animate-pulse\">\r\n                    <Loader2 className=\"h-10 w-10 animate-spin mb-4 text-violet-500\" />\r\n                    <p className=\"font-semibold tracking-widest uppercase\">Initializing CBT Engine...</p>\r\n                </div>\r\n            </div>\r\n        );\r\n    }\r\n\r\n    const question = test.questions[currentQ];\r\n    const attemptedCount = answers.filter(a => a !== null).length;\r\n\r\n    // Derive unique subjects for tabs\r\n    const uniqueSubjects = Array.from(new Set(test.questions.map((q: any) => q.subject).filter(Boolean))) as string[];\r\n\r\n    return (\r\n        <div className=\"flex flex-col h-screen bg-[hsl(var(--background))] overflow-hidden select-none\">\r\n            {/* Top Bar */}\r\n            <header className=\"h-14 shrink-0 bg-slate-900 border-b border-slate-800 text-white flex items-center justify-between px-4 sm:px-6 shadow-md z-10 relative\">\r\n                <div className=\"flex items-center gap-4\">\r\n                    <Logo />\r\n                    <span className=\"hidden sm:inline font-black tracking-widest text-[10px] uppercase text-slate-400 bg-slate-800 px-2 py-1 rounded\">CBT MODE</span>\r\n                </div>\r\n                <div className=\"font-bold tracking-tight\">{test.title}</div>\r\n\r\n                <div className=\"flex items-center gap-4\">\r\n                    <button\r\n                        onClick={() => setShowPalette(!showPalette)}\r\n                        className=\"md:hidden p-2 rounded-lg bg-slate-800 text-slate-300 hover:bg-slate-700\"\r\n                    >\r\n                        <LayoutGrid className=\"h-5 w-5\" />\r\n                    </button>\r\n\r\n                    <div className={cn(\r\n                        \"flex items-center gap-2 font-mono font-bold text-lg px-4 py-1.5 rounded-lg border\",\r\n                        timeLeft < 300\r\n                            ? \"bg-red-900/50 text-red-400 border-red-500/50 animate-pulse\"\r\n                            : \"bg-slate-800 text-slate-200 border-slate-700\"\r\n                    )}>\r\n                        <Clock className=\"h-5 w-5\" />\r\n                        {formatTime(timeLeft)}\r\n                    </div>\r\n                </div>\r\n            </header>\r\n\r\n            {/* Subject Tabs */}\r\n            {uniqueSubjects.length > 0 && (\r\n                <div className=\"flex bg-slate-800 border-b border-slate-700 px-4 overflow-x-auto custom-scrollbar shrink-0\">\r\n                    {uniqueSubjects.map(subject => (\r\n                        <button\r\n                            key={subject}\r\n                            onClick={() => handleSubjectClick(subject)}\r\n                            className={cn(\r\n                                \"px-6 py-3 font-bold text-sm tracking-wide whitespace-nowrap transition-colors border-b-2\",\r\n                                activeSubject === subject\r\n                                    ? \"text-violet-400 border-violet-500 bg-slate-900/50\"\r\n                                    : \"text-slate-400 border-transparent hover:text-slate-200 hover:bg-slate-700/50\"\r\n                            )}\r\n                        >\r\n                            {subject}\r\n                        </button>\r\n                    ))}\r\n                </div>\r\n            )}\r\n\r\n            <div className=\"flex flex-1 min-h-0 bg-slate-50 dark:bg-[#0B1121]\">\r\n                {/* Main Test Area */}\r\n                <main className=\"flex-1 flex flex-col min-w-0\">\r\n\r\n                    {/* Question Header */}\r\n                    <div className=\"h-14 shrink-0 border-b border-slate-200 dark:border-slate-800/60 bg-white dark:bg-[#0F172A] flex items-center justify-between px-6 shadow-sm z-0\">\r\n                        <div className=\"flex items-center gap-3\">\r\n                            <h2 className=\"text-xl font-black text-slate-800 dark:text-slate-100\">Question {currentQ + 1}</h2>\r\n                            <span className={cn(\r\n                                \"text-[10px] font-black uppercase tracking-widest px-2 py-0.5 rounded\",\r\n                                question.difficulty === 'easy' ? \"bg-green-100 text-green-700 dark:bg-green-900/30 dark:text-green-400\" :\r\n                                    question.difficulty === 'hard' ? \"bg-red-100 text-red-700 dark:bg-red-900/30 dark:text-red-400\" :\r\n                                        \"bg-amber-100 text-amber-700 dark:bg-amber-900/30 dark:text-amber-400\"\r\n                            )}>{question.difficulty}</span>\r\n                        </div>\r\n                        <p className=\"text-xs font-semibold text-slate-500 dark:text-slate-400 hidden sm:block\">Topic: {question.topic}</p>\r\n                    </div>\r\n\r\n                    {/* Question Content */}\r\n                    <div className=\"flex-1 overflow-y-auto p-6 md:p-10 custom-scrollbar\">\r\n                        <div className=\"max-w-4xl mx-auto\">\r\n                            <div className=\"prose prose-slate dark:prose-invert max-w-none prose-p:leading-relaxed prose-pre:bg-slate-900 prose-pre:border prose-pre:border-slate-800 rounded-xl mb-10 text-lg sm:text-xl font-medium text-slate-800 dark:text-slate-200\">\r\n                                <ReactMarkdown remarkPlugins={[remarkGfm, remarkMath]} rehypePlugins={[rehypeKatex]}>\r\n                                    {question.text}\r\n                                </ReactMarkdown>\r\n                            </div>\r\n\r\n                            <div className=\"space-y-4\">\r\n                                {question.options && question.options.length > 0 ? (\r\n                                    question.options.map((opt: string, i: number) => {\r\n                                        const isSelected = answers[currentQ] === i;\r\n                                        return (\r\n                                            <button\r\n                                                key={i}\r\n                                                onClick={() => handleOptionSelect(i)}\r\n                                                className={cn(\r\n                                                    \"w-full text-left p-5 rounded-2xl border-2 transition-all duration-200 flex items-start gap-4 group\",\r\n                                                    isSelected\r\n                                                        ? \"border-violet-600 bg-violet-50 dark:bg-violet-900/20 dark:border-violet-500 shadow-sm\"\r\n                                                        : \"border-slate-200 bg-white hover:border-violet-300 hover:bg-slate-50 dark:border-slate-800 dark:bg-[#1E293B] dark:hover:border-slate-700\"\r\n                                                )}\r\n                                            >\r\n                                                <div className={cn(\r\n                                                    \"flex shrink-0 h-8 w-8 items-center justify-center rounded-full border-2 text-sm font-bold transition-colors mt-0.5\",\r\n                                                    isSelected\r\n                                                        ? \"border-violet-600 bg-violet-600 text-white dark:border-violet-500 dark:bg-violet-500\"\r\n                                                        : \"border-slate-300 text-slate-500 group-hover:border-violet-400 dark:border-slate-600 dark:text-slate-400\"\r\n                                                )}>\r\n                                                    {String.fromCharCode(65 + i)}\r\n                                                </div>\r\n                                                <div className=\"prose prose-sm dark:prose-invert max-w-none mt-1\">\r\n                                                    <ReactMarkdown remarkPlugins={[remarkGfm, remarkMath]} rehypePlugins={[rehypeKatex]}>\r\n                                                        {opt}\r\n                                                    </ReactMarkdown>\r\n                                                </div>\r\n                                            </button>\r\n                                        );\r\n                                    })\r\n                                ) : (\r\n                                    <div className=\"p-6 bg-slate-100 dark:bg-slate-900/50 rounded-2xl border-2 border-slate-200 dark:border-slate-800\">\r\n                                        <label className=\"block text-sm font-bold text-slate-700 dark:text-slate-300 mb-2 tracking-widest uppercase\">Numerical Value Answer</label>\r\n                                        <input\r\n                                            type=\"number\"\r\n                                            step=\"any\"\r\n                                            placeholder=\"Enter numerical answer...\"\r\n                                            value={answers[currentQ] !== null ? String(answers[currentQ]) : ''}\r\n                                            onChange={(e) => handleNumericalChange(e.target.value)}\r\n                                            className=\"w-full text-lg p-4 rounded-xl border-2 border-slate-300 dark:border-slate-700 bg-white dark:bg-[#1E293B] focus:border-violet-500 focus:outline-none focus:ring-4 focus:ring-violet-500/20 transition-all text-slate-900 dark:text-white\"\r\n                                        />\r\n                                        <p className=\"text-xs text-slate-500 mt-3 flex items-center gap-1.5\"><AlertCircle className=\"h-4 w-4\" /> Please enter exact numerical value up to 2 decimal places if applicable.</p>\r\n                                    </div>\r\n                                )}\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n\r\n                    {/* Bottom Action Bar */}\r\n                    <div className=\"h-20 shrink-0 border-t border-slate-200 dark:border-slate-800 bg-white dark:bg-[#0F172A] flex items-center justify-between px-6 shadow-[0_-4px_6px_-1px_rgba(0,0,0,0.05)]\">\r\n                        <div className=\"flex gap-3 text-sm\">\r\n                            <button\r\n                                onClick={handleClearResponse}\r\n                                disabled={answers[currentQ] === null}\r\n                                className=\"px-4 py-2.5 rounded-lg border font-semibold text-slate-700 hover:bg-slate-100 disabled:opacity-50 disabled:cursor-not-allowed dark:border-slate-700 dark:text-slate-300 dark:hover:bg-slate-800 transition\"\r\n                            >\r\n                                Clear Response\r\n                            </button>\r\n                        </div>\r\n\r\n                        <div className=\"flex gap-3\">\r\n                            <button\r\n                                onClick={() => handleNavigateQuestion(Math.max(0, currentQ - 1))}\r\n                                disabled={currentQ === 0}\r\n                                className=\"flex items-center gap-1.5 px-4 py-2.5 rounded-lg border font-semibold bg-white text-slate-700 hover:bg-slate-50 disabled:opacity-50 disabled:cursor-not-allowed dark:border-slate-700 dark:bg-slate-800 dark:text-slate-300 dark:hover:bg-slate-700 transition shadow-sm\"\r\n                            >\r\n                                <ChevronLeft className=\"h-4 w-4\" /> Previous\r\n                            </button>\r\n                            {currentQ < test.questions.length - 1 ? (\r\n                                <button\r\n                                    onClick={() => handleNavigateQuestion(Math.min(test.questions.length - 1, currentQ + 1))}\r\n                                    className=\"flex items-center gap-1.5 px-6 py-2.5 rounded-lg font-bold bg-violet-600 text-white hover:bg-violet-700 transition shadow-md\"\r\n                                >\r\n                                    Save & Next <ChevronRight className=\"h-4 w-4\" />\r\n                                </button>\r\n                            ) : (\r\n                                <button\r\n                                    onClick={() => handleSubmit()}\r\n                                    disabled={isSubmitting}\r\n                                    className=\"flex items-center gap-2 px-6 py-2.5 rounded-lg font-bold bg-emerald-600 text-white hover:bg-emerald-700 transition shadow-md disabled:opacity-70 disabled:animate-pulse\"\r\n                                >\r\n                                    <Save className=\"h-4 w-4\" /> {isSubmitting ? 'Submitting...' : 'Submit Exam'}\r\n                                </button>\r\n                            )}\r\n                        </div>\r\n                    </div>\r\n                </main>\r\n\r\n                {/* Right Palette */}\r\n                <aside className={cn(\r\n                    \"w-80 shrink-0 border-l border-slate-200 dark:border-slate-800 bg-white dark:bg-[#0F172A] flex flex-col absolute md:relative right-0 h-full z-20 shadow-[-4px_0_15px_-3px_rgba(0,0,0,0.1)] transition-transform duration-300\",\r\n                    !showPalette && \"translate-x-full md:translate-x-0\"\r\n                )}>\r\n                    {/* Mobile close button */}\r\n                    <button\r\n                        onClick={() => setShowPalette(false)}\r\n                        className=\"md:hidden absolute -left-12 top-4 p-2 bg-slate-800 text-white rounded-l-lg shadow-md\"\r\n                    >\r\n                        <ChevronRight className=\"h-5 w-5\" />\r\n                    </button>\r\n\r\n                    <div className=\"p-5 border-b border-slate-200 dark:border-slate-800\">\r\n                        <h3 className=\"text-[10px] font-black uppercase tracking-widest text-slate-500 dark:text-slate-400 mb-4\">Question Palette</h3>\r\n\r\n                        <div className=\"grid grid-cols-2 gap-3 text-xs font-semibold mb-6\">\r\n                            <div className=\"flex items-center gap-2\">\r\n                                <div className=\"w-5 h-5 rounded bg-emerald-500\" /> <span className=\"text-slate-700 dark:text-slate-300\">Answered ({attemptedCount})</span>\r\n                            </div>\r\n                            <div className=\"flex items-center gap-2\">\r\n                                <div className=\"w-5 h-5 rounded border-2 border-slate-300 dark:border-slate-600 bg-white dark:bg-slate-800\" /> <span className=\"text-slate-700 dark:text-slate-300\">Not Visited ({test.questions.length - attemptedCount})</span>\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n\r\n                    <div className=\"flex-1 overflow-y-auto p-5 custom-scrollbar\">\r\n                        <div className=\"grid grid-cols-5 gap-3\">\r\n                            {test.questions.map((q: any, idx: number) => {\r\n                                // Only render if no subjects exist or matches the active subject\r\n                                if (activeSubject && q.subject && q.subject !== activeSubject) {\r\n                                    return null;\r\n                                }\r\n\r\n                                const isAnswered = answers[idx] !== null;\r\n                                const isCurrent = currentQ === idx;\r\n\r\n                                return (\r\n                                    <button\r\n                                        key={idx}\r\n                                        onClick={() => {\r\n                                            handleNavigateQuestion(idx);\r\n                                            setShowPalette(false);\r\n                                        }}\r\n                                        className={cn(\r\n                                            \"aspect-square rounded flex items-center justify-center text-sm font-bold transition-all\",\r\n                                            isCurrent && \"ring-2 ring-offset-2 ring-violet-500 dark:ring-offset-slate-900\",\r\n                                            isAnswered\r\n                                                ? \"bg-emerald-500 text-white shadow-sm\"\r\n                                                : \"bg-white border-2 border-slate-200 text-slate-600 hover:border-slate-400 dark:bg-slate-800 dark:border-slate-700 dark:text-slate-400 dark:hover:border-slate-500\"\r\n                                        )}\r\n                                    >\r\n                                        {idx + 1}\r\n                                    </button>\r\n                                );\r\n                            })}\r\n                        </div>\r\n                    </div>\r\n\r\n                    <div className=\"p-4 border-t border-slate-200 dark:border-slate-800 mt-auto\">\r\n                        <button\r\n                            onClick={() => handleSubmit()}\r\n                            disabled={isSubmitting}\r\n                            className=\"w-full py-3 rounded-xl font-black bg-slate-900 text-white hover:bg-slate-800 dark:bg-emerald-600 dark:hover:bg-emerald-700 transition shadow-lg\"\r\n                        >\r\n                            SUBMIT TEST\r\n                        </button>\r\n                    </div>\r\n                </aside>\r\n            </div>\r\n        </div>\r\n    );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"E:\\AI_Byte_Solver\\frontend\\src\\pages\\Profile.tsx","messages":[{"ruleId":"@typescript-eslint/ban-ts-comment","severity":2,"message":"Use \"@ts-expect-error\" instead of \"@ts-ignore\", as \"@ts-ignore\" will do nothing if the following line is error-free.","line":72,"column":9,"nodeType":"Line","messageId":"tsIgnoreInsteadOfExpectError","endLine":72,"endColumn":22,"suggestions":[{"messageId":"replaceTsIgnoreWithTsExpectError","fix":{"range":[2113,2126],"text":"// @ts-expect-error"},"desc":"Replace \"@ts-ignore\" with \"@ts-expect-error\"."}]},{"ruleId":"@typescript-eslint/ban-ts-comment","severity":2,"message":"Use \"@ts-expect-error\" instead of \"@ts-ignore\", as \"@ts-ignore\" will do nothing if the following line is error-free.","line":80,"column":7,"nodeType":"Line","messageId":"tsIgnoreInsteadOfExpectError","endLine":80,"endColumn":20,"suggestions":[{"messageId":"replaceTsIgnoreWithTsExpectError","fix":{"range":[2430,2443],"text":"// @ts-expect-error"},"desc":"Replace \"@ts-ignore\" with \"@ts-expect-error\"."}]}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useState, useEffect, useCallback } from 'react';\r\nimport { Link, useNavigate } from 'react-router-dom';\r\nimport { ChevronLeft } from 'lucide-react';\r\nimport {\r\n  ProfileHeader,\r\n  ProfileEditModal,\r\n  AccountInfoCard,\r\n  LearningSummaryCard,\r\n  ActivityProgressCard,\r\n  ThemePreferencesCard,\r\n  ProfileActions,\r\n} from '../components/profile';\r\nimport { useAuthStore } from '../stores/authStore';\r\nimport { useThemeStore } from '../stores/themeStore';\r\nimport api from '../lib/api';\r\n\r\ninterface FullUser {\r\n  _id: string;\r\n  name: string;\r\n  email: string;\r\n  avatar?: string;\r\n  googleId?: string;\r\n  createdAt?: string;\r\n  preferences?: { theme?: string; language?: string };\r\n}\r\n\r\ninterface Summary {\r\n  doubtsSolved: number;\r\n  quizAttempts: number;\r\n  accuracyPercent: number;\r\n}\r\n\r\ninterface Streak {\r\n  currentStreak: number;\r\n  lastActiveDate?: string;\r\n}\r\n\r\ninterface Doubt {\r\n  _id: string;\r\n  question: string;\r\n  frequency: number;\r\n  lastAsked: string;\r\n}\r\n\r\ninterface QuizAttempt {\r\n  percentage?: number;\r\n}\r\n\r\nexport default function Profile() {\r\n  const navigate = useNavigate();\r\n  const { user: storeUser, logout, updateUser } = useAuthStore();\r\n  const { theme, setTheme } = useThemeStore();\r\n\r\n  const [fullUser, setFullUser] = useState<FullUser | null>(null);\r\n  const [editModalOpen, setEditModalOpen] = useState(false);\r\n  const [summary, setSummary] = useState<Summary | null>(null);\r\n  const [streak, setStreak] = useState<Streak | null>(null);\r\n  const [topics, setTopics] = useState<{ topic: string; count: number }[]>([]);\r\n  const [quizPerformance, setQuizPerformance] = useState<QuizAttempt[]>([]);\r\n  const [doubts, setDoubts] = useState<Doubt[]>([]);\r\n  const [loading, setLoading] = useState(true);\r\n\r\n  const loadProfile = useCallback(async () => {\r\n    try {\r\n      const [userRes, summaryRes, streakRes, topicsRes, quizRes, doubtsRes] = await Promise.all([\r\n        api.get('/users/me'),\r\n        api.get('/stats/summary'),\r\n        api.get('/streaks'),\r\n        api.get('/stats/topics'),\r\n        api.get('/stats/topics'),\r\n        api.get('/stats/quiz'),\r\n        // @ts-ignore\r\n        api.getTopDoubts(10),\r\n      ]);\r\n      setFullUser(userRes.data.user || null);\r\n      setSummary(summaryRes.data.summary || null);\r\n      setStreak(streakRes.data.streak || null);\r\n      setTopics(topicsRes.data.topics || []);\r\n      setQuizPerformance(quizRes.data.performance || []);\r\n      // @ts-ignore\r\n      setDoubts(doubtsRes?.data?.doubts || []);\r\n    } catch {\r\n      setFullUser(null);\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    loadProfile();\r\n  }, [loadProfile]);\r\n\r\n  useEffect(() => {\r\n    const prefTheme = fullUser?.preferences?.theme;\r\n    if (prefTheme && (prefTheme === 'light' || prefTheme === 'dark' || prefTheme === 'system')) {\r\n      setTheme(prefTheme);\r\n      const root = document.documentElement;\r\n      const isDark =\r\n        prefTheme === 'dark' ||\r\n        (prefTheme === 'system' && window.matchMedia('(prefers-color-scheme: dark)').matches);\r\n      root.classList.toggle('dark', isDark);\r\n    }\r\n  }, [fullUser?.preferences?.theme, setTheme]);\r\n\r\n  const applyTheme = (t: 'light' | 'dark' | 'system') => {\r\n    setTheme(t);\r\n    const root = document.documentElement;\r\n    const isDark =\r\n      t === 'dark' || (t === 'system' && window.matchMedia('(prefers-color-scheme: dark)').matches);\r\n    root.classList.toggle('dark', isDark);\r\n    api.patch('/users/me', { preferences: { theme: t } }).catch(() => { });\r\n  };\r\n\r\n  const handleLogout = () => {\r\n    logout();\r\n    navigate('/login');\r\n  };\r\n\r\n  const handleEditProfile = () => {\r\n    setEditModalOpen(true);\r\n  };\r\n\r\n  const handleSaveProfile = async (data: { name: string; avatar?: string | null }) => {\r\n    const { data: res } = await api.patch('/users/me', {\r\n      name: data.name,\r\n      ...(data.avatar !== undefined && { avatar: data.avatar }),\r\n    });\r\n    const updated = res.user;\r\n    setFullUser(updated);\r\n    updateUser({\r\n      name: updated.name,\r\n      avatar: updated.avatar,\r\n      preferences: updated.preferences,\r\n    });\r\n  };\r\n\r\n  const user = fullUser ?? storeUser;\r\n  const loginMethod = fullUser?.googleId ? 'Google' : 'Email';\r\n\r\n  if (loading) {\r\n    return (\r\n      <div className=\"flex min-h-screen items-center justify-center bg-gradient-to-b from-gray-50 to-white dark:from-gray-950 dark:to-gray-900\">\r\n        <div className=\"h-10 w-10 animate-spin rounded-full border-2 border-emerald-500 border-t-transparent\" />\r\n      </div>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <div className=\"min-h-screen bg-[var(--bg-gradient)] bg-attachment-fixed transition-colors\">\r\n      <div className=\"mx-auto max-w-4xl px-4 py-8 sm:px-6 lg:px-8\">\r\n        <Link\r\n          to=\"/chat\"\r\n          className=\"mb-8 inline-flex items-center gap-2 text-sm font-semibold text-[hsl(var(--foreground-secondary))] transition-colors hover:text-[hsl(var(--primary))]\"\r\n        >\r\n          <ChevronLeft className=\"h-4 w-4\" />\r\n          Back to Dashboard\r\n        </Link>\r\n\r\n        <div className=\"space-y-8\">\r\n          <ProfileHeader\r\n            name={user?.name || 'Student'}\r\n            email={user?.email || ''}\r\n            avatar={user?.avatar}\r\n            onEditClick={handleEditProfile}\r\n          />\r\n          <ProfileEditModal\r\n            isOpen={editModalOpen}\r\n            onClose={() => setEditModalOpen(false)}\r\n            currentName={user?.name || ''}\r\n            currentAvatar={user?.avatar}\r\n            onSave={handleSaveProfile}\r\n          />\r\n\r\n          <div className=\"grid gap-6 lg:grid-cols-2\">\r\n            <AccountInfoCard\r\n              name={user?.name || 'â€”'}\r\n              email={user?.email || 'â€”'}\r\n              loginMethod={loginMethod}\r\n              createdAt={fullUser?.createdAt}\r\n            />\r\n\r\n            <LearningSummaryCard\r\n              doubtsSolved={summary?.doubtsSolved ?? 0}\r\n              quizzesAttempted={summary?.quizAttempts ?? 0}\r\n              accuracyPercent={summary?.accuracyPercent ?? 0}\r\n              currentStreak={streak?.currentStreak ?? 0}\r\n            />\r\n          </div>\r\n\r\n          <ActivityProgressCard\r\n            lastActiveDate={streak?.lastActiveDate}\r\n            recentTopic={topics[0]?.topic}\r\n            lastQuizScore={quizPerformance[0]?.percentage ?? null}\r\n          />\r\n\r\n          {doubts.length > 0 && (\r\n            <div className=\"glass rounded-2xl border border-[hsl(var(--glass-border))] p-6 shadow-sm\">\r\n              <h3 className=\"mb-4 text-lg font-bold text-slate-900 dark:text-white\">\r\n                Frequently Asked Doubts\r\n              </h3>\r\n              <div className=\"grid gap-3 sm:grid-cols-2\">\r\n                {doubts.map((d) => (\r\n                  <div key={d._id} className=\"rounded-xl border border-slate-200 bg-white/50 p-3 text-sm dark:border-slate-700 dark:bg-slate-800/50\">\r\n                    <p className=\"font-medium text-slate-800 dark:text-slate-200 mb-1 line-clamp-2\" title={d.question}>\r\n                      {d.question}\r\n                    </p>\r\n                    <p className=\"text-xs text-slate-500 dark:text-slate-400\">\r\n                      Asked {d.frequency} times â€¢ Last: {new Date(d.lastAsked).toLocaleDateString()}\r\n                    </p>\r\n                  </div>\r\n                ))}\r\n              </div>\r\n            </div>\r\n          )}\r\n\r\n          <ThemePreferencesCard\r\n            theme={(theme as 'light' | 'dark' | 'system') || 'system'}\r\n            language={user?.preferences?.language === 'en' ? 'English' : 'English'}\r\n            onThemeChange={applyTheme}\r\n          />\r\n\r\n          <div className=\"glass rounded-2xl border border-[hsl(var(--glass-border))] p-6 shadow-sm\">\r\n            <ProfileActions onLogout={handleLogout} />\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"E:\\AI_Byte_Solver\\frontend\\src\\pages\\QuizPage.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\AI_Byte_Solver\\frontend\\src\\pages\\Register.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\AI_Byte_Solver\\frontend\\src\\stores\\authStore.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\AI_Byte_Solver\\frontend\\src\\stores\\ideStore.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\AI_Byte_Solver\\frontend\\src\\stores\\themeStore.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\AI_Byte_Solver\\frontend\\tailwind.config.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\AI_Byte_Solver\\frontend\\test-cleaner.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\AI_Byte_Solver\\frontend\\test.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\AI_Byte_Solver\\frontend\\test2.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\AI_Byte_Solver\\frontend\\vite.config.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]}]